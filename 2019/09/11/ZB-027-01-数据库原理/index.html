<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  

  
  <title>ZB-027-01-数据库原理 | Almost</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="DDL-SQL create table drop table alter table 修改表，添加列，建索引  随用随查 基本SQL insert into  delete from update select  重要概念  sql的关键字不区分大小写 命名风格是 user_name 下划线形式 物理删除 、 逻辑删除 创建表的时候 如果字段是 sql的关键字 请使用这样的形式：“反引号包裹字段">
<meta name="keywords" content="oak">
<meta property="og:type" content="article">
<meta property="og:title" content="ZB-027-01-数据库原理">
<meta property="og:url" content="http://yoursite.com/2019/09/11/ZB-027-01-数据库原理/index.html">
<meta property="og:site_name" content="Almost">
<meta property="og:description" content="DDL-SQL create table drop table alter table 修改表，添加列，建索引  随用随查 基本SQL insert into  delete from update select  重要概念  sql的关键字不区分大小写 命名风格是 user_name 下划线形式 物理删除 、 逻辑删除 创建表的时候 如果字段是 sql的关键字 请使用这样的形式：“反引号包裹字段">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2021-04-24T08:07:09.831Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ZB-027-01-数据库原理">
<meta name="twitter:description" content="DDL-SQL create table drop table alter table 修改表，添加列，建索引  随用随查 基本SQL insert into  delete from update select  重要概念  sql的关键字不区分大小写 命名风格是 user_name 下划线形式 物理删除 、 逻辑删除 创建表的时候 如果字段是 sql的关键字 请使用这样的形式：“反引号包裹字段">
  
    <link rel="alternate" href="/atom.xml" title="Almost" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Almost</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-ZB-027-01-数据库原理" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/09/11/ZB-027-01-数据库原理/" class="article-date">
  <time datetime="2019-09-11T13:20:17.000Z" itemprop="datePublished">2019-09-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      ZB-027-01-数据库原理
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="DDL-SQL"><a href="#DDL-SQL" class="headerlink" title="DDL-SQL"></a>DDL-SQL</h2><ul>
<li>create table</li>
<li>drop table</li>
<li>alter table 修改表，添加列，建索引</li>
</ul>
<p><strong>随用随查</strong></p>
<h2 id="基本SQL"><a href="#基本SQL" class="headerlink" title="基本SQL"></a>基本SQL</h2><ul>
<li>insert into </li>
<li>delete from</li>
<li>update</li>
<li>select</li>
</ul>
<p><strong>重要概念</strong></p>
<ul>
<li>sql的关键字不区分大小写</li>
<li>命名风格是 <code>user_name</code> 下划线形式</li>
<li>物理删除 、 逻辑删除</li>
<li>创建表的时候 如果字段是 sql的关键字 请使用这样的形式：“反引号包裹字段名”</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">-- 用户表</span><br><span class="line">CREATE TABLE USER (</span><br><span class="line">    ID BIGINT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">    NAME VARCHAR(100) NOT NULL,</span><br><span class="line">    -- 密码一定不能存明文， 参考 CSDN 明文存密码</span><br><span class="line">    PASSWORD VARCHAR(100) NOT NULL,</span><br><span class="line">    TEL VARCHAR (200) NOT NULL UNIQUE,</span><br><span class="line">    ADDRESS VARCHAR (100),</span><br><span class="line">    CREATED_AT TIMESTAMP NOT NULL DEFAULT NOW(),</span><br><span class="line">    UPDATED_AT TIMESTAMP NOT NULL DEFAULT NOW(),</span><br><span class="line">    -- 逻辑删除的标识</span><br><span class="line">    -- STATUS TINYINT NOT NULL</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 新增列,由于之前已经有了数据  ，再次新增列 not null 就会失败，所以设置 default</span><br><span class="line">alter table USER add STATUS TINYINT NOT NULL default 1</span><br><span class="line"></span><br><span class="line">-- delete 操作是非常危险的</span><br><span class="line"></span><br><span class="line">-- 删除用户 id=2的数据的正确姿势,应该同步更新 updated_at字段</span><br><span class="line">update user set status=0, updated_at=now() where id=2</span><br></pre></td></tr></table></figure>
<h3 id="select之一次数据库查询的时间是多少？"><a href="#select之一次数据库查询的时间是多少？" class="headerlink" title="select之一次数据库查询的时间是多少？"></a>select之一次数据库查询的时间是多少？</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">CPU时钟周期</span><br><span class="line">  CPU 3Ghz的电脑 = 3G/s  30亿次/秒</span><br><span class="line">  指令周期  0.3ns = 0.3 x 10的-9次方 秒</span><br><span class="line"></span><br><span class="line">内存 </span><br><span class="line">  寻址时间：10us 微秒 =  10x10的-6次方 秒 (比CPU慢一个数量级) </span><br><span class="line"></span><br><span class="line">SSD </span><br><span class="line">  寻址时间：100us = 100x10的-6次方 秒</span><br><span class="line"></span><br><span class="line">HDD </span><br><span class="line">  寻址时间：1～10ms 毫秒  = 10的-3次方 ～ 10的-2次方 秒</span><br><span class="line"></span><br><span class="line">同机房网络IO</span><br><span class="line">  1ms 毫秒  = 10的-3次方 秒</span><br><span class="line"></span><br><span class="line">数据库操作</span><br><span class="line">  典型时间： 1ms (查询算快的情况)</span><br></pre></td></tr></table></figure>
<h3 id="数据库存多少算是多的？"><a href="#数据库存多少算是多的？" class="headerlink" title="数据库存多少算是多的？"></a>数据库存多少算是多的？</h3><ul>
<li>过早优化乃万恶之源！！！</li>
<li>过早优化乃万恶之源！！！</li>
<li>过早优化乃万恶之源！！！</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1w / 100w / 1000w / 1亿</span><br><span class="line"></span><br><span class="line">对于mysql来说 100w ～ 1000w 对它没啥本质区别</span><br><span class="line"></span><br><span class="line">上亿才会对他性能有所下架</span><br></pre></td></tr></table></figure>
<h3 id="money这种敏感信息如何存"><a href="#money这种敏感信息如何存" class="headerlink" title="money这种敏感信息如何存"></a>money这种敏感信息如何存</h3><ul>
<li>int分 *100 有点low</li>
<li>decimal</li>
</ul>
<h3 id="使用JDBC访问数据库"><a href="#使用JDBC访问数据库" class="headerlink" title="使用JDBC访问数据库"></a>使用JDBC访问数据库</h3><ul>
<li>Java Database Connection<ul>
<li>连接串</li>
<li>用户名</li>
<li>密码</li>
</ul>
</li>
<li>Statement 语句</li>
<li>PrepareStatement 防SQL注入的</li>
<li>ResultSet</li>
</ul>
<h4 id="Statement"><a href="#Statement" class="headerlink" title="Statement"></a>Statement</h4><ul>
<li>最好别用，有注入问题</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// 如果用户这样输入 字符串 name = &quot;zhangsan&apos; or &apos;1&apos;=&apos;1&quot; 就会骗过mysql 查出所有的用户</span><br><span class="line">try (Connection conn = DriverManager.getConnection(Config.JDBC_URL);</span><br><span class="line">      Statement st = conn.createStatement()) &#123;</span><br><span class="line">    ResultSet rs = null;</span><br><span class="line">    rs = st.executeQuery(&quot;select * from USER where NAME=&apos;&quot;+name +&quot;&apos;&quot;);</span><br><span class="line">    printResult(rs);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>原因是 Statement 是把sql整个字符串 变成 sql的 AST</li>
</ul>
<h4 id="最好使用-PrepareStatement"><a href="#最好使用-PrepareStatement" class="headerlink" title="最好使用 PrepareStatement"></a>最好使用 PrepareStatement</h4><ul>
<li>防注入</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PreparedStatement st = conn.prepareStatement(&quot;select * from USER where NAME= ?&quot;)) &#123;</span><br><span class="line">st.setString(1,name);</span><br></pre></td></tr></table></figure>
<ul>
<li>PreparedStatement 是先把sql字符串 变成 sql的 AST，然后在把对应内容 设置到AST的节点上</li>
</ul>
<h3 id="sql操作"><a href="#sql操作" class="headerlink" title="sql操作"></a>sql操作</h3><p>建表语句和灌入数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">-- 用户表</span><br><span class="line">CREATE TABLE USER (</span><br><span class="line">    ID BIGINT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">    NAME VARCHAR(100) NOT NULL,</span><br><span class="line">    TEL VARCHAR (200) NOT NULL UNIQUE,</span><br><span class="line">    ADDRESS VARCHAR (100),</span><br><span class="line">    CREATED_AT TIMESTAMP NOT NULL DEFAULT NOW(),</span><br><span class="line">    UPDATED_AT TIMESTAMP NOT NULL DEFAULT NOW()</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 商品表</span><br><span class="line">CREATE TABLE GOODS(</span><br><span class="line">    ID BIGINT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">    NAME VARCHAR(100) NOT NULL,</span><br><span class="line">    PRICE DECIMAL NOT NULL,</span><br><span class="line">    CREATED_AT TIMESTAMP NOT NULL DEFAULT NOW(),</span><br><span class="line">    UPDATED_AT TIMESTAMP NOT NULL DEFAULT NOW()</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 订单表</span><br><span class="line">CREATE TABLE `ORDER`(</span><br><span class="line">    ID BIGINT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">    USER_ID BIGINT,</span><br><span class="line">    GOODS_ID BIGINT,</span><br><span class="line">    GOODS_NUM INT,  -- 下单的商品数量</span><br><span class="line">    GOODS_PRICE DECIMAL NOT NULL, -- 下单时的商品单价</span><br><span class="line">    CREATED_AT TIMESTAMP NOT NULL DEFAULT NOW(),</span><br><span class="line">    UPDATED_AT TIMESTAMP NOT NULL DEFAULT NOW()</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">INSERT INTO USER (ID, NAME, TEL, ADDRESS) VALUES (1, &apos;zhangsan&apos;, &apos;tel1&apos;, &apos;beijing&apos;);</span><br><span class="line">INSERT INTO USER (ID, NAME, TEL, ADDRESS) VALUES (2, &apos;lisi&apos;, &apos;tel2&apos;, &apos;shanghai&apos;);</span><br><span class="line">INSERT INTO USER (ID, NAME, TEL, ADDRESS) VALUES (3, &apos;wangwu&apos;, &apos;tel3&apos;, &apos;shanghai&apos;);</span><br><span class="line">INSERT INTO USER (ID, NAME, TEL, ADDRESS) VALUES (4, &apos;zhangsan&apos;, &apos;tel4&apos;, &apos;shenzhen&apos;);</span><br><span class="line"></span><br><span class="line">INSERT INTO GOODS (ID, NAME, PRICE) VALUES (1, &apos;goods1&apos;, 10);</span><br><span class="line">INSERT INTO GOODS (ID, NAME, PRICE) VALUES (2, &apos;goods2&apos;, 20);</span><br><span class="line">INSERT INTO GOODS (ID, NAME, PRICE) VALUES (3, &apos;goods3&apos;, 30);</span><br><span class="line">INSERT INTO GOODS (ID, NAME, PRICE) VALUES (4, &apos;goods4&apos;, 40);</span><br><span class="line">INSERT INTO GOODS (ID, NAME, PRICE) VALUES (5, &apos;goods5&apos;, 50);</span><br><span class="line"></span><br><span class="line">INSERT INTO `ORDER` (ID,USER_ID, GOODS_ID, GOODS_NUM, GOODS_PRICE) VALUES (1,1, 1, 5, 10);</span><br><span class="line">INSERT INTO `ORDER` (ID,USER_ID, GOODS_ID, GOODS_NUM, GOODS_PRICE) VALUES (2,2, 1, 1, 10);</span><br><span class="line">INSERT INTO `ORDER` (ID,USER_ID, GOODS_ID, GOODS_NUM, GOODS_PRICE) VALUES (3,2, 1, 2, 10);</span><br><span class="line">INSERT INTO `ORDER` (ID,USER_ID, GOODS_ID, GOODS_NUM, GOODS_PRICE) VALUES (4,4, 2, 4, 20);</span><br><span class="line">INSERT INTO `ORDER` (ID,USER_ID, GOODS_ID, GOODS_NUM, GOODS_PRICE) VALUES (5,4, 2, 100, 20);</span><br><span class="line">INSERT INTO `ORDER` (ID,USER_ID, GOODS_ID, GOODS_NUM, GOODS_PRICE) VALUES (6,4, 3, 1, 20);</span><br><span class="line">INSERT INTO `ORDER` (ID,USER_ID, GOODS_ID, GOODS_NUM, GOODS_PRICE) VALUES (7,5, 4, 1, 20);</span><br><span class="line">INSERT INTO `ORDER` (ID,USER_ID, GOODS_ID, GOODS_NUM, GOODS_PRICE) VALUES (8,5, 6, 1, 60);</span><br></pre></td></tr></table></figure>
<ul>
<li>表信息</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">用户表：</span><br><span class="line">+----+----------+------+----------+</span><br><span class="line">| ID | NAME     | TEL  | ADDRESS  |</span><br><span class="line">+----+----------+------+----------+</span><br><span class="line">| 1  | zhangsan | tel1 | beijing  |</span><br><span class="line">+----+----------+------+----------+</span><br><span class="line">| 2  | lisi     | tel2 | shanghai |</span><br><span class="line">+----+----------+------+----------+</span><br><span class="line">| 3  | wangwu   | tel3 | shanghai |</span><br><span class="line">+----+----------+------+----------+</span><br><span class="line">| 4  | zhangsan | tel4 | shenzhen |</span><br><span class="line">+----+----------+------+----------+</span><br><span class="line">商品表：</span><br><span class="line">+----+--------+-------+</span><br><span class="line">| ID | NAME   | PRICE |</span><br><span class="line">+----+--------+-------+</span><br><span class="line">| 1  | goods1 | 10    |</span><br><span class="line">+----+--------+-------+</span><br><span class="line">| 2  | goods2 | 20    |</span><br><span class="line">+----+--------+-------+</span><br><span class="line">| 3  | goods3 | 30    |</span><br><span class="line">+----+--------+-------+</span><br><span class="line">| 4  | goods4 | 40    |</span><br><span class="line">+----+--------+-------+</span><br><span class="line">| 5  | goods5 | 50    |</span><br><span class="line">+----+--------+-------+</span><br><span class="line">订单表：</span><br><span class="line">+------------+-----------------+------------------+---------------------+-------------------------------+</span><br><span class="line">| ID(订单ID) | USER_ID(用户ID) | GOODS_ID(商品ID) | GOODS_NUM(商品数量) | GOODS_PRICE(下单时的商品单价)        |</span><br><span class="line">+------------+-----------------+------------------+---------------------+-------------------------------+</span><br><span class="line">| 1          | 1               | 1                | 5                   | 10                            |</span><br><span class="line">+------------+-----------------+------------------+---------------------+-------------------------------+</span><br><span class="line">| 2          | 2               | 1                | 1                   | 10                            |</span><br><span class="line">+------------+-----------------+------------------+---------------------+-------------------------------+</span><br><span class="line">| 3          | 2               | 1                | 2                   | 10                            |</span><br><span class="line">+------------+-----------------+------------------+---------------------+-------------------------------+</span><br><span class="line">| 4          | 4               | 2                | 4                   | 20                            |</span><br><span class="line">+------------+-----------------+------------------+---------------------+-------------------------------+</span><br><span class="line">| 5          | 4               | 2                | 100                 | 20                            |</span><br><span class="line">+------------+-----------------+------------------+---------------------+-------------------------------+</span><br><span class="line">| 6          | 4               | 3                | 1                   | 20                            |</span><br><span class="line">+------------+-----------------+------------------+---------------------+-------------------------------+</span><br><span class="line">| 7          | 5               | 4                | 1                   | 20                            |</span><br><span class="line">+------------+-----------------+------------------+---------------------+-------------------------------+</span><br><span class="line">| 8          | 5               | 6                | 1                   | 60                            |</span><br><span class="line">+------------+-----------------+------------------+---------------------+-------------------------------+</span><br></pre></td></tr></table></figure>
<blockquote>
<p>sql练习</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"># 01 查询所有用户</span><br><span class="line">select * from USER;</span><br><span class="line"></span><br><span class="line"># 02 查询用户个数</span><br><span class="line">select count(*) from USER;</span><br><span class="line"></span><br><span class="line"># 03 查询 地址 = &apos;shanghai&apos; 用户</span><br><span class="line">select * from USER where ADDRESS=&apos;shanghai&apos;</span><br><span class="line"></span><br><span class="line"># 04 查询 地址 = &apos;shanghai&apos; 用户个数</span><br><span class="line">select count(*) from USER where ADDRESS=&apos;shanghai&apos;</span><br><span class="line"></span><br><span class="line"># 05 查询具体的列</span><br><span class="line">select id,name from USER where ADDRESS=&apos;shanghai&apos;</span><br><span class="line"></span><br><span class="line"># 06 在上海的用户 id降序排列</span><br><span class="line">select id,name from USER where ADDRESS=&apos;shanghai&apos; order by id desc;</span><br><span class="line"></span><br><span class="line"># 07 用户列表分页 limit&lt;从第几个元素开始&gt;,&lt;最多返回几个元素&gt;</span><br><span class="line"># limit &lt;(pageNo-1)*pageSize&gt;,&lt;pageSize&gt;</span><br><span class="line">select * from USER limit 2,2;</span><br><span class="line"></span><br><span class="line"># 08 按地区分组</span><br><span class="line">select ADDRESS from USER group by ADDRESS;</span><br><span class="line"></span><br><span class="line"># 09 每个地区有多少人</span><br><span class="line">select ADDRESS,count(*) from USER group by ADDRESS;</span><br><span class="line"></span><br><span class="line"># 10 订单表：每个商品下了几单</span><br><span class="line">select GOODS_ID,count(*) from `ORDER` group by GOODS_ID;</span><br><span class="line"></span><br><span class="line"># 11 订单表：每个商品下了几单 ——列名：重新命名</span><br><span class="line">select GOODS_ID,count(*)as count from `ORDER` group by GOODS_ID;</span><br><span class="line"></span><br><span class="line"># 12 订单表：每个订单商品和对应的总价格</span><br><span class="line">select GOODS_ID,(GOODS_NUM*GOODS_PRICE)as total_price from `ORDER`;</span><br><span class="line"></span><br><span class="line"># 13 订单表：每个商品对应的销售额</span><br><span class="line">select GOODS_ID,sum(GOODS_NUM*GOODS_PRICE) from `ORDER` group by GOODS_ID;</span><br><span class="line"></span><br><span class="line"># 14 订单表：每个商品对应的销售额降序排列</span><br><span class="line">select GOODS_ID,sum(GOODS_NUM*GOODS_PRICE)as total from `ORDER` group by GOODS_ID order by total desc;</span><br></pre></td></tr></table></figure>
<blockquote>
<h4 id="进阶：JOIN操作"><a href="#进阶：JOIN操作" class="headerlink" title="进阶：JOIN操作"></a>进阶：JOIN操作</h4></blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"># join操作,</span><br><span class="line"># 单独一个 join 是内连接 inner join 两个表共有数据</span><br><span class="line"></span><br><span class="line"># 15 订单信息表， 订单和商品名称</span><br><span class="line">select `ORDER`.id,`ORDER`.USER_ID,`ORDER`.GOODS_ID,GOODS.NAME from `ORDER`</span><br><span class="line">  join GOODS</span><br><span class="line">on `ORDER`.GOODS_ID = GOODS.ID;</span><br><span class="line"># 简化</span><br><span class="line">select o.id,o.USER_ID,o.GOODS_ID,g.NAME from `ORDER` as o</span><br><span class="line">  join GOODS as g</span><br><span class="line">on o.GOODS_ID = g.ID;</span><br><span class="line"></span><br><span class="line"># 16 查询所有订单的信息，和对应的 商品名称 ,哪怕这个goods没有</span><br><span class="line">select o.id,o.USER_ID,o.GOODS_ID,g.NAME from `ORDER` as o</span><br><span class="line">  left join GOODS as g</span><br><span class="line">on o.GOODS_ID = g.ID;</span><br><span class="line"></span><br><span class="line"># 17 连表 订单信息，商品名称，用户信息(存在的用户和订单)</span><br><span class="line">select o.id,o.USER_ID,o.GOODS_ID,g.NAME,u.NAME,u.TEL,u.ADDRESS from `ORDER` as o</span><br><span class="line">  join GOODS as g</span><br><span class="line">on o.GOODS_ID = g.ID</span><br><span class="line">  join USER as u</span><br><span class="line">on o.USER_ID = u.ID;</span><br><span class="line"></span><br><span class="line"># 18 连表 订单信息，商品名称，用户信息,（即使用户不存在）</span><br><span class="line">select o.id,o.USER_ID,o.GOODS_ID,g.NAME,u.NAME,u.TEL,u.ADDRESS from `ORDER` as o</span><br><span class="line">  join GOODS as g</span><br><span class="line">on o.GOODS_ID = g.ID</span><br><span class="line">  left join USER as u</span><br><span class="line">on o.USER_ID = u.ID;</span><br><span class="line"></span><br><span class="line"># 19 查询 beijing 的用户订单信息</span><br><span class="line">select o.id,o.USER_ID,o.GOODS_ID,g.NAME,u.NAME,u.TEL,u.ADDRESS from `ORDER` as o</span><br><span class="line">  join GOODS as g</span><br><span class="line">on o.GOODS_ID = g.ID</span><br><span class="line">  join USER as u</span><br><span class="line">on o.USER_ID = u.ID</span><br><span class="line">where u.ADDRESS = &apos;beijing&apos;;</span><br></pre></td></tr></table></figure>
<blockquote>
<h3 id="综合练习"><a href="#综合练习" class="headerlink" title="综合练习"></a>综合练习</h3></blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"># 01 查询有多少用户买过指定商品 如 goods_id = 1</span><br><span class="line"># 01-1 查询指定商品</span><br><span class="line">select * from `ORDER` where GOODS_ID = 1;</span><br><span class="line"># 有三条 uid=1的一条订单， uid=2的两条订单</span><br><span class="line"># 所以你不能直接 这样 因为没去重复 返回的是3 ，应该是2</span><br><span class="line">select count(*) from `ORDER` where GOODS_ID = 1;</span><br><span class="line"># 第一种方式</span><br><span class="line"># 01-2 谁曾经下过单 distinct 去重复</span><br><span class="line">select distinct USER_ID from `ORDER` where GOODS_ID = 1;</span><br><span class="line"># 01-3 count 统计</span><br><span class="line">select count(distinct USER_ID) from `ORDER` where GOODS_ID = 1;</span><br><span class="line"></span><br><span class="line"># 第二种方式 子查询</span><br><span class="line"># 01-4</span><br><span class="line">select * from USER where id in (</span><br><span class="line">select USER_ID from `ORDER` where GOODS_ID = 1</span><br><span class="line">);</span><br><span class="line"># 等价于 select * from USER where id in (1,2,2);</span><br><span class="line"># 01-5</span><br><span class="line">select count(*) from USER where id in (</span><br><span class="line">  select USER_ID from `ORDER` where GOODS_ID = 1</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="代码参考"><a href="#代码参考" class="headerlink" title="代码参考"></a>代码参考</h3><ul>
<li><a href="https://github.com/slTrust/java-jdbc-mysql" target="_blank" rel="noopener">java-jdbc</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/09/11/ZB-027-01-数据库原理/" data-id="ckovg9ev9011i8yjkzxjzu209" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/oak/">oak</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/09/11/ZB-028-01多线程原理/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          ZB-028-01多线程原理
        
      </div>
    </a>
  
  
    <a href="/2019/09/04/ZB-025-02-异常的类型体系/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">ZB-025-02-异常的类型体系</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS/">CSS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ES6速学/">ES6速学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JS不知深浅/">JS不知深浅</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M01/">M01</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M02/">M02</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M03/">M03</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M04/">M04</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M06/">M06</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M07/">M07</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M08/">M08</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M09/">M09</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NodeWeb/">NodeWeb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Node后端/">Node后端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ReactWheels/">ReactWheels</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React入门/">React入门</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TS入门/">TS入门</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Webpack/">Webpack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/express/">express</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fullstack/">fullstack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/http/">http</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jQuery/">jQuery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mobile/">mobile</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/">mongodb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node/">node</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node每日精进/">node每日精进</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/oak/">oak</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tools/">tools</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vim/">vim</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vue/">vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vultr/">vultr</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web性能优化/">web性能优化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web面经/">web面经</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows/">windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端知识点/">前端知识点</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/CSS/" style="font-size: 13.91px;">CSS</a> <a href="/tags/ES6速学/" style="font-size: 14.35px;">ES6速学</a> <a href="/tags/JS不知深浅/" style="font-size: 11.3px;">JS不知深浅</a> <a href="/tags/M01/" style="font-size: 13.48px;">M01</a> <a href="/tags/M02/" style="font-size: 15.22px;">M02</a> <a href="/tags/M03/" style="font-size: 15.65px;">M03</a> <a href="/tags/M04/" style="font-size: 16.09px;">M04</a> <a href="/tags/M06/" style="font-size: 18.26px;">M06</a> <a href="/tags/M07/" style="font-size: 17.83px;">M07</a> <a href="/tags/M08/" style="font-size: 16.96px;">M08</a> <a href="/tags/M09/" style="font-size: 11.74px;">M09</a> <a href="/tags/NodeWeb/" style="font-size: 15.65px;">NodeWeb</a> <a href="/tags/Node后端/" style="font-size: 18.7px;">Node后端</a> <a href="/tags/ReactWheels/" style="font-size: 16.52px;">ReactWheels</a> <a href="/tags/React入门/" style="font-size: 15.22px;">React入门</a> <a href="/tags/TS入门/" style="font-size: 14.78px;">TS入门</a> <a href="/tags/Webpack/" style="font-size: 11.3px;">Webpack</a> <a href="/tags/express/" style="font-size: 10.43px;">express</a> <a href="/tags/fullstack/" style="font-size: 17.83px;">fullstack</a> <a href="/tags/http/" style="font-size: 12.17px;">http</a> <a href="/tags/jQuery/" style="font-size: 10px;">jQuery</a> <a href="/tags/java/" style="font-size: 19.13px;">java</a> <a href="/tags/linux/" style="font-size: 10.87px;">linux</a> <a href="/tags/mobile/" style="font-size: 11.3px;">mobile</a> <a href="/tags/mongodb/" style="font-size: 12.61px;">mongodb</a> <a href="/tags/mysql/" style="font-size: 12.61px;">mysql</a> <a href="/tags/node/" style="font-size: 10.43px;">node</a> <a href="/tags/node每日精进/" style="font-size: 10px;">node每日精进</a> <a href="/tags/oak/" style="font-size: 20px;">oak</a> <a href="/tags/python/" style="font-size: 17.39px;">python</a> <a href="/tags/tools/" style="font-size: 10px;">tools</a> <a href="/tags/vim/" style="font-size: 10px;">vim</a> <a href="/tags/vue/" style="font-size: 13.04px;">vue</a> <a href="/tags/vultr/" style="font-size: 10px;">vultr</a> <a href="/tags/web性能优化/" style="font-size: 10px;">web性能优化</a> <a href="/tags/web面经/" style="font-size: 10px;">web面经</a> <a href="/tags/windows/" style="font-size: 10px;">windows</a> <a href="/tags/前端知识点/" style="font-size: 19.57px;">前端知识点</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/05/18/Win平台软件技巧01/">Win平台软件技巧01</a>
          </li>
        
          <li>
            <a href="/2021/02/28/Webpack-03loader/">Webpack-03loader</a>
          </li>
        
          <li>
            <a href="/2021/02/27/Webpack-02打包器/">Webpack-02打包器</a>
          </li>
        
          <li>
            <a href="/2021/02/27/Webpack-01AST-Babel-依赖/">Webpack-01AST_Babel_依赖</a>
          </li>
        
          <li>
            <a href="/2021/02/26/Webpack-00前置内容理解webpack/">Webpack-00前置内容理解webpack</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 Stevin<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>