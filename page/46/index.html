
 <!DOCTYPE HTML>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
  
    <title>Almost</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Stevin">
    

    
    <meta property="og:type" content="website">
<meta property="og:title" content="Almost">
<meta property="og:url" content="http://yoursite.com/page/46/index.html">
<meta property="og:site_name" content="Almost">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Almost">

    
    <link rel="alternative" href="/atom.xml" title="Almost" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>
</html>
  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="Almost" title="Almost"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Almost">Almost</a></h1>
				<h2 class="blog-motto"></h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="Menu">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="Search" />
						<input type="hidden" name="q" value="site:yoursite.com">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main">

   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/12/05/N034_AJAX是什么鬼/" title="AJAX是什么鬼" itemprop="url">AJAX是什么鬼</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Stevin" target="_blank" itemprop="author">Stevin</a>
		
  <p class="article-time">
    <time datetime="2017-12-05T07:41:58.000Z" itemprop="datePublished"> Published 2017-12-05</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="ajax"><a href="#ajax" class="headerlink" title="ajax"></a>ajax</h2><h3 id="请先确保你有node-或自己开一个wamp服务器否则别往下看了-浪费时间"><a href="#请先确保你有node-或自己开一个wamp服务器否则别往下看了-浪费时间" class="headerlink" title="请先确保你有node 或自己开一个wamp服务器否则别往下看了 浪费时间"></a>请先确保你有node 或自己开一个wamp服务器否则别往下看了 浪费时间</h3><blockquote>
<p>if(你有node)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">安装请用</span><br><span class="line">npm install  -g http-server     </span><br><span class="line">卸载请用</span><br><span class="line">npm uninstall  -g http-server</span><br></pre></td></tr></table></figure></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir demo 创建目录</span><br><span class="line">cd demo    切换目录</span><br><span class="line">touch index.html  创建一个html文件</span><br></pre></td></tr></table></figure>
<h4 id="如何发请求"><a href="#如何发请求" class="headerlink" title="如何发请求"></a>如何发请求</h4><blockquote>
<p>form发请求</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=&quot;xxx&quot; method=&quot;get&quot; target=&quot;aa&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;text&quot; name=&quot;password&quot; value=&quot;222&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">&lt;/form&gt; </span><br><span class="line">&lt;iframe src=&quot;&quot; name=&quot;aa&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
</blockquote>
<ol>
<li><p>开启你的服务器 </p>
<ul>
<li><p>如果安装了 http-server  你就在demo目录  ！ demo目录 ! demo目录 ! 打开终端 </p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http-server -c-1</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果是wamp 你就开启服务器就行了 在你指定的端口 demo要放在wamp指定的www文件夹里</p>
</li>
</ul>
</li>
<li><p>把给你的url 在 chrome 里打开 </p>
</li>
<li>请按F12 / 打开调试</li>
<li>点击 Network</li>
<li>点击提交按钮</li>
<li><p>你会看到出现如下一行内容  请点击<br><img src="https://raw.githubusercontent.com/slTrust/note/master/img/note034_1.png" alt></p>
</li>
<li><p>点击之后 会看到前后台联调必不可少的几个部分</p>
</li>
</ol>
<p><img src="https://raw.githubusercontent.com/slTrust/note/master/img/note034_2.png" alt></p>
<ol start="8">
<li><p>分别展开列表  </p>
<blockquote>
<p>点击view source</p>
</blockquote>
<blockquote>
<p>点击view source</p>
</blockquote>
<blockquote>
<p>点击view source</p>
</blockquote>
</li>
</ol>
<p><img src="https://raw.githubusercontent.com/slTrust/note/master/img/note034_3.png" alt></p>
<ol start="9">
<li>get请求的四部分</li>
</ol>
<p><img src="https://raw.githubusercontent.com/slTrust/note/master/img/note034_4.png" alt></p>
<ol start="10">
<li>修改form里的 method=”post” 我知道你不会改的 所以看代码吧！</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=&quot;xxx&quot; method=&quot;post&quot; target=&quot;aa&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;text&quot; name=&quot;password&quot; value=&quot;22&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">&lt;/form&gt; </span><br><span class="line">&lt;iframe src=&quot;&quot; name=&quot;aa&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><img src="https://raw.githubusercontent.com/slTrust/note/master/img/note034_5.png" alt></p>
</blockquote>
<h3 id="form发请求"><a href="#form发请求" class="headerlink" title="form发请求"></a>form发请求</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=&quot;xxx&quot; method=&quot;get&quot; target=&quot;aa&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;text&quot; name=&quot;password&quot; value=&quot;222&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">&lt;/form&gt; </span><br><span class="line">&lt;iframe src=&quot;&quot; name=&quot;aa&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;</span><br></pre></td></tr></table></figure>
<h3 id="a标签发请求"><a href="#a标签发请求" class="headerlink" title="a标签发请求"></a>a标签发请求</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;a id=&quot;link&quot; href=&quot;/xxx&quot;&gt;&lt;/a&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    link.click();</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h3 id="img发请求"><a href="#img发请求" class="headerlink" title="img发请求"></a>img发请求</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;/xxx&quot; alt=&quot;&quot;&gt;</span><br></pre></td></tr></table></figure>
<h3 id="link发请求"><a href="#link发请求" class="headerlink" title="link发请求"></a>link发请求</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    var link = document.createElement(&apos;link&apos;);</span><br><span class="line">    link.rel = &apos;stylesheet&apos;;</span><br><span class="line">    link.href = &apos;/xxx&apos;;</span><br><span class="line">    document.head.appendChild(link);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h3 id="script发请求"><a href="#script发请求" class="headerlink" title="script发请求"></a>script发请求</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    var script = document.createElement(&apos;script&apos;);</span><br><span class="line">    script.src = &apos;/xxx&apos;;</span><br><span class="line">    document.head.appendChild(script);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>用 form 发请求，但是会刷新页面或新开页面</li>
<li>用 a 发 get 请求，但是也会刷新页面或新开页面</li>
<li>用 img 发 get 请求，但是只能以图片的形式展示</li>
<li>用 link 发 get 请求，但是只能以css/favicon的形式展示</li>
<li>用 script 发 get 请求，但是只能以脚本的形式运行</li>
</ul>
<h5 id="有没有什么方式可以实现"><a href="#有没有什么方式可以实现" class="headerlink" title="有没有什么方式可以实现"></a>有没有什么方式可以实现</h5><ol>
<li>get / post / put / delete 请求都行</li>
<li>想以什么形式展示就以什么形式展示</li>
</ol>
<h4 id="微软的突破"><a href="#微软的突破" class="headerlink" title="微软的突破"></a>微软的突破</h4><blockquote>
<p>IE 5 率先在 JS 中引入 ActiveX 对象（API），使得 JS 可以直接发起 HTTP 请求。<br>随后 Mozilla、 Safari、 Opera 也跟进（抄袭）了，取名 XMLHttpRequest，并被纳入 W3C 规范</p>
</blockquote>
<blockquote>
<p>IE6当时全球90%的市场份额于是做了愚蠢的决定：他以为自己的在浏览器已经天下无敌了没必要那么多人去维护了就留了两个人做日常维护,把其他人都开除了，然后chrome看准了这个时机异军突起，2年就占据了40%的市场份额，现在IE是人人喊打</p>
</blockquote>
<blockquote>
<h3 id="前端的起源就是因为IE发明了ajax"><a href="#前端的起源就是因为IE发明了ajax" class="headerlink" title="前端的起源就是因为IE发明了ajax"></a>前端的起源就是因为IE发明了ajax</h3></blockquote>
<h4 id="AJAX"><a href="#AJAX" class="headerlink" title="AJAX"></a>AJAX</h4><blockquote>
<p>Jesse James Garrett 讲如下技术取名叫做 AJAX：async JavaScript and XML</p>
</blockquote>
<ol>
<li>使用 XMLHttpRequest 发请求</li>
<li>服务器返回 XML 格式的字符串</li>
<li>JS 解析 XML，并更新局部页面</li>
</ol>
<h4 id="如何使用-XMLHttpRequest"><a href="#如何使用-XMLHttpRequest" class="headerlink" title="如何使用 XMLHttpRequest"></a>如何使用 XMLHttpRequest</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">myButton.addEventListener(&apos;click&apos;, (e)=&gt;&#123;</span><br><span class="line">  let request = new XMLHttpRequest()</span><br><span class="line">  request.open(&apos;get&apos;, &apos;/xxx&apos;) // 配置request</span><br><span class="line">  request.send()</span><br><span class="line">  request.onreadystatechange = ()=&gt;&#123;</span><br><span class="line">    if(request.readyState === 4)&#123;</span><br><span class="line">      console.log(&apos;请求响应都完毕了&apos;)</span><br><span class="line">      console.log(request.status)</span><br><span class="line">      if(request.status &gt;= 200 &amp;&amp; request.status &lt; 300)&#123;</span><br><span class="line">        console.log(&apos;说明请求成功&apos;)</span><br><span class="line">        console.log(typeof request.responseText) // &apos;string&apos;</span><br><span class="line">        console.log(request.responseText)</span><br><span class="line">        let string = request.responseText</span><br><span class="line">        // 把符合 JSON 语法的字符串</span><br><span class="line">        // 转换成 JS 对应的值</span><br><span class="line">        let object = window.JSON.parse(string)   </span><br><span class="line">        // JSON.parse 是浏览器提供的</span><br><span class="line">        console.log(typeof object)</span><br><span class="line">        console.log(object)</span><br><span class="line">        console.log(&apos;object.note&apos;)</span><br><span class="line">        console.log(object.note)</span><br><span class="line"></span><br><span class="line">      &#125;else if(request.status &gt;= 400)&#123;</span><br><span class="line">        console.log(&apos;说明请求失败&apos;) </span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// 后端代码</span><br><span class="line">if(path===&apos;/xxx&apos;)&#123;</span><br><span class="line">    response.statusCode = 200</span><br><span class="line">    response.setHeader(&apos;Content-Type&apos;, &apos;text/json;charset=utf-8&apos;)</span><br><span class="line">    response.write(`</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;note&quot;:&#123;</span><br><span class="line">        &quot;to&quot;: &quot;aaa&quot;,</span><br><span class="line">        &quot;from&quot;: &quot;hjx&quot;,</span><br><span class="line">        &quot;heading&quot;: &quot;打招呼&quot;,</span><br><span class="line">        &quot;content&quot;: &quot;hello&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    `)</span><br><span class="line">response.end()</span><br></pre></td></tr></table></figure>
<h3 id="注意readStaus有五种状态"><a href="#注意readStaus有五种状态" class="headerlink" title="注意readStaus有五种状态"></a>注意readStaus有五种状态</h3><ul>
<li>0    open()方法还未被调用.</li>
<li>1    open()方法已经被调用.</li>
<li>2    send()方法已经被调用, 响应头和响应状态已经返回.</li>
<li>3    响应体下载中; responseText中已经获取了部分数据.</li>
<li>4    整个请求过程已经完毕.</li>
</ul>
<blockquote>
<p>如何验证状态码经过了 01234 ？ 请按以下代码顺序书写<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">let request = new XMLHttpRequest();</span><br><span class="line">// open未调用</span><br><span class="line">console.log(request.readyState)</span><br><span class="line">request.onreadystatechange = function()&#123;</span><br><span class="line">    console.log(request.readyState)</span><br><span class="line">    if(request.readyState === 4)&#123;</span><br><span class="line">        if(request.status &gt;= 200 &amp;&amp; request.status &lt;300)&#123;</span><br><span class="line">            console.log(request.responseText);</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            console.log(request.status);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">request.open(&apos;get&apos;,&apos;/xxx&apos;);</span><br><span class="line">request.send();</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="考点-请使用原生JS实现AJAX"><a href="#考点-请使用原生JS实现AJAX" class="headerlink" title="考点:请使用原生JS实现AJAX"></a>考点:请使用原生JS实现AJAX</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">let request = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">request.open(&apos;get&apos;,&apos;/xxx&apos;);</span><br><span class="line"></span><br><span class="line">request.send();</span><br><span class="line"></span><br><span class="line">request.onreadystatechange = function()&#123;</span><br><span class="line">    if(request.readyState === 4)&#123;</span><br><span class="line">        if(request.status &gt;= 200 &amp;&amp; request.status &lt;300)&#123;</span><br><span class="line">            console.log(request.responseText);</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            console.log(request.status);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="JSON-是一门语言-抄袭的JS"><a href="#JSON-是一门语言-抄袭的JS" class="headerlink" title="JSON 是一门语言 (抄袭的JS)"></a>JSON 是一门语言 (抄袭的JS)</h3><blockquote>
<p>{name:’aa’}是对象 JS里这种方式叫做 对象字面量表达式</p>
</blockquote>
<blockquote>
<p>{“name”:”aa”} key必须是字符串 必须以 “ 开头 ， 以 “ 结尾</p>
</blockquote>
<h3 id="JS-VS-JSON"><a href="#JS-VS-JSON" class="headerlink" title="JS VS JSON"></a>JS VS JSON</h3><table>
<thead>
<tr>
<th>JS</th>
<th>JSON</th>
</tr>
</thead>
<tbody>
<tr>
<td>undefined</td>
<td>没有</td>
</tr>
<tr>
<td>null</td>
<td>null</td>
</tr>
<tr>
<td>[‘a’,’b’]</td>
<td>[“a”,”b”]</td>
</tr>
<tr>
<td>function(){}</td>
<td>没有</td>
</tr>
<tr>
<td>{name:’hjx’}</td>
<td>{“name”:”hjx”}</td>
</tr>
<tr>
<td>‘hjx’</td>
<td>“hjx”</td>
</tr>
<tr>
<td>var a = { }; a.self = a</td>
<td>搞不定没有变量</td>
</tr>
</tbody>
</table>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. JSON没有抄袭 function和 undefined ，也没有抄袭symbol因为 symbol是最近出来的</span><br><span class="line">2. JSON 的字符串必须是 &quot;</span><br><span class="line">3. obj.__proto__   没有原型链</span><br></pre></td></tr></table></figure>
<h3 id="请看下面的后台返回"><a href="#请看下面的后台返回" class="headerlink" title="请看下面的后台返回"></a>请看下面的后台返回</h3><blockquote>
<h3 id="返回的是符合JSON对象类型语法的字符串-，-绝对不是JS的“对象”"><a href="#返回的是符合JSON对象类型语法的字符串-，-绝对不是JS的“对象”" class="headerlink" title="返回的是符合JSON对象类型语法的字符串 ， 绝对不是JS的“对象”"></a>返回的是符合JSON对象类型语法的字符串 ， 绝对不是JS的“对象”</h3></blockquote>
<blockquote>
<p>你才返回”对象” ,你全家才返回”对象”</p>
</blockquote>
<blockquote>
<p>后台是无法返回”对象” 给前端的 ，他只能返回字符串</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">response.write(`</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;note&quot;:&#123;</span><br><span class="line">        &quot;to&quot;: &quot;aaa&quot;,</span><br><span class="line">        &quot;from&quot;: &quot;hjx&quot;,</span><br><span class="line">        &quot;heading&quot;: &quot;打招呼&quot;,</span><br><span class="line">        &quot;content&quot;: &quot;hello&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="同源策略"><a href="#同源策略" class="headerlink" title="同源策略"></a>同源策略</h3><blockquote>
<h3 id="为什么form表单提交没有跨域问题，但ajax提交有跨域问题？"><a href="#为什么form表单提交没有跨域问题，但ajax提交有跨域问题？" class="headerlink" title="为什么form表单提交没有跨域问题，但ajax提交有跨域问题？"></a>为什么form表单提交没有跨域问题，但ajax提交有跨域问题？</h3></blockquote>
<blockquote>
</blockquote>
<ul>
<li>因为原页面用 form 提交到另一个域名之后，原页面的脚本无法获取新页面中的内容。所以浏览器认为这是安全的。</li>
<li>而 AJAX 是可以读取响应内容的，因此浏览器不能允许你这样做。如果你细心的话你会发现，其实请求已经发送出去了，   你只是拿不到响应而已。</li>
<li>所以浏览器这个策略的本质是，一个域名的JS，在未经允许的情况下，不得读取另一个域名的内容。但浏览器并不阻止你向另一个域名发送请求。</li>
</ul>
<h3 id="只有-协议-端口-域名-一模一样才允许发-AJAX-请求"><a href="#只有-协议-端口-域名-一模一样才允许发-AJAX-请求" class="headerlink" title="只有 协议+端口+域名 一模一样才允许发 AJAX 请求"></a>只有 协议+端口+域名 一模一样才允许发 AJAX 请求</h3><blockquote>
<p>一模一样！一模一样！一模一样！一模一样！一模一样！一模一样！一模一样！一模一样！一模一样！</p>
</blockquote>
<blockquote>
<p><a href="http://12306.cn" target="_blank" rel="noopener">http://12306.cn</a>  和 <a href="http://www.12306.cn" target="_blank" rel="noopener">http://www.12306.cn</a> 是不同域名</p>
</blockquote>
<h4 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h4><blockquote>
<h3 id="http-baidu-com-可以向-http-www-baidu-com-发AJAX请求吗"><a href="#http-baidu-com-可以向-http-www-baidu-com-发AJAX请求吗" class="headerlink" title="http://baidu.com 可以向 http://www.baidu.com 发AJAX请求吗  ?"></a><a href="http://baidu.com" target="_blank" rel="noopener">http://baidu.com</a> 可以向 <a href="http://www.baidu.com" target="_blank" rel="noopener">http://www.baidu.com</a> 发AJAX请求吗  ?</h3></blockquote>
<blockquote>
<h3 id="http-www-baidu-com-可以向-http-baidu-com-发AJAX请求吗"><a href="#http-www-baidu-com-可以向-http-baidu-com-发AJAX请求吗" class="headerlink" title="http://www.baidu.com 可以向 http://baidu.com 发AJAX请求吗  ?"></a><a href="http://www.baidu.com" target="_blank" rel="noopener">http://www.baidu.com</a> 可以向 <a href="http://baidu.com" target="_blank" rel="noopener">http://baidu.com</a> 发AJAX请求吗  ?</h3></blockquote>
<h4 id="如果没有同源策略的限制"><a href="#如果没有同源策略的限制" class="headerlink" title="如果没有同源策略的限制"></a>如果没有同源策略的限制</h4><blockquote>
<p>任何一个网站都可以访问你支付宝的余额，QQ空间，你写的私密博客。</p>
</blockquote>
<blockquote>
<p>没有同源策略的浏览器就会让你的所有隐私泄露。</p>
</blockquote>
<h4 id="如果-A站的前端实在想访问B站的内容"><a href="#如果-A站的前端实在想访问B站的内容" class="headerlink" title="如果 A站的前端实在想访问B站的内容"></a>如果 A站的前端实在想访问B站的内容</h4><blockquote>
<p>可以 B站后台设置一个参数 Accept-Control-Allow-Origin<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//我允许这个域名访问</span><br><span class="line">response.setHeader(&apos;Accept-Control-Allow-Origin&apos;, &apos;http://A.com:8001&apos;)</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h4 id="浏览器必须保证"><a href="#浏览器必须保证" class="headerlink" title="浏览器必须保证"></a>浏览器必须保证</h4><ul>
<li>协议+端口+域名 一模一样才允许发AJAX请求</li>
<li>CORS 可以告诉浏览器 我俩是一家的别阻止他</li>
</ul>
<h3 id="CORS-跨域资源共享"><a href="#CORS-跨域资源共享" class="headerlink" title="CORS 跨域资源共享"></a>CORS 跨域资源共享</h3><blockquote>
<h3 id="Cross-Origin-Resource-Sharing"><a href="#Cross-Origin-Resource-Sharing" class="headerlink" title="Cross-Origin Resource Sharing"></a>Cross-Origin Resource Sharing</h3></blockquote>
<h2 id="谨记"><a href="#谨记" class="headerlink" title="谨记"></a>谨记</h2><ol>
<li>你才返回”对象”，你全家才返回 “对象”</li>
<li>JS是一门语言，JSON是另一门语言，JSON 这门语言抄袭了JS</li>
<li>AJAX就是用JS发请求</li>
<li>响应的第四部分是字符串，可以用JSON语法表示一个对象，也可以用JSON语法表示一个数组，还可以用XML语法，还可以用HTML语法，还可以用CSS语法，还可以用JS语法，还可以用你自创的语法。</li>
</ol>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/前端知识点/">前端知识点</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/12/03/N033_JSONP是什么鬼/" title="JSONP是什么鬼" itemprop="url">JSONP是什么鬼</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Stevin" target="_blank" itemprop="author">Stevin</a>
		
  <p class="article-time">
    <time datetime="2017-12-03T07:41:37.000Z" itemprop="datePublished"> Published 2017-12-03</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h1 id="什么是jsonp"><a href="#什么是jsonp" class="headerlink" title="什么是jsonp"></a>什么是jsonp</h1><h2 id="从零开始构建"><a href="#从零开始构建" class="headerlink" title="从零开始构建"></a>从零开始构建</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir jsonp_demo  //创建目录 jsonp_demo</span><br><span class="line">cd jsonp_demo     //切换目录到 json_demo</span><br><span class="line">touch server001.js</span><br><span class="line">touch index001.html</span><br></pre></td></tr></table></figure>
<h2 id="版本一"><a href="#版本一" class="headerlink" title="版本一"></a>版本一</h2><blockquote>
<h3 id="server001-js"><a href="#server001-js" class="headerlink" title="server001.js"></a>server001.js</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">var http = require(&apos;http&apos;)</span><br><span class="line">var fs = require(&apos;fs&apos;)</span><br><span class="line">var url = require(&apos;url&apos;)</span><br><span class="line">var port = process.argv[2]</span><br><span class="line"></span><br><span class="line">if(!port)&#123;</span><br><span class="line">  console.log(&apos;请指定端口号好不啦？\nnode server.js 8888 这样不会吗？&apos;)</span><br><span class="line">  process.exit(1)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var server = http.createServer(function(request, response)&#123;</span><br><span class="line">  var parsedUrl = url.parse(request.url, true)</span><br><span class="line">  var pathWithQuery = request.url </span><br><span class="line">  var queryString = &apos;&apos;</span><br><span class="line">  if(pathWithQuery.indexOf(&apos;?&apos;) &gt;= 0)&#123; queryString = pathWithQuery.substring(pathWithQuery.indexOf(&apos;?&apos;)) &#125;</span><br><span class="line">  var path = parsedUrl.pathname</span><br><span class="line">  var query = parsedUrl.query</span><br><span class="line">  var method = request.method</span><br><span class="line"></span><br><span class="line">  /******** 从这里开始看，上面不要看 ************/</span><br><span class="line"></span><br><span class="line">  console.log(&apos;被请求后：含查询字符串的路径\n&apos; + pathWithQuery)</span><br><span class="line"></span><br><span class="line">  if(path==&apos;/&apos;)&#123;</span><br><span class="line">    var string = fs.readFileSync(&apos;./index001.html&apos;,&apos;utf8&apos;);</span><br><span class="line">    response.setHeader(&apos;Content-Type&apos;,&apos;text/html;charset=utf-8&apos;);</span><br><span class="line">    response.write(string);</span><br><span class="line">    response.end();</span><br><span class="line">  &#125;else&#123;</span><br><span class="line">    response.statusCode = 404;</span><br><span class="line">    response.end();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  /******** 代码结束，下面不要看 ************/</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">server.listen(port)</span><br><span class="line">console.log(&apos;监听 &apos; + port + &apos; 成功\n请在浏览器输入 http://localhost:&apos; + port)</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p>当前目录下 新建index.html main.js style.css (main.js/style.css内容为空暂时不需要)</p>
<h4 id="index-html"><a href="#index-html" class="headerlink" title="index.html"></a>index.html</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot;&gt;</span><br><span class="line">    &lt;link rel=&quot;stylesheet&quot; href=&quot;./style.css&quot;&gt;</span><br><span class="line">    &lt;title&gt;Document&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h5&gt;您的账户余额是 &lt;span id=&quot;amount&quot;&gt;100&lt;/span&gt; &lt;/h5&gt;</span><br><span class="line">    &lt;button id=&quot;btn&quot;&gt;付款1块钱&lt;/button&gt;</span><br><span class="line">    &lt;script src=&quot;./main.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        btn.addEventListener(&apos;click&apos;,()=&gt;&#123;</span><br><span class="line">            let n = amount.innerText;</span><br><span class="line">            let number = parseInt(n,10);</span><br><span class="line">            let newNumber = number - 1;</span><br><span class="line">            amount.innerText = newNumber;</span><br><span class="line">        &#125;)</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="运行-server001-js-所在目录-打开命令行运行"><a href="#运行-server001-js-所在目录-打开命令行运行" class="headerlink" title="运行 server001.js 所在目录  打开命令行运行"></a>运行 server001.js 所在目录  打开命令行运行</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">node server001.js 9999</span><br><span class="line">//你会看到</span><br><span class="line">监听 9999 成功</span><br><span class="line">请在浏览器输入 http://localhost:9999</span><br></pre></td></tr></table></figure>
<blockquote>
<p>打开浏览器输入 <a href="http://localhost:9999" target="_blank" rel="noopener">http://localhost:9999</a></p>
</blockquote>
<blockquote>
<p><img src="https://raw.githubusercontent.com/slTrust/note/master/img/note033_0.png" alt="运行后"></p>
</blockquote>
<blockquote>
<p>点击按钮后你会看到  余额变动如下</p>
</blockquote>
<blockquote>
<p><img src="https://raw.githubusercontent.com/slTrust/note/master/img/note033_1.png" alt="点击付款"></p>
</blockquote>
<h4 id="问题1-每次点击按钮都会把余额减1-但是浏览器只要刷新就会重新显示100"><a href="#问题1-每次点击按钮都会把余额减1-但是浏览器只要刷新就会重新显示100" class="headerlink" title="问题1 每次点击按钮都会把余额减1 但是浏览器只要刷新就会重新显示100"></a>问题1 每次点击按钮都会把余额减1 但是浏览器只要刷新就会重新显示100</h4><blockquote>
<p>如何长久的保存用户的数据呢？不可能你的余额永远是100吧  那岂不是有花不完的钱</p>
</blockquote>
<h4 id="长久的保存用户数据-保存到文件里"><a href="#长久的保存用户数据-保存到文件里" class="headerlink" title="长久的保存用户数据  保存到文件里"></a>长久的保存用户数据  保存到文件里</h4><blockquote>
<p>文件系统 将数据保存到服务器的文件里 这个文件专门为这个用户服务<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">touch db //创建 db 文件  </span><br><span class="line"></span><br><span class="line">vi db //打开之后写入100</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="版本二"><a href="#版本二" class="headerlink" title="版本二"></a>版本二</h2><h4 id="修改html里写死的100-换用一个‘匹配’字符替换-gt-“-amp-amp-amp-amount-amp-amp-amp-”"><a href="#修改html里写死的100-换用一个‘匹配’字符替换-gt-“-amp-amp-amp-amount-amp-amp-amp-”" class="headerlink" title="修改html里写死的100  换用一个‘匹配’字符替换 ==&gt; “&amp;&amp;&amp;amount&amp;&amp;&amp;”"></a>修改html里写死的100  换用一个‘匹配’字符替换 ==&gt; “&amp;&amp;&amp;amount&amp;&amp;&amp;”</h4><blockquote>
<p>index002.html<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//将这一行</span><br><span class="line">&lt;h5&gt;您的账户余额是 &lt;span id=&quot;amount&quot;&gt;100&lt;/span&gt; &lt;/h5&gt;</span><br><span class="line">//修改为</span><br><span class="line">//自己定义替换的匹配字符串 &quot;&amp;&amp;&amp;amount&amp;&amp;&amp;&quot; </span><br><span class="line">&lt;h5&gt;您的账户余额是 &lt;span id=&quot;amount&quot;&gt; &amp;&amp;&amp;amount&amp;&amp;&amp;&lt;/span&gt; &lt;/h5&gt;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>server002.js 修改如下内容  从db读取 用户余额<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">if(path==&apos;/&apos;)&#123;</span><br><span class="line">   var string = fs.readFileSync(&apos;./index002.html&apos;,&apos;utf8&apos;);</span><br><span class="line">   //读取db文件里用户余额</span><br><span class="line">   var amount = fs.readFileSync(&apos;./db&apos;,&apos;utf8&apos;); //100</span><br><span class="line">   //替换 index002.html 里定义的 匹配字符 为 用户余额</span><br><span class="line">   string = string.replace(&apos;&amp;&amp;&amp;amount&amp;&amp;&amp;&apos;,amount);</span><br><span class="line">   response.setHeader(&apos;Content-Type&apos;,&apos;text/html;charset=utf-8&apos;);</span><br><span class="line">   response.write(string);</span><br><span class="line">   response.end();</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>这样做了之后你会发现 一刷新 数据还是100 </p>
</blockquote>
<h4 id="解决长久保存"><a href="#解决长久保存" class="headerlink" title="解决长久保存"></a>解决长久保存</h4><blockquote>
<p>我们点击付款的时候  告诉服务器 请把数据库里的余额给我</p>
</blockquote>
<blockquote>
<p>所以我们点击付款的时候不能单独修改本地了 要去给服务器发 post请求</p>
</blockquote>
<blockquote>
<h3 id="为什么不是get-付款啊！这么重要的操作你敢用get"><a href="#为什么不是get-付款啊！这么重要的操作你敢用get" class="headerlink" title="为什么不是get 付款啊！这么重要的操作你敢用get?"></a>为什么不是get 付款啊！这么重要的操作你敢用get?</h3></blockquote>
<h2 id="版本三"><a href="#版本三" class="headerlink" title="版本三"></a>版本三</h2><h4 id="index003-html"><a href="#index003-html" class="headerlink" title="index003.html"></a>index003.html</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;h5&gt;您的账户余额是 &lt;span id=&quot;amount&quot;&gt;&amp;&amp;&amp;amount&amp;&amp;&amp;&lt;/span&gt;&lt;/h5&gt;</span><br><span class="line">&lt;form action=&quot;/pay&quot; method=&quot;post&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; value=&quot;付款1块钱&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>
<h4 id="server003-js"><a href="#server003-js" class="headerlink" title="server003.js"></a>server003.js</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">if(path==&apos;/&apos;)&#123;</span><br><span class="line">  var string = fs.readFileSync(&apos;./index003.html&apos;,&apos;utf8&apos;);</span><br><span class="line">  var amount = fs.readFileSync(&apos;./db&apos;,&apos;utf8&apos;); //100</span><br><span class="line">  string = string.replace(&apos;&amp;&amp;&amp;amount&amp;&amp;&amp;&apos;,amount);</span><br><span class="line">  response.setHeader(&apos;Content-Type&apos;,&apos;text/html;charset=utf-8&apos;);</span><br><span class="line">  response.write(string);</span><br><span class="line">  response.end();</span><br><span class="line">&#125;else if(path==&apos;/pay&apos;&amp;&amp; method.toUpperCase() === &apos;POST&apos;)&#123;</span><br><span class="line">  //读取 db中用户余额</span><br><span class="line">  var amount = fs.readFileSync(&apos;./db&apos;,&apos;utf8&apos;); </span><br><span class="line">  var newAmount = amount - 1;  //余额减1</span><br><span class="line">  fs.writeFileSync(&apos;./db&apos;,newAmount);  //更新余额 </span><br><span class="line">  response.write(&apos;success&apos;);</span><br><span class="line">  response.end();</span><br><span class="line">&#125;else&#123;</span><br><span class="line">  response.statusCode = 404;</span><br><span class="line">  response.end();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="再去开启你的服务器"><a href="#再去开启你的服务器" class="headerlink" title="再去开启你的服务器"></a>再去开启你的服务器</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node server003.js 9999</span><br><span class="line">//在浏览器打开  http://localhost:9999</span><br></pre></td></tr></table></figure>
<p><a href="http://localhost:9999" target="_blank" rel="noopener">http://localhost:9999</a></p>
<ul>
<li>点击付款按钮</li>
<li>跳到 <a href="http://localhost:9999/pay" target="_blank" rel="noopener">http://localhost:9999/pay</a> 页面显示 success</li>
<li>点击浏览器返回   **注意：此时浏览器返回的是缓存页面  你要手动刷新一下</li>
<li>用户余额减少了</li>
</ul>
<blockquote>
<p>你去打开db文件 发现余额改变了</p>
</blockquote>
<h4 id="以上就是最最简单、最最原始的数据库的展示"><a href="#以上就是最最简单、最最原始的数据库的展示" class="headerlink" title="以上就是最最简单、最最原始的数据库的展示"></a>以上就是最最简单、最最原始的数据库的展示</h4><h4 id="再次修改一下server003-js里的代码"><a href="#再次修改一下server003-js里的代码" class="headerlink" title="再次修改一下server003.js里的代码"></a>再次修改一下server003.js里的代码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">else if(path==&apos;/pay&apos;&amp;&amp; method.toUpperCase() === &apos;POST&apos;)&#123;</span><br><span class="line">    //读取 db中用户余额</span><br><span class="line">    var amount = fs.readFileSync(&apos;./db&apos;,&apos;utf8&apos;); </span><br><span class="line">    var newAmount = amount - 1;  //余额减1</span><br><span class="line">    if(Math.random()&gt;0.5)&#123;</span><br><span class="line">        fs.writeFileSync(&apos;./db&apos;,newAmount);  //更新余额 </span><br><span class="line">        response.write(&apos;success&apos;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        response.write(&apos;fail&apos;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    response.end();</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h3 id="以上是：旧时代的前后端配合"><a href="#以上是：旧时代的前后端配合" class="headerlink" title="以上是：旧时代的前后端配合"></a>以上是：旧时代的前后端配合</h3><blockquote>
<p>操作数据库成功返回success 失败返回fail</p>
</blockquote>
<h3 id="在一个2018年的今天"><a href="#在一个2018年的今天" class="headerlink" title="在一个2018年的今天"></a>在一个2018年的今天</h3><blockquote>
<p>用户怎么可能忍受</p>
<ul>
<li>点击付款 </li>
<li>进入成功/失败页面</li>
<li>点击返回</li>
<li>点击刷新才看到你最新的数据</li>
</ul>
</blockquote>
<h3 id="form表单一旦提交不管成功还是失败一定会刷新当前页面"><a href="#form表单一旦提交不管成功还是失败一定会刷新当前页面" class="headerlink" title="form表单一旦提交不管成功还是失败一定会刷新当前页面"></a>form表单一旦提交不管成功还是失败一定会刷新当前页面</h3><h3 id="古老方式-优化一下用户体验"><a href="#古老方式-优化一下用户体验" class="headerlink" title="古老方式-优化一下用户体验"></a>古老方式-优化一下用户体验</h3><blockquote>
<p>用iframe承载这个form的提交 后的 success/fail响应  但是I现在已经没人用啦！</p>
</blockquote>
<h2 id="版本四"><a href="#版本四" class="headerlink" title="版本四"></a>版本四</h2><h4 id="index004-html"><a href="#index004-html" class="headerlink" title="index004.html"></a>index004.html</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h5&gt;您的账户余额是 &lt;span id=&quot;amount&quot;&gt;&amp;&amp;&amp;amount&amp;&amp;&amp;&lt;/span&gt;&lt;/h5&gt;</span><br><span class="line">    &lt;form action=&quot;/pay&quot; method=&quot;post&quot; target=&quot;result&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;submit&quot; value=&quot;付款1块钱&quot;&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">    &lt;iframe name=&quot;result&quot; src=&quot;about:blank&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<h4 id="前端的高度洁癖-不用form向后台发送一个请求"><a href="#前端的高度洁癖-不用form向后台发送一个请求" class="headerlink" title="前端的高度洁癖 不用form向后台发送一个请求"></a>前端的高度洁癖 不用form向后台发送一个请求</h4><h2 id="版本五"><a href="#版本五" class="headerlink" title="版本五"></a>版本五</h2><h4 id="index005-html"><a href="#index005-html" class="headerlink" title="index005.html"></a>index005.html</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;h5&gt;您的账户余额是 &lt;span id=&quot;amount&quot;&gt;&amp;&amp;&amp;amount&amp;&amp;&amp;&lt;/span&gt;&lt;/h5&gt;</span><br><span class="line">&lt;button id=&quot;btn&quot;&gt;打钱&lt;/button&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    btn.addEventListener(&apos;click&apos;,function()&#123;</span><br><span class="line">        let img = document.createElement(&apos;img&apos;);</span><br><span class="line">        img.src = &apos;/pay&apos;;</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>点击按钮的时候 会创建一个img标签 设置它的 src = ‘你的请求路径’ 就会触发请求</p>
</blockquote>
<h4 id="这样的缺陷就是-它无法post-它只能get"><a href="#这样的缺陷就是-它无法post-它只能get" class="headerlink" title="这样的缺陷就是 它无法post 它只能get"></a>这样的缺陷就是 它无法post 它只能get</h4><h4 id="问题来了？-我们如何知道它成功or失败呢？"><a href="#问题来了？-我们如何知道它成功or失败呢？" class="headerlink" title="问题来了？ 我们如何知道它成功or失败呢？"></a>问题来了？ 我们如何知道它成功or失败呢？</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;h5&gt;您的账户余额是 &lt;span id=&quot;amount&quot;&gt;&amp;&amp;&amp;amount&amp;&amp;&amp;&lt;/span&gt;&lt;/h5&gt;</span><br><span class="line">&lt;button id=&quot;btn&quot;&gt;打钱&lt;/button&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    btn.addEventListener(&apos;click&apos;,function()&#123;</span><br><span class="line">        let img = document.createElement(&apos;img&apos;);</span><br><span class="line">        img.src = &apos;/pay&apos;;</span><br><span class="line">        //我们如何知道请求成功or失败呢？ </span><br><span class="line">        img.onload = function()&#123;</span><br><span class="line">            alert(&apos;打钱成功&apos;)</span><br><span class="line">            //我们帮用户刷新  但是会重绘整个页面</span><br><span class="line">            //window.location.reload();</span><br><span class="line">            //因为知道固定减1 所以我帮用户减1</span><br><span class="line">            amount.innerText = amount.innerText - 1;</span><br><span class="line">        &#125;</span><br><span class="line">        img.onerror = function()&#123;</span><br><span class="line">            alert(&apos;打钱失败&apos;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h4 id="server005-js"><a href="#server005-js" class="headerlink" title="server005.js"></a>server005.js</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">else if(path==&apos;/pay&apos;)&#123;</span><br><span class="line">    //读取 db中用户余额</span><br><span class="line">    var amount = fs.readFileSync(&apos;./db&apos;,&apos;utf8&apos;); </span><br><span class="line">    var newAmount = amount - 1;  //余额减1</span><br><span class="line">    if(Math.random()&gt;0.5)&#123;</span><br><span class="line">        fs.writeFileSync(&apos;./db&apos;,newAmount);  //更新余额</span><br><span class="line">        //设置响应头 </span><br><span class="line">        response.setHeader(&apos;Content-Type&apos;,&apos;image/png&apos;);</span><br><span class="line">        //设置状态码</span><br><span class="line">        response.statusCode = 200;</span><br><span class="line">        //返回响应的图片  不然 会走入img.onerror 事件里</span><br><span class="line">        response.write(fs.readFileSync(&apos;./dog.jpg&apos;));</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        response.statusCode = 400;</span><br><span class="line">        response.write(&apos;fail&apos;);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    response.end();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="这样我们就完成了-无刷新的发送请求-俗称-image发请求法"><a href="#这样我们就完成了-无刷新的发送请求-俗称-image发请求法" class="headerlink" title="这样我们就完成了 无刷新的发送请求  俗称 image发请求法"></a>这样我们就完成了 无刷新的发送请求  俗称 image发请求法</h4><h3 id="改良-script发请求法"><a href="#改良-script发请求法" class="headerlink" title="改良 script发请求法"></a>改良 script发请求法</h3><blockquote>
<h4 id="注意动态创建script-同时设置src-必须把script添加到body里才会生效"><a href="#注意动态创建script-同时设置src-必须把script添加到body里才会生效" class="headerlink" title="注意动态创建script 同时设置src 必须把script添加到body里才会生效"></a>注意动态创建script 同时设置src 必须把script添加到body里才会生效</h4></blockquote>
<h2 id="版本六"><a href="#版本六" class="headerlink" title="版本六"></a>版本六</h2><h4 id="server006-js"><a href="#server006-js" class="headerlink" title="server006.js"></a>server006.js</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">/******** 从这里开始看，上面不要看 ************/</span><br><span class="line"></span><br><span class="line">console.log(&apos;被请求后：含查询字符串的路径\n&apos; + pathWithQuery)</span><br><span class="line"></span><br><span class="line">if(path==&apos;/&apos;)&#123;</span><br><span class="line">  var string = fs.readFileSync(&apos;./index006.html&apos;,&apos;utf8&apos;);</span><br><span class="line">  var amount = fs.readFileSync(&apos;./db&apos;,&apos;utf8&apos;); //100</span><br><span class="line">  string = string.replace(&apos;&amp;&amp;&amp;amount&amp;&amp;&amp;&apos;,amount);</span><br><span class="line">  response.setHeader(&apos;Content-Type&apos;,&apos;text/html;charset=utf-8&apos;);</span><br><span class="line">  response.write(string);</span><br><span class="line">  response.end();</span><br><span class="line">&#125;else if(path==&apos;/pay&apos;)&#123;</span><br><span class="line">  //读取 db中用户余额</span><br><span class="line">  var amount = fs.readFileSync(&apos;./db&apos;,&apos;utf8&apos;); </span><br><span class="line">  var newAmount = amount - 1;  //余额减1</span><br><span class="line">  if(Math.random()&gt;0.5)&#123;</span><br><span class="line">      fs.writeFileSync(&apos;./db&apos;,newAmount);  //更新余额</span><br><span class="line">      //设置响应头 </span><br><span class="line">      response.setHeader(&apos;Content-Type&apos;,&apos;application/javascript&apos;);</span><br><span class="line">      //设置状态码</span><br><span class="line">      response.statusCode = 200;</span><br><span class="line">      //返回响应内容</span><br><span class="line">      response.write(&apos;&apos;);</span><br><span class="line">  &#125;else&#123;</span><br><span class="line">      response.statusCode = 400;</span><br><span class="line">      response.write(&apos;fail&apos;);</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  response.end();</span><br><span class="line">&#125;else&#123;</span><br><span class="line">  response.statusCode = 404;</span><br><span class="line">  response.end();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/******** 代码结束，下面不要看 ************/</span><br></pre></td></tr></table></figure>
<h4 id="index006-html"><a href="#index006-html" class="headerlink" title="index006.html"></a>index006.html</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;h5&gt;您的账户余额是 &lt;span id=&quot;amount&quot;&gt;&amp;&amp;&amp;amount&amp;&amp;&amp;&lt;/span&gt;&lt;/h5&gt;</span><br><span class="line">&lt;button id=&quot;btn&quot;&gt;打钱&lt;/button&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    btn.addEventListener(&apos;click&apos;,function()&#123;</span><br><span class="line">        let script = document.createElement(&apos;script&apos;);</span><br><span class="line">        script.src = &apos;/pay&apos;;</span><br><span class="line">        document.body.appendChild(script);</span><br><span class="line">        //我们如何知道请求成功or失败呢？ </span><br><span class="line">        script.onload = function()&#123;</span><br><span class="line">            alert(&apos;打钱成功&apos;)</span><br><span class="line">        &#125;</span><br><span class="line">        script.onerror = function()&#123;</span><br><span class="line">            alert(&apos;打钱失败&apos;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>这样每次点击会生成一个script </p>
</blockquote>
<h4 id="我们知道-script里的代码是会执行的"><a href="#我们知道-script里的代码是会执行的" class="headerlink" title="我们知道 script里的代码是会执行的"></a>我们知道 script里的代码是会执行的</h4><blockquote>
<p>所以我们就不需要在 server006.js里写失败的情况 它会自动进入 script.onerror里</p>
</blockquote>
<h4 id="step1修改server006-js"><a href="#step1修改server006-js" class="headerlink" title="step1修改server006.js"></a>step1修改server006.js</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">else if(path==&apos;/pay&apos;)&#123;</span><br><span class="line">    //读取 db中用户余额</span><br><span class="line">    var amount = fs.readFileSync(&apos;./db&apos;,&apos;utf8&apos;); </span><br><span class="line">    var newAmount = amount - 1;  //余额减1</span><br><span class="line"> </span><br><span class="line">    fs.writeFileSync(&apos;./db&apos;,newAmount);  //更新余额</span><br><span class="line">    //设置响应头 </span><br><span class="line">    response.setHeader(&apos;Content-Type&apos;,&apos;application/javascript&apos;);</span><br><span class="line">    //设置状态码</span><br><span class="line">    response.statusCode = 200;</span><br><span class="line">    //返回响应内容</span><br><span class="line">    response.write(&apos;alert(&quot;pay&quot;)&apos;);</span><br><span class="line">   </span><br><span class="line">    response.end();</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>运行发现如果成功了 就会 弹出pay  然后再弹出‘打钱成功’</p>
</blockquote>
<h4 id="不用监听script-onload了"><a href="#不用监听script-onload了" class="headerlink" title="不用监听script.onload了"></a>不用监听script.onload了</h4><blockquote>
<p>因为 成功自然会在server006.js 里 写入并执行 response.write(‘alert(“pay”)’);</p>
</blockquote>
<h2 id="版本七"><a href="#版本七" class="headerlink" title="版本七"></a>版本七</h2><h4 id="index007-html"><a href="#index007-html" class="headerlink" title="index007.html"></a>index007.html</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;h5&gt;您的账户余额是 &lt;span id=&quot;amount&quot;&gt;&amp;&amp;&amp;amount&amp;&amp;&amp;&lt;/span&gt;&lt;/h5&gt;</span><br><span class="line">&lt;button id=&quot;btn&quot;&gt;打钱&lt;/button&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    btn.addEventListener(&apos;click&apos;,function()&#123;</span><br><span class="line">        let script = document.createElement(&apos;script&apos;);</span><br><span class="line">        script.src = &apos;/pay&apos;;</span><br><span class="line">        document.body.appendChild(script);</span><br><span class="line">        script.onerror = function()&#123;</span><br><span class="line">            alert(&apos;打钱失败&apos;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h4 id="server007-js"><a href="#server007-js" class="headerlink" title="server007.js"></a>server007.js</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">else if(path==&apos;/pay&apos;)&#123;</span><br><span class="line">    //读取 db中用户余额</span><br><span class="line">    var amount = fs.readFileSync(&apos;./db&apos;,&apos;utf8&apos;); </span><br><span class="line">    var newAmount = amount - 1;  //余额减1</span><br><span class="line"> </span><br><span class="line">    fs.writeFileSync(&apos;./db&apos;,newAmount);  //更新余额</span><br><span class="line">    //设置响应头 </span><br><span class="line">    response.setHeader(&apos;Content-Type&apos;,&apos;application/javascript&apos;);</span><br><span class="line">    //设置状态码</span><br><span class="line">    response.statusCode = 200;</span><br><span class="line">    //返回响应内容</span><br><span class="line">    response.write(</span><br><span class="line">      `</span><br><span class="line">      amount.innerText = amount.innerText - 1;</span><br><span class="line">      `</span><br><span class="line">    );</span><br><span class="line">   </span><br><span class="line">    response.end();</span><br></pre></td></tr></table></figure>
<h4 id="优化上面运行后每次点击按钮页面都会多一个script标签"><a href="#优化上面运行后每次点击按钮页面都会多一个script标签" class="headerlink" title="优化上面运行后每次点击按钮页面都会多一个script标签"></a>优化上面运行后每次点击按钮页面都会多一个script标签</h4><blockquote>
<p>成功或者失败后干掉script</p>
</blockquote>
<h2 id="版本八"><a href="#版本八" class="headerlink" title="版本八"></a>版本八</h2><h4 id="index008-html"><a href="#index008-html" class="headerlink" title="index008.html"></a>index008.html</h4><blockquote>
<p>注意:server里文件路径</p>
</blockquote>
<blockquote>
<p>所以我们还是得监听onload事件</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;h5&gt;您的账户余额是 &lt;span id=&quot;amount&quot;&gt;&amp;&amp;&amp;amount&amp;&amp;&amp;&lt;/span&gt;&lt;/h5&gt;</span><br><span class="line">&lt;button id=&quot;btn&quot;&gt;打钱&lt;/button&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    btn.addEventListener(&apos;click&apos;,function()&#123;</span><br><span class="line">        let script = document.createElement(&apos;script&apos;);</span><br><span class="line">        script.src = &apos;/pay&apos;;</span><br><span class="line">        document.body.appendChild(script);</span><br><span class="line">        script.onload = function(e)&#123;</span><br><span class="line">            alert(&apos;打钱成功&apos;)</span><br><span class="line">            e.currentTarget.remove();</span><br><span class="line">        &#125;</span><br><span class="line">        script.onerror = function(e)&#123;</span><br><span class="line">            alert(&apos;打钱失败&apos;)</span><br><span class="line">            e.currentTarget.remove();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<h4 id="注意：不管成功还是失败script都会移除-但是script还在内存里只是从页面移除了"><a href="#注意：不管成功还是失败script都会移除-但是script还在内存里只是从页面移除了" class="headerlink" title="注意：不管成功还是失败script都会移除 但是script还在内存里只是从页面移除了"></a>注意：不管成功还是失败script都会移除 但是script还在内存里只是从页面移除了</h4></blockquote>
<h4 id="这个方案就叫-SRJ-Server-rendered-javascript-服务器返回的-javascript"><a href="#这个方案就叫-SRJ-Server-rendered-javascript-服务器返回的-javascript" class="headerlink" title="这个方案就叫 SRJ  (Server rendered javascript)服务器返回的 javascript"></a>这个方案就叫 SRJ  (Server rendered javascript)服务器返回的 javascript</h4><blockquote>
<p>无刷新局部更新页面内容的方案 在ajax之前</p>
</blockquote>
<h3 id="script是不受域名限制的-这跟跨域没关系"><a href="#script是不受域名限制的-这跟跨域没关系" class="headerlink" title="script是不受域名限制的 这跟跨域没关系"></a>script是不受域名限制的 这跟跨域没关系</h3><blockquote>
<p>aa.com:9999的前端 是可以访问  bb.com:8888的后台接口的 这就是SRJ</p>
</blockquote>
<h3 id="JSONP"><a href="#JSONP" class="headerlink" title="JSONP"></a>JSONP</h3><h4 id="查看后端代码-发现–-后端要对前端代码非常了解"><a href="#查看后端代码-发现–-后端要对前端代码非常了解" class="headerlink" title="查看后端代码 发现– 后端要对前端代码非常了解"></a>查看后端代码 发现– 后端要对前端代码非常了解</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">else if(path==&apos;/pay&apos;)&#123;</span><br><span class="line">    //读取 db中用户余额</span><br><span class="line">    var amount = fs.readFileSync(&apos;./db&apos;,&apos;utf8&apos;); </span><br><span class="line">    var newAmount = amount - 1;  //余额减1</span><br><span class="line"> </span><br><span class="line">    fs.writeFileSync(&apos;./db&apos;,newAmount);  //更新余额</span><br><span class="line">    //设置响应头 </span><br><span class="line">    response.setHeader(&apos;Content-Type&apos;,&apos;application/javascript&apos;);</span><br><span class="line">    //设置状态码</span><br><span class="line">    response.statusCode = 200;</span><br><span class="line">    //返回响应内容</span><br><span class="line">    response.write(</span><br><span class="line">      `</span><br><span class="line">      amount.innerText = amount.innerText - 1;</span><br><span class="line">      `</span><br><span class="line">    );</span><br><span class="line">   </span><br><span class="line">    response.end();</span><br></pre></td></tr></table></figure>
<blockquote>
<p>bb.com:8888的后端居然要对 aa.com:9999的页面如此清楚</p>
</blockquote>
<h4 id="耦合"><a href="#耦合" class="headerlink" title="耦合"></a>耦合</h4><h4 id="解耦"><a href="#解耦" class="headerlink" title="解耦"></a>解耦</h4><h2 id="版本九"><a href="#版本九" class="headerlink" title="版本九"></a>版本九</h2><h4 id="index009-html"><a href="#index009-html" class="headerlink" title="index009.html"></a>index009.html</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;h5&gt;您的账户余额是 &lt;span id=&quot;amount&quot;&gt;&amp;&amp;&amp;amount&amp;&amp;&amp;&lt;/span&gt;&lt;/h5&gt;</span><br><span class="line">&lt;button id=&quot;btn&quot;&gt;打钱&lt;/button&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    //某域名下的前端  bb.com:9999的前端</span><br><span class="line">    window.xxx = function(result)&#123;</span><br><span class="line">        alert(`得到了结果是$&#123;result&#125;`);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    btn.addEventListener(&apos;click&apos;,function()&#123;</span><br><span class="line">        let script = document.createElement(&apos;script&apos;);</span><br><span class="line">        script.src = &apos;/pay&apos;;</span><br><span class="line">        document.body.appendChild(script);</span><br><span class="line">        script.onload = function(e)&#123;</span><br><span class="line">            e.currentTarget.remove();</span><br><span class="line">        &#125;</span><br><span class="line">        script.onerror = function(e)&#123;</span><br><span class="line">            alert(&apos;打钱失败&apos;)</span><br><span class="line">            e.currentTarget.remove();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    &lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h4 id="server009-js"><a href="#server009-js" class="headerlink" title="server009.js"></a>server009.js</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">else if(path==&apos;/pay&apos;)&#123;</span><br><span class="line">    //读取 db中用户余额</span><br><span class="line">    var amount = fs.readFileSync(&apos;./db&apos;,&apos;utf8&apos;); </span><br><span class="line">    var newAmount = amount - 1;  //余额减1</span><br><span class="line"> </span><br><span class="line">    fs.writeFileSync(&apos;./db&apos;,newAmount);  //更新余额</span><br><span class="line">    //设置响应头 </span><br><span class="line">    response.setHeader(&apos;Content-Type&apos;,&apos;application/javascript&apos;);</span><br><span class="line">    //设置状态码</span><br><span class="line">    response.statusCode = 200;</span><br><span class="line">    //返回响应内容</span><br><span class="line">    response.write(</span><br><span class="line">      `</span><br><span class="line">      xxx.call(undefined,&apos;success&apos;) //执行xxx方法并返回  字符串</span><br><span class="line">      `</span><br><span class="line">    );</span><br><span class="line">   </span><br><span class="line">    response.end();</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h3 id="这样的好处是什么"><a href="#这样的好处是什么" class="headerlink" title="这样的好处是什么"></a>这样的好处是什么</h3><ul>
<li>后端不需要知道任何细节，只调用xxx.call()返回结果</li>
<li>这样两个网站之间就可以无缝的沟通</li>
</ul>
<h4 id="xxx-call-是不是很丑？"><a href="#xxx-call-是不是很丑？" class="headerlink" title="xxx.call()是不是很丑？"></a>xxx.call()是不是很丑？</h4><ul>
<li>于是传递一个参数callback=xxx </li>
<li>callback =’你自己定义的方法名’</li>
</ul>
<h2 id="版本十"><a href="#版本十" class="headerlink" title="版本十"></a>版本十</h2><h4 id="index010-html"><a href="#index010-html" class="headerlink" title="index010.html"></a>index010.html</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;h5&gt;您的账户余额是 &lt;span id=&quot;amount&quot;&gt;&amp;&amp;&amp;amount&amp;&amp;&amp;&lt;/span&gt;&lt;/h5&gt;</span><br><span class="line">&lt;button id=&quot;btn&quot;&gt;打钱&lt;/button&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    //某域名下的前端  bb.com:9999的前端</span><br><span class="line">    window.yyy = function(result)&#123;</span><br><span class="line">        alert(`得到了结果是$&#123;result&#125;`);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    btn.addEventListener(&apos;click&apos;,function()&#123;</span><br><span class="line">        let script = document.createElement(&apos;script&apos;);</span><br><span class="line">        //传递自己定义的方法名</span><br><span class="line">        script.src = &apos;/pay?callback=yyy&apos;;</span><br><span class="line">        document.body.appendChild(script);</span><br><span class="line">        script.onload = function(e)&#123;</span><br><span class="line">            e.currentTarget.remove();</span><br><span class="line">        &#125;</span><br><span class="line">        script.onerror = function(e)&#123;</span><br><span class="line">            alert(&apos;打钱失败&apos;)</span><br><span class="line">            e.currentTarget.remove();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h4 id="server010-js"><a href="#server010-js" class="headerlink" title="server010.js"></a>server010.js</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">else if(path==&apos;/pay&apos;)&#123;</span><br><span class="line">    //读取 db中用户余额</span><br><span class="line">    var amount = fs.readFileSync(&apos;./db&apos;,&apos;utf8&apos;); </span><br><span class="line">    var newAmount = amount - 1;  //余额减1</span><br><span class="line"> </span><br><span class="line">    fs.writeFileSync(&apos;./db&apos;,newAmount);  //更新余额</span><br><span class="line">    //设置响应头 </span><br><span class="line">    response.setHeader(&apos;Content-Type&apos;,&apos;application/javascript&apos;);</span><br><span class="line">    //设置状态码</span><br><span class="line">    response.statusCode = 200;</span><br><span class="line">    //返回响应内容</span><br><span class="line">    response.write(</span><br><span class="line">      `</span><br><span class="line">      $&#123;query.callback&#125;.call(undefined,&apos;success&apos;)</span><br><span class="line">      `</span><br><span class="line">    );</span><br><span class="line">   </span><br><span class="line">    response.end();</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h4 id="JSONP解决的问题是什么-两个网站之间如何交流"><a href="#JSONP解决的问题是什么-两个网站之间如何交流" class="headerlink" title="JSONP解决的问题是什么  两个网站之间如何交流"></a>JSONP解决的问题是什么  两个网站之间如何交流</h4><ul>
<li>因为script是不受域名限制的 ajax是受域名限制的</li>
<li>由于不受域名限制,我就告诉对方的网站 我要请求一个数据，</li>
<li>请你把数据给我 </li>
<li>你给我之后调用我的xxx </li>
<li>然后把参数给我 xxx.call(undefined,参数)</li>
</ul>
<h4 id="传递的参数不仅仅是字符串还可以是json"><a href="#传递的参数不仅仅是字符串还可以是json" class="headerlink" title="传递的参数不仅仅是字符串还可以是json"></a>传递的参数不仅仅是字符串还可以是json</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">response.write(</span><br><span class="line">     `</span><br><span class="line">     $&#123;query.callback&#125;.call(undefined,&#123;</span><br><span class="line">         &quot;success&quot;:true,</span><br><span class="line">         &quot;data&quot;:99</span><br><span class="line">     &#125;)</span><br><span class="line">     `</span><br><span class="line">   );</span><br></pre></td></tr></table></figure>
<blockquote>
<p>json<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;success&quot;:true,</span><br><span class="line">    &quot;data&quot;:99</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>json的左边是 左padding : ${query.callback}.call(undefined,</p>
</blockquote>
<blockquote>
<p>json的右边是 右padding : )</p>
</blockquote>
<blockquote>
<p>于是乎   JSON + padding = JSONP</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/slTrust/note/master/img/note033_2.png" alt="jsonp"></p>
<h2 id="版本十一"><a href="#版本十一" class="headerlink" title="版本十一"></a>版本十一</h2><h3 id="index011-html"><a href="#index011-html" class="headerlink" title="index011.html"></a>index011.html</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;h5&gt;您的账户余额是 &lt;span id=&quot;amount&quot;&gt;&amp;&amp;&amp;amount&amp;&amp;&amp;&lt;/span&gt;&lt;/h5&gt;</span><br><span class="line">&lt;button id=&quot;btn&quot;&gt;打钱&lt;/button&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    btn.addEventListener(&apos;click&apos;,function()&#123;</span><br><span class="line">        let script = document.createElement(&apos;script&apos;);</span><br><span class="line"></span><br><span class="line">        //生成无重复的方法名</span><br><span class="line">        let fnName = &apos;hjx&apos;+parseInt(Math.random()*100000,10);</span><br><span class="line">        window[fnName] = function(result)&#123;</span><br><span class="line">            //根据接收的json结果做处理</span><br><span class="line">            if(result === &apos;success&apos;)&#123;</span><br><span class="line">                amount.innerText = amount.innerText - 1;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        //传递自己定义的方法名</span><br><span class="line">        script.src = &apos;/pay?callback=&apos; + fnName;</span><br><span class="line">        document.body.appendChild(script);</span><br><span class="line">        script.onload = function(e)&#123;</span><br><span class="line">            e.currentTarget.remove();</span><br><span class="line">            //不管成功失败都要删除生成的fnName属性</span><br><span class="line">            delete window[fnName];</span><br><span class="line">        &#125;</span><br><span class="line">        script.onerror = function(e)&#123;</span><br><span class="line">            alert(&apos;打钱失败&apos;)</span><br><span class="line">            e.currentTarget.remove();</span><br><span class="line">            //不管成功失败都要删除生成的fnName属性</span><br><span class="line">            delete window[fnName];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h3 id="server011-js"><a href="#server011-js" class="headerlink" title="server011.js"></a>server011.js</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">var http = require(&apos;http&apos;)</span><br><span class="line">var fs = require(&apos;fs&apos;)</span><br><span class="line">var url = require(&apos;url&apos;)</span><br><span class="line">var port = process.argv[2]</span><br><span class="line"></span><br><span class="line">if(!port)&#123;</span><br><span class="line">  console.log(&apos;请指定端口号好不啦？\nnode server.js 8888 这样不会吗？&apos;)</span><br><span class="line">  process.exit(1)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var server = http.createServer(function(request, response)&#123;</span><br><span class="line">  var parsedUrl = url.parse(request.url, true)</span><br><span class="line">  var pathWithQuery = request.url </span><br><span class="line">  var queryString = &apos;&apos;</span><br><span class="line">  if(pathWithQuery.indexOf(&apos;?&apos;) &gt;= 0)&#123; queryString = pathWithQuery.substring(pathWithQuery.indexOf(&apos;?&apos;)) &#125;</span><br><span class="line">  var path = parsedUrl.pathname</span><br><span class="line">  var query = parsedUrl.query</span><br><span class="line">  var method = request.method</span><br><span class="line"></span><br><span class="line">  /******** 从这里开始看，上面不要看 ************/</span><br><span class="line"></span><br><span class="line">  console.log(&apos;被请求后：含查询字符串的路径\n&apos; + pathWithQuery)</span><br><span class="line"></span><br><span class="line">  if(path==&apos;/&apos;)&#123;</span><br><span class="line">    var string = fs.readFileSync(&apos;./index011.html&apos;,&apos;utf8&apos;);</span><br><span class="line">    var amount = fs.readFileSync(&apos;./db&apos;,&apos;utf8&apos;); //100</span><br><span class="line">    string = string.replace(&apos;&amp;&amp;&amp;amount&amp;&amp;&amp;&apos;,amount);</span><br><span class="line">    response.setHeader(&apos;Content-Type&apos;,&apos;text/html;charset=utf-8&apos;);</span><br><span class="line">    response.write(string);</span><br><span class="line">    response.end();</span><br><span class="line">  &#125;else if(path==&apos;/style.css&apos;)&#123;</span><br><span class="line">    var string = fs.readFileSync(&apos;./style.css&apos;,&apos;utf8&apos;);</span><br><span class="line">    response.setHeader(&apos;Content-Type&apos;,&apos;text/css&apos;);</span><br><span class="line">    response.write(string);</span><br><span class="line">    response.end();</span><br><span class="line">  &#125;else if(path==&apos;/main.js&apos;)&#123;</span><br><span class="line">    var string = fs.readFileSync(&apos;./main.js&apos;,&apos;utf8&apos;);</span><br><span class="line">    response.setHeader(&apos;Content-Type&apos;,&apos;text/javascript&apos;);</span><br><span class="line">    response.write(string);</span><br><span class="line">    response.end();</span><br><span class="line">  &#125;else if(path==&apos;/pay&apos;)&#123;</span><br><span class="line">    //读取 db中用户余额</span><br><span class="line">    var amount = fs.readFileSync(&apos;./db&apos;,&apos;utf8&apos;); </span><br><span class="line">    var newAmount = amount - 1;  //余额减1</span><br><span class="line"> </span><br><span class="line">    fs.writeFileSync(&apos;./db&apos;,newAmount);  //更新余额</span><br><span class="line">    //设置响应头 </span><br><span class="line">    response.setHeader(&apos;Content-Type&apos;,&apos;application/javascript&apos;);</span><br><span class="line">    //设置状态码</span><br><span class="line">    response.statusCode = 200;</span><br><span class="line">    //返回响应内容</span><br><span class="line">    response.write(</span><br><span class="line">      `</span><br><span class="line">      $&#123;query.callback&#125;.call(undefined,&apos;success&apos;)</span><br><span class="line">      `</span><br><span class="line">    );</span><br><span class="line">   </span><br><span class="line">    response.end();</span><br><span class="line">  &#125;else&#123;</span><br><span class="line">    response.statusCode = 404;</span><br><span class="line">    response.end();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  /******** 代码结束，下面不要看 ************/</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">server.listen(port)</span><br><span class="line">console.log(&apos;监听 &apos; + port + &apos; 成功\n请在浏览器输入 http://localhost:&apos; + port)</span><br></pre></td></tr></table></figure>
<h4 id="写了那么多-其实你可以使用jQuery-几句话就能搞定"><a href="#写了那么多-其实你可以使用jQuery-几句话就能搞定" class="headerlink" title="写了那么多  其实你可以使用jQuery 几句话就能搞定"></a>写了那么多  其实你可以使用jQuery 几句话就能搞定</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;h5&gt;您的账户余额是 &lt;span id=&quot;amount&quot;&gt;&amp;&amp;&amp;amount&amp;&amp;&amp;&lt;/span&gt;&lt;/h5&gt;</span><br><span class="line">&lt;button id=&quot;btn&quot;&gt;打钱&lt;/button&gt;</span><br><span class="line">&lt;script src=&quot;//code.jquery.com/jquery-1.9.1.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    btn.addEventListener(&apos;click&apos;,function()&#123;</span><br><span class="line">        $.ajax(&#123;</span><br><span class="line">            url:&quot;http://localhost:9999/pay&quot;,</span><br><span class="line">            dataType:&quot;jsonp&quot;,</span><br><span class="line">            success:function(res)&#123;</span><br><span class="line">                console.log(res);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)            </span><br><span class="line">    &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h4 id="注意：-ajax-只是把jsonp归纳到-jq里-而它不是ajax"><a href="#注意：-ajax-只是把jsonp归纳到-jq里-而它不是ajax" class="headerlink" title="注意： $.ajax()只是把jsonp归纳到 jq里  而它不是ajax"></a>注意： $.ajax()只是把jsonp归纳到 jq里  而它不是ajax</h4><h3 id="考点1-：请问JSONP为什么不支持POST请求"><a href="#考点1-：请问JSONP为什么不支持POST请求" class="headerlink" title="考点1 ：请问JSONP为什么不支持POST请求"></a>考点1 ：请问JSONP为什么不支持POST请求</h3><ul>
<li>因为JSONP是通过动态创建script实现的</li>
<li>我们动态创建script的时候只能用get 没有办法用post</li>
</ul>
<h3 id="考点2-：-什么是-JSONP？"><a href="#考点2-：-什么是-JSONP？" class="headerlink" title="考点2 ： 什么是 JSONP？"></a>考点2 ： 什么是 JSONP？</h3><ul>
<li>1请求方创建一个script标签src指向响应方，并传递callback =回调函数名</li>
<li>2响应方根据callback查询参数构造一个 xxx.call(undefined,传递的内容)</li>
<li>3浏览器接到响应，就会执行 xxx.call(undefined,传递的内容)</li>
<li>4请求方得到他想要的数据</li>
</ul>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/前端知识点/">前端知识点</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/12/01/N032_DOM事件/" title="DOM事件" itemprop="url">DOM事件</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Stevin" target="_blank" itemprop="author">Stevin</a>
		
  <p class="article-time">
    <time datetime="2017-12-01T07:39:47.000Z" itemprop="datePublished"> Published 2017-12-01</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="事件模型应用-点击显示浮层-点击其它地方关闭浮层"><a href="#事件模型应用-点击显示浮层-点击其它地方关闭浮层" class="headerlink" title="事件模型应用 点击显示浮层 点击其它地方关闭浮层"></a>事件模型应用 点击显示浮层 点击其它地方关闭浮层</h3><blockquote>
<p>问题1 点击按钮浮层不出现<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;wrapper&quot; class=&quot;wrapper&quot;&gt;</span><br><span class="line">    &lt;button id=&quot;clickMe&quot;&gt;点我&lt;/button&gt;</span><br><span class="line">    &lt;div id=&quot;popover&quot; class=&quot;popover&quot;&gt;</span><br><span class="line">      浮层</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    //点击显示浮层 </span><br><span class="line">    clickMe.addEventListener(&apos;click&apos;, function()&#123;</span><br><span class="line">        popover.style.display = &apos;block&apos;;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    document.addEventListener(&apos;click&apos;, function()&#123;</span><br><span class="line">        popover.style.display = &apos;none&apos;</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>点击按钮的时候浮层确实出现了 </p>
</blockquote>
<blockquote>
<p>但是addEventListener(‘事件’,fn,布尔值) 第三个参数不传代表false 代表冒泡</p>
</blockquote>
<blockquote>
<p>冒泡到document  </p>
</blockquote>
<blockquote>
<p>document 发现事件队列里有 fn于是执行   popover.style.display = ‘none’</p>
</blockquote>
<h3 id="如何解决-gt-event-stopPropagation"><a href="#如何解决-gt-event-stopPropagation" class="headerlink" title="如何解决 ==&gt; event.stopPropagation();"></a>如何解决 ==&gt; event.stopPropagation();</h3><blockquote>
<p>Prevents further propagation of the current event in the capturing and bubbling phases.</p>
</blockquote>
<blockquote>
<p>防止当前事件在捕获和冒泡阶段的进一步传播。</p>
</blockquote>
<blockquote>
<h5 id="早一点的前端肯定会认为还有一个方法阻止冒泡-event-cancelBubble-true-不好意思-该属性已废弃"><a href="#早一点的前端肯定会认为还有一个方法阻止冒泡-event-cancelBubble-true-不好意思-该属性已废弃" class="headerlink" title="早一点的前端肯定会认为还有一个方法阻止冒泡 event.cancelBubble = true ;不好意思 该属性已废弃"></a>早一点的前端肯定会认为还有一个方法阻止冒泡 event.cancelBubble = true ;不好意思 该属性已废弃</h5></blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//点击显示浮层 </span><br><span class="line">clickMe.addEventListener(&apos;click&apos;, function(event)&#123;</span><br><span class="line">    popover.style.display = &apos;block&apos;;</span><br><span class="line">    event.stopPropagation(); //这样冒泡阶段就被禁止了 </span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">document.addEventListener(&apos;click&apos;, function()&#123;</span><br><span class="line">    popover.style.display = &apos;none&apos;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="问题2-虽然解决了阻止冒泡-但是当你点击浮层时-浮层也会消失"><a href="#问题2-虽然解决了阻止冒泡-但是当你点击浮层时-浮层也会消失" class="headerlink" title="问题2 虽然解决了阻止冒泡 但是当你点击浮层时  浮层也会消失"></a>问题2 虽然解决了阻止冒泡 但是当你点击浮层时  浮层也会消失</h3><blockquote>
<p>这样就不能在按钮上阻止冒泡 因为点击浮层也会冒泡到wrapper</p>
<ul>
<li>因为btn会冒泡到 wrapper </li>
<li>popover会冒泡到 wrapper</li>
<li>所以在它们的父节点做阻止冒泡</li>
</ul>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;wrapper&quot; class=&quot;wrapper&quot;&gt;</span><br><span class="line">    &lt;button id=&quot;clickMe&quot;&gt;点我&lt;/button&gt;</span><br><span class="line">    &lt;div id=&quot;popover&quot; class=&quot;popover&quot;&gt;</span><br><span class="line">        浮层</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">clickMe.addEventListener(&apos;click&apos;, function(e)&#123;</span><br><span class="line">    popover.style.display = &apos;block&apos;;</span><br><span class="line">&#125;)</span><br><span class="line">wrapper.addEventListener(&apos;click&apos;,function(e)&#123;</span><br><span class="line">    //解决点击浮层触发的冒泡</span><br><span class="line">    e.stopPropagation()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">document.addEventListener(&apos;click&apos;, function()&#123;</span><br><span class="line">    popover.style.display = &apos;none&apos;</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h3 id="问题3-现在点击按钮浮层出现-点击浮层浮层浮层不消失-但是有性能问题"><a href="#问题3-现在点击按钮浮层出现-点击浮层浮层浮层不消失-但是有性能问题" class="headerlink" title="问题3 现在点击按钮浮层出现  点击浮层浮层浮层不消失 但是有性能问题"></a>问题3 现在点击按钮浮层出现  点击浮层浮层浮层不消失 但是有性能问题</h3><ul>
<li>100个浮层就是100个事件队列  10000个呢？</li>
</ul>
<blockquote>
<p>现在我们先换jq来实现刚刚的效果</p>
</blockquote>
<blockquote>
<h3 id="jq提供了一个非常方便的方法-node-on-‘click’-false-第二个参数代表-阻止默认事件-和阻止传播"><a href="#jq提供了一个非常方便的方法-node-on-‘click’-false-第二个参数代表-阻止默认事件-和阻止传播" class="headerlink" title="jq提供了一个非常方便的方法  $(node).on(‘click’,false) 第二个参数代表 阻止默认事件 和阻止传播"></a>jq提供了一个非常方便的方法  $(node).on(‘click’,false) 第二个参数代表 阻止默认事件 和阻止传播</h3></blockquote>
<h3 id="又偶生出一个bug-就是-on-‘事件’-false-你在checkbox外的任何一层-阻止默认事件-这个checkbox就无法选中"><a href="#又偶生出一个bug-就是-on-‘事件’-false-你在checkbox外的任何一层-阻止默认事件-这个checkbox就无法选中" class="headerlink" title="又偶生出一个bug 就是.on(‘事件’,false) 你在checkbox外的任何一层 阻止默认事件 这个checkbox就无法选中"></a>又偶生出一个bug 就是.on(‘事件’,false) 你在checkbox外的任何一层 阻止默认事件 这个checkbox就无法选中</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;wrapper&quot; class=&quot;wrapper&quot;&gt;</span><br><span class="line">    &lt;button id=&quot;clickMe&quot;&gt;点我&lt;/button&gt;</span><br><span class="line">    &lt;div id=&quot;popover&quot; class=&quot;popover&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;checkbox&quot;&gt;浮层</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$(clickMe).on(&apos;click&apos;,function()&#123;</span><br><span class="line">    $(popover).show();</span><br><span class="line">&#125;);</span><br><span class="line">// 这样会再次出bug就是  如果浮层里有checkbox就无法选中 因为阻止了默认事件 </span><br><span class="line">$(wrapper).on(&apos;click&apos;,false)  </span><br><span class="line"></span><br><span class="line">$(document).on(&apos;click&apos;,function()&#123;</span><br><span class="line">    $(popover).hide();</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>所以我们还是单独阻止传播 </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$(clickMe).on(&apos;click&apos;,function()&#123;</span><br><span class="line">    $(popover).show();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">$(wrapper).on(&apos;click&apos;,function(e)&#123;</span><br><span class="line">    e.stopPropagation(); //阻止冒泡</span><br><span class="line">&#125;);  </span><br><span class="line"></span><br><span class="line">$(document).on(&apos;click&apos;,function()&#123;</span><br><span class="line">    $(popover).hide();</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="解决问题3-性能问题"><a href="#解决问题3-性能问题" class="headerlink" title="解决问题3 性能问题"></a>解决问题3 性能问题</h3><ul>
<li>点击按钮的时候显示浮层 同时添加一个document监听</li>
<li>为什么监听不会触发 因为 wrapper哪里阻止了 冒泡<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$(clickMe).on(&apos;click&apos;,function()&#123;</span><br><span class="line">    $(popover).show();</span><br><span class="line">    //只有显示的时候监听一次 但是不会触发  因为 wrapper上阻止了冒泡</span><br><span class="line">    //这样我只监听一次 click 同时马上干掉这个监听事件   </span><br><span class="line">    $(document).one(&apos;click&apos;,function()&#123;</span><br><span class="line">      console.log(&apos;doc&apos;)</span><br><span class="line">      $(popover).hide();</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">//所以只能这样写  单独阻止它的冒泡 不阻止默认事件</span><br><span class="line">$(wrapper).on(&apos;click&apos;,function(e)&#123;</span><br><span class="line">    e.stopPropagation(); //阻止冒泡</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="问题4-如果不在wrapper上不阻止冒泡-点击btn为什么浮层不显示"><a href="#问题4-如果不在wrapper上不阻止冒泡-点击btn为什么浮层不显示" class="headerlink" title="问题4 如果不在wrapper上不阻止冒泡 点击btn为什么浮层不显示"></a>问题4 如果不在wrapper上不阻止冒泡 点击btn为什么浮层不显示</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$(clickMe).on(&apos;click&apos;,function()&#123;</span><br><span class="line">    $(popover).show();</span><br><span class="line">    //只有显示的时候监听一次 但是不会触发  因为 wrapper上阻止了冒泡</span><br><span class="line">    //这样我只监听一次 click 同时马上干掉这个监听事件   </span><br><span class="line">    $(document).one(&apos;click&apos;,function()&#123;</span><br><span class="line">      console.log(&apos;doc&apos;)</span><br><span class="line">      $(popover).hide();</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li>在你点击btn的时候它会做两件事</li>
<li>1 浮层显示出来</li>
<li>2 document的事件队列里 添加一个函数</li>
<li>3 事件开始冒泡</li>
<li>4 开始发现 document的事件队列里有一个函数</li>
<li>5 执行 document事件队列里的函数</li>
<li>6 浮层隐藏了</li>
</ul>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/前端知识点/">前端知识点</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/12/01/N030_DOM事件初识/" title="DOM事件初识" itemprop="url">DOM事件初识</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Stevin" target="_blank" itemprop="author">Stevin</a>
		
  <p class="article-time">
    <time datetime="2017-12-01T01:00:47.000Z" itemprop="datePublished"> Published 2017-12-01</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="DOM事件"><a href="#DOM事件" class="headerlink" title="DOM事件"></a>DOM事件</h3><p>如果你想深挖请google搜索「dom spec」 <a href="https://www.w3.org/DOM/DOMTR" target="_blank" rel="noopener">dom spec</a></p>
<ul>
<li>Document Object Model (DOM) Level 1 只对基本的事件进行了汇总</li>
<li>Document Object Model (DOM) Level 2 增加了 Events 对事件的详细说明</li>
<li>Document Object Model (DOM) Level 3 并没有增加 Events 的相关修订</li>
<li>Document Object Model (DOM) Level 4 还在草案阶段</li>
</ul>
<blockquote>
<p>结论目前我们使用事件最新最广泛的标准是  dom level 2 (2000年11月3号)</p>
</blockquote>
<h4 id="dom-1-的一个经典问题"><a href="#dom-1-的一个经典问题" class="headerlink" title="dom 1 的一个经典问题"></a>dom 1 的一个经典问题</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    function print()&#123;console.log(&apos;Hi&apos;)&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;button id=&quot;x&quot; onclick=&quot;print&quot;&gt;A&lt;/button&gt;</span><br><span class="line">&lt;button id=&quot;y&quot; onclick=&quot;print()&quot;&gt;B&lt;/button&gt;</span><br><span class="line">&lt;button id=&quot;z&quot; onclick=&quot;print.call()&quot;&gt;C&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    x.onclick = print;</span><br><span class="line">    y.onclick = print();</span><br><span class="line">    z.onclick = print.call();</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>当把事件写在标签上的时候那个是正确调用 「B C」</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">写在标签上的事件</span><br><span class="line">onclick=&quot;要执行的代码&quot;</span><br><span class="line">一旦用户点击，浏览器就eval(&quot;要执行的代码&quot;)</span><br></pre></td></tr></table></figure>
<p>当把事件写在JS上的时候那个是正确调用 「x」</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">写在JS里的事件</span><br><span class="line">onclick=&quot;函数&quot;</span><br><span class="line">一旦用户点击，浏览器就 x.onclick.call(x,函数)</span><br></pre></td></tr></table></figure>
<h4 id="dom2-事件队列"><a href="#dom2-事件队列" class="headerlink" title="dom2 事件队列"></a>dom2 事件队列</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xxx.addEventListener(&apos;click&apos;,function()&#123;</span><br><span class="line">    console.log(2)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>你肯定问怎么比 onclick更麻烦了</p>
</blockquote>
<ul>
<li>onclick是唯一的</li>
<li>出现两次onclick就会发生覆盖</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">xxx.onclick = function()&#123;</span><br><span class="line">    console.log(1)</span><br><span class="line">&#125;</span><br><span class="line">// 第一个onclick被覆盖了  只会打印2</span><br><span class="line">xxx.onclick = function()&#123;</span><br><span class="line">    console.log(2)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<h4 id="事件队列的好处-eventListeners"><a href="#事件队列的好处-eventListeners" class="headerlink" title="事件队列的好处 eventListeners"></a>事件队列的好处 eventListeners</h4></blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">xxx.addEventListener(&apos;click&apos;,function()&#123;</span><br><span class="line">    console.log(1)</span><br><span class="line">&#125;) </span><br><span class="line">xxx.addEventListener(&apos;click&apos;,function()&#123;</span><br><span class="line">    console.log(2)</span><br><span class="line">&#125;) </span><br><span class="line"></span><br><span class="line">当xxx被点击 打印 1 和 2</span><br></pre></td></tr></table></figure>
<h4 id="事件的移除"><a href="#事件的移除" class="headerlink" title="事件的移除"></a>事件的移除</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">function f1()&#123;</span><br><span class="line">    console.log(1)</span><br><span class="line">&#125;</span><br><span class="line">function f2()&#123;</span><br><span class="line">    console.log(2)</span><br><span class="line">&#125;</span><br><span class="line">xxx.addEventListener(&apos;click&apos;,f1)</span><br><span class="line">xxx.addEventListener(&apos;click&apos;,f2)</span><br><span class="line">//移除事件队列里的 f1</span><br><span class="line">xxx.removeEventListener(&apos;click&apos;,f1)</span><br><span class="line"></span><br><span class="line">点击xxx后 打印 2</span><br></pre></td></tr></table></figure>
<blockquote>
<p>如何实现只监听one一次的效果</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function f1()&#123;</span><br><span class="line">    console.log(1)</span><br><span class="line">    //移除事件队列里的 f1</span><br><span class="line">    xxx.removeEventListener(&apos;click&apos;,f1)</span><br><span class="line">&#125;</span><br><span class="line">xxx.addEventListener(&apos;click&apos;,f1)</span><br></pre></td></tr></table></figure>
<h4 id="问题1-当我点击儿子的时候，我是否点击了-爸爸和爷爷-》yes"><a href="#问题1-当我点击儿子的时候，我是否点击了-爸爸和爷爷-》yes" class="headerlink" title="问题1  当我点击儿子的时候，我是否点击了 爸爸和爷爷 ==》yes"></a>问题1  当我点击儿子的时候，我是否点击了 爸爸和爷爷 ==》yes</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;grand1&quot;&gt;</span><br><span class="line">    爷爷</span><br><span class="line">    &lt;div id=&quot;parent1&quot;&gt;</span><br><span class="line">        爸爸</span><br><span class="line">        &lt;div id=&quot;child1&quot;&gt;</span><br><span class="line">            儿子</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<h4 id="问题2-当我点击儿子的时候，三个函数是否调用-gt-yes"><a href="#问题2-当我点击儿子的时候，三个函数是否调用-gt-yes" class="headerlink" title="问题2 当我点击儿子的时候，三个函数是否调用 ==&gt; yes"></a>问题2 当我点击儿子的时候，三个函数是否调用 ==&gt; yes</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">grand1.addEventListener(&apos;click&apos;,function()&#123;</span><br><span class="line">  console.log(&apos;爷爷&apos;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">parent1.addEventListener(&apos;click&apos;,function()&#123;</span><br><span class="line">  console.log(&apos;爸爸&apos;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">child1.addEventListener(&apos;click&apos;,function()&#123;</span><br><span class="line">  console.log(&apos;儿子&apos;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="问题3-三个函数的执行顺序-gt-1-2-3-or-3-2-1-答案是都可以"><a href="#问题3-三个函数的执行顺序-gt-1-2-3-or-3-2-1-答案是都可以" class="headerlink" title="问题3 三个函数的执行顺序 ==&gt; 1 2 3 or 3 2 1 答案是都可以"></a>问题3 三个函数的执行顺序 ==&gt; 1 2 3 or 3 2 1 答案是都可以</h4><blockquote>
<p>addEventListener(‘事件’,函数,可选参数) </p>
</blockquote>
<blockquote>
<p>第三个参数是 boolean值  不传代表false : 0 NaN undefined null false ‘’</p>
</blockquote>
<blockquote>
<p>false的话 顺序从内到外 儿子  爸爸  爷爷</p>
</blockquote>
<blockquote>
<p>true 的话 顺序从外到内 爷爷  爸爸  儿子</p>
</blockquote>
<blockquote>
<p><img src="https://raw.githubusercontent.com/slTrust/note/master/img/note032_0.png" alt="推荐"></p>
</blockquote>
<blockquote>
<p>爷爷设置true 其他设置false </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">grand1.addEventListener(&apos;click&apos;,function()&#123;</span><br><span class="line">  console.log(&apos;爷爷&apos;)</span><br><span class="line">&#125;,true)</span><br><span class="line"></span><br><span class="line">parent1.addEventListener(&apos;click&apos;,function()&#123;</span><br><span class="line">  console.log(&apos;爸爸&apos;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">child1.addEventListener(&apos;click&apos;,function()&#123;</span><br><span class="line">  console.log(&apos;儿子&apos;)</span><br><span class="line">&#125;)</span><br><span class="line">// 爷爷  儿子  爸爸</span><br></pre></td></tr></table></figure>
<h4 id="考点-如果-儿子节点既有捕获又有冒泡执行顺序是什么"><a href="#考点-如果-儿子节点既有捕获又有冒泡执行顺序是什么" class="headerlink" title="考点 如果  儿子节点既有捕获又有冒泡执行顺序是什么"></a>考点 如果  儿子节点既有捕获又有冒泡执行顺序是什么</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">child1.addEventListener(&apos;click&apos;,function()&#123;</span><br><span class="line">  console.log(&apos;儿子捕获&apos;)</span><br><span class="line">&#125;,true)</span><br><span class="line"></span><br><span class="line">child1.addEventListener(&apos;click&apos;,function()&#123;</span><br><span class="line">  console.log(&apos;儿子冒泡&apos;)</span><br><span class="line">&#125;,false)</span><br><span class="line"></span><br><span class="line">// 儿子捕获</span><br><span class="line">// 儿子冒泡</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">child1.addEventListener(&apos;click&apos;,function()&#123;</span><br><span class="line">  console.log(&apos;儿子冒泡&apos;)</span><br><span class="line">&#125;,false)</span><br><span class="line"></span><br><span class="line">child1.addEventListener(&apos;click&apos;,function()&#123;</span><br><span class="line">  console.log(&apos;儿子捕获&apos;)</span><br><span class="line">&#125;,true)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// 儿子冒泡</span><br><span class="line">// 儿子捕获</span><br></pre></td></tr></table></figure>
<blockquote>
<p>答案是 谁写在前面谁先触发</p>
</blockquote>
<p>如果触发在元素本身上是不区分捕获和冒泡的</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/前端知识点/">前端知识点</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/11/30/N029_02前端该遵守的原则/" title="前端的自我修养" itemprop="url">前端的自我修养</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Stevin" target="_blank" itemprop="author">Stevin</a>
		
  <p class="article-time">
    <time datetime="2017-11-30T02:27:42.000Z" itemprop="datePublished"> Published 2017-11-30</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="HTML-CSS-JS-内容、样式和行为分离原则"><a href="#HTML-CSS-JS-内容、样式和行为分离原则" class="headerlink" title="HTML/CSS/JS 内容、样式和行为分离原则"></a>HTML/CSS/JS 内容、样式和行为分离原则</h3><p>如果你去面试可能会被问道如下问题</p>
<blockquote>
<h4 id="请你说一下你对前端内容样式行为分离的原则"><a href="#请你说一下你对前端内容样式行为分离的原则" class="headerlink" title="请你说一下你对前端内容样式行为分离的原则?"></a>请你说一下你对前端内容样式行为分离的原则?</h4></blockquote>
<blockquote>
<p>如果你初出茅庐可能会这样回答 html负责内容css负责样式js负责行为</p>
</blockquote>
<p>但是这是大家都认可的真理，我为什么要解释原因呢！</p>
<blockquote>
<h4 id="正确做法！！！-你该这样用初中几何常用套路「反证法」"><a href="#正确做法！！！-你该这样用初中几何常用套路「反证法」" class="headerlink" title="正确做法！！！ 你该这样用初中几何常用套路「反证法」"></a>正确做法！！！ 你该这样用初中几何常用套路「反证法」</h4></blockquote>
<p>请看解题思路(如果你是程序员这就是「伪代码」)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">问：人类为什么吃饭</span><br><span class="line">答: 如果不吃饭人类就会死，所以人类需要吃饭</span><br></pre></td></tr></table></figure>
<p>你该这样回答</p>
<ol>
<li>如果html负责样式</li>
</ol>
<ul>
<li>会让html变得很复杂</li>
<li>很难区分这些标签的逻辑结构</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;body bgcolor=red&gt;</span><br><span class="line">    &lt;center&gt;</span><br><span class="line">        &lt;font color=red&gt;你好&lt;/font&gt;</span><br><span class="line">    &lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>用css表示内容</li>
</ol>
<ul>
<li>人类选不中</li>
<li>JS取不到  </li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line">    div::after&#123;content:&apos;你好你好你好&apos;&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;xxx&quot;&gt;&lt;/div&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        console.log(xxx.innerText) // 啥都没</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>用JS控制样式</li>
</ol>
<blockquote>
<p>你该避免使用jQuery的 show/hide方法</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;xxx&quot;&gt;&lt;/div&gt;</span><br><span class="line">     &lt;script src=&quot;jquery.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">       </span><br><span class="line">       $(&quot;#xxx&quot;).hide() // display:none; 隐藏没有任何问题</span><br><span class="line"></span><br><span class="line">       $(&quot;#xxx&quot;).show() // 但是 show就有问题了</span><br><span class="line">       /*</span><br><span class="line">       display:inline-block;</span><br><span class="line">       display:flex;</span><br><span class="line">       display:inline;</span><br><span class="line">       */</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>show()之后你很难定位 div隐藏之前是什么 可能是flex也可能是 block</p>
</blockquote>
<p>因为jQuery为了让你使用它的库，就特殊处理了</p>
<ul>
<li>在你hide的时候把display这个值存起来</li>
<li>当你show的时候把display这个值赋回去</li>
</ul>
<blockquote>
<h4 id="问题来了，如果div一开始display-none"><a href="#问题来了，如果div一开始display-none" class="headerlink" title="问题来了，如果div一开始display:none"></a>问题来了，如果div一开始display:none</h4></blockquote>
<p>show() 之后会是什么呢？ 经过测试竟然是block<br>凭啥?凭啥?凭啥?</p>
<h4 id="JS该这样使用"><a href="#JS该这样使用" class="headerlink" title="JS该这样使用"></a>JS该这样使用</h4><blockquote>
<p>通过class样式 来表示不同的状态去切换</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;xxx&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">$(&quot;#xxx&quot;).addClass(&apos;active&apos;)</span><br><span class="line">$(&quot;#xxx&quot;).removeClass(&apos;active&apos;)</span><br></pre></td></tr></table></figure>
<h4 id="人在江湖"><a href="#人在江湖" class="headerlink" title="人在江湖"></a>人在江湖</h4><p>有的时候需要你迫不得已的用JS去操作样式，那就只能违反原则，但是你不该总是违反原则</p>
<blockquote>
<p>追溯到故事情节：天龙八部有一集阿紫被打伤乔峰各种救，去寻医，但是药店伙计告诉他没救了，此时突然一个地主家伙计来了说他家老爷不行了有没有办法，老掌柜的说快去拿“人参”，而此时纵是大侠气概的乔峰也「迫不得已」抢走了人参</p>
</blockquote>
<h3 id="基本的职业素养"><a href="#基本的职业素养" class="headerlink" title="基本的职业素养"></a>基本的职业素养</h3><h4 id="不要让「img」变形"><a href="#不要让「img」变形" class="headerlink" title="不要让「img」变形"></a>不要让「img」变形</h4><ul>
<li>你可以指定宽高,或者强行要求UI给你指定尺寸的图</li>
</ul>
<h4 id="关于「img」的坑"><a href="#关于「img」的坑" class="headerlink" title="关于「img」的坑"></a>关于「img」的坑</h4><p>因为「img」是一个可替换元素,所以当图片下载失败的时候就会显示alt里的内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;xxx.jpg&quot;  alt=&quot;图片1&quot;&gt;</span><br></pre></td></tr></table></figure>
<p>由于你没有指定宽高，假如是三个并排的img(不出意外是float或者flex-start)</p>
<p>由于第一张图加载速度慢，后面的img就不得不挤过来，直到图1 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">正常加载</span><br><span class="line">|--------| |--------||--------|</span><br><span class="line">|--------| |--------||--------|</span><br><span class="line">|   图1  | |   图2  ||   图3   |</span><br><span class="line">|--------| |--------||--------|</span><br><span class="line"></span><br><span class="line">图1还没加载过来 没指定宽高导致后面的img补位</span><br><span class="line">|图1||--------||--------|</span><br><span class="line">     |--------||--------|</span><br><span class="line">     |   图2  ||   图3   |</span><br><span class="line">     |--------||--------|</span><br><span class="line">图1回来了</span><br><span class="line">|--------| |--------||--------|</span><br><span class="line">|--------| |--------||--------|</span><br><span class="line">|   图1  | |   图2  ||   图3   |</span><br><span class="line">|--------| |--------||--------|</span><br></pre></td></tr></table></figure>
<p>就是因为你没有指定宽高所以在图片没回来的时候占据很小的空间，而当图1正常加载后 图2图3就必须给图1退出位置</p>
<blockquote>
<p>这样的结果就会导致「重排」</p>
</blockquote>
<blockquote>
<h4 id="重排是很耗性能的，页面性能优化的注意点就是"><a href="#重排是很耗性能的，页面性能优化的注意点就是" class="headerlink" title="重排是很耗性能的，页面性能优化的注意点就是"></a>重排是很耗性能的，页面性能优化的注意点就是</h4></blockquote>
<p>如果你已知图片的宽高你最好写在上面避免图片未加载的「让位」(腾地)</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/前端知识点/">前端知识点</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/11/30/N029_01_JS避免相互影响之作用域/" title="JS之使用局部变量" itemprop="url">JS之使用局部变量</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Stevin" target="_blank" itemprop="author">Stevin</a>
		
  <p class="article-time">
    <time datetime="2017-11-30T01:27:42.000Z" itemprop="datePublished"> Published 2017-11-30</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="全局变量的危害"><a href="#全局变量的危害" class="headerlink" title="全局变量的危害"></a>全局变量的危害</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">html里有一个id=&quot;parent&quot;的div</span><br><span class="line">&lt;div id=&quot;xxx&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    var parent = document.getElementById(&apos;xxx&apos;);</span><br><span class="line">    //这句已经有问题了  你无意之间把window.parent覆盖了</span><br><span class="line">    console.log(parent)  //现在parent已经是那个id=&quot;xxx&quot;的div了</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>所以你应该避免使用全局变量，使用局部变量</p>
<h4 id="局部变量"><a href="#局部变量" class="headerlink" title="局部变量"></a>局部变量</h4><blockquote>
<p>JS里的var声明只有在函数内才有块级作用域</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function x()&#123;</span><br><span class="line">    var parent = document.getElementById(&apos;xxx&apos;);</span><br><span class="line">    console.log(parent) //这里的是 id=&quot;xxx&quot;的div</span><br><span class="line">&#125;</span><br><span class="line">x.call();</span><br><span class="line">console.log(parent) //这里的parent是window的属性</span><br></pre></td></tr></table></figure>
<h4 id="立即调用函数"><a href="#立即调用函数" class="headerlink" title="立即调用函数"></a>立即调用函数</h4><blockquote>
<p>如上节代码所示，立即调用函数就是声明一个函数然后立刻调用</p>
</blockquote>
<p>因为避免使用全局变量所以你不该声明这个「x」的函数，因为这样已经产生了一个全局变量「x」</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function()&#123;</span><br><span class="line">    var parent = document.getElementById(&apos;xxx&apos;);</span><br><span class="line">    console.log(parent) //这里的是 id=&quot;xxx&quot;的div</span><br><span class="line">&#125;()</span><br></pre></td></tr></table></figure>
<blockquote>
<p>但是这样会报错，原因是如果你直接声明一个「匿名函数 」并调用，浏览器里会直接报错说语法错误</p>
</blockquote>
<p>我们可以使用如下小技巧</p>
<ol>
<li><p>直接把匿名函数加调用的整体用 「括号」括起来</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(</span><br><span class="line">    function()&#123;</span><br><span class="line">        //相关处理</span><br><span class="line">    &#125;()</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
</li>
<li><p>直接把匿名函数用「括号」括起来，然后再调用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(function()&#123;</span><br><span class="line">        //相关处理    </span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure>
</li>
<li><p>加减号或者取反(「+」「-」「!」「~」)</p>
</li>
</ol>
<p>这些运算符是告诉浏览器我不是再声明一个函数而是在求值，但是这个值我不关心(爱是多少是多少)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+function()&#123;&#125;()</span><br><span class="line"></span><br><span class="line">-function()&#123;&#125;()</span><br><span class="line"></span><br><span class="line">!function()&#123;&#125;()</span><br><span class="line"></span><br><span class="line">~function()&#123;&#125;()</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>因为这个局部变量问题的使用太过麻烦,ES6终于狠心给JS升级了</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    let parent = document.getElementById(&apos;xxx&apos;);</span><br><span class="line">    let a = 1;</span><br><span class="line">&#125;</span><br><span class="line">console.log(parent) // 全局变量的window的parent属性</span><br><span class="line">console.log(a) //报错  因为 a是局部变量</span><br></pre></td></tr></table></figure>
<blockquote>
<p>{ } 左大括号右大括号之内的内容代表块级作用域，但是你不能用var</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    var parent = 1;</span><br><span class="line">&#125;</span><br><span class="line">console.log(parent)  // 1 又把window.parent给覆盖了</span><br></pre></td></tr></table></figure>
<blockquote>
<p>因为var会变量提升，所以实际的代码是这个效果</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var parent; //变量提升</span><br><span class="line">&#123;</span><br><span class="line">    parent = 1;</span><br><span class="line">&#125;</span><br><span class="line">console.log(parent)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>所以在ES6出来之前也就是2015年以前如果你想用局部变量就要这样</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~function()&#123;&#125;()</span><br></pre></td></tr></table></figure>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/前端知识点/">前端知识点</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/11/29/N028_自己实现一个jQuery/" title="自己实现一个jQuery" itemprop="url">自己实现一个jQuery</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Stevin" target="_blank" itemprop="author">Stevin</a>
		
  <p class="article-time">
    <time datetime="2017-11-29T07:27:42.000Z" itemprop="datePublished"> Published 2017-11-29</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h1 id="What-is-jQuery"><a href="#What-is-jQuery" class="headerlink" title="What is jQuery?"></a>What is jQuery?</h1><blockquote>
<p>核心就是一句话 The Write Less,Do More（写更少，做更多）  ， ok ， let’s go！</p>
</blockquote>
<ul>
<li>addClass( )功能  （最渣版）</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul&gt;</span><br><span class="line">    &lt;li id=&quot;item1&quot;&gt;选项1&lt;/li&gt;</span><br><span class="line">    &lt;li id=&quot;item2&quot;&gt;选项2&lt;/li&gt;</span><br><span class="line">    &lt;li id=&quot;item3&quot;&gt;选项3&lt;/li&gt;</span><br><span class="line">    &lt;li id=&quot;item4&quot;&gt;选项4&lt;/li&gt;</span><br><span class="line">    &lt;li id=&quot;item5&quot;&gt;选项5&lt;/li&gt;</span><br><span class="line">&lt;/ul&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>如何给id=”item3” 添加样式</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">function addClass(node,classArr)&#123;</span><br><span class="line">    var len = classArr.length;</span><br><span class="line">    for(let i = 0 ;i &lt; len ; i++)&#123;</span><br><span class="line">        node.classList.add(classArr[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">// item3 通过id名可以直接获取元素</span><br><span class="line">addClass(item3,[&apos;red&apos;]); </span><br><span class="line">// 你也可以这样</span><br><span class="line">addClass(document.getElementById(&apos;item4&apos;),[&apos;red&apos;])</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意：通过id获取元素不是100%没问题的，你要是非 id=”parent”  这样就不好使,你可以打印看看parent是啥</p>
</blockquote>
<hr>
<blockquote>
<p>这样只是初步封装了方法,但是方法是还在全局作用域,你叫addClass 到时候别人也叫addClass 你可能就被覆盖了  我们是有版权的   来来来 来个帅气签名！</p>
</blockquote>
<h3 id="addClass-签名版"><a href="#addClass-签名版" class="headerlink" title="addClass( ) (签名版)"></a>addClass( ) (签名版)</h3><blockquote>
<p>命名空间：给全局对象挂载一个对象 window.myDom = { }<br>然后在你挂载的myDom 对象上挂载你的属性 、方法</p>
</blockquote>
<blockquote>
<p>这比之前好在哪里？</p>
</blockquote>
<blockquote>
<p>好在有“从属”关系而不是“零散“的变量<br>（至少在阿里没落前）我是阿里的前端  相比 我是一个前端 那个更有份量呢？ </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">window.myDom = &#123;&#125;;</span><br><span class="line">myDom.addClass = function (node,classArr)&#123;</span><br><span class="line">    var len = classArr.length;</span><br><span class="line">    for(let i = 0 ;i &lt; len ; i++)&#123;</span><br><span class="line">        node.classList.add(classArr[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">myDom.addClass(item3,[&apos;red&apos;]);</span><br></pre></td></tr></table></figure>
<ul>
<li>你肯定会不爽因为还不如之前用着爽了  每次还得加命名前缀<br>  myDom.fn(param)<br>  myDom.fn2(param)<br>  直接 item3.addClass([‘red’]) 才爽 有需求就会有改进</li>
</ul>
<h3 id="反正都是Node的api-我直接改原型不就好了-于是乎！你又挖了个坑"><a href="#反正都是Node的api-我直接改原型不就好了-于是乎！你又挖了个坑" class="headerlink" title="反正都是Node的api 我直接改原型不就好了 于是乎！你又挖了个坑"></a>反正都是Node的api 我直接改原型不就好了 于是乎！你又挖了个坑</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Node.prototype.addClass =  function (node,classArr)&#123;</span><br><span class="line">    var len = classArr.length;</span><br><span class="line">    for(let i = 0 ;i &lt; len ; i++)&#123;</span><br><span class="line">        this.classList.add(classArr[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> item3.addClass([&apos;red&apos;]);  //你遂了心意了</span><br></pre></td></tr></table></figure>
<ul>
<li>这样的后果是别人也这样改原型，而且也添加个addClass<br>是不是心好累！  为啥？此乃优良传统<br>山寨一下 改改加点“我想出”的功能 我就敢说我的比你好！ （王者荣耀 与 dota ）<br>why?你用上了爱迪生的电灯泡 我就问你，你是自己发明一个还是在借鉴他？<br>看得远是因为我站在巨人的肩膀上！</li>
</ul>
<h3 id="我们是讲版权的我的就是我的"><a href="#我们是讲版权的我的就是我的" class="headerlink" title="我们是讲版权的我的就是我的"></a>我们是讲版权的我的就是我的</h3><h4 id="我自创一个Node2行不行-以后可能还有Node3"><a href="#我自创一个Node2行不行-以后可能还有Node3" class="headerlink" title="我自创一个Node2行不行 以后可能还有Node3"></a>我自创一个Node2行不行 以后可能还有Node3</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">window.Node2 = function(node)&#123;</span><br><span class="line">            return &#123;</span><br><span class="line">                addClass:function(classArr)&#123;</span><br><span class="line">                    var len = classArr.length;</span><br><span class="line">                    for(let i = 0 ;i &lt; len ; i++)&#123;</span><br><span class="line">                        node.classList.add(classArr[i]);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">var node2 = Node2(item4);</span><br><span class="line">node2.addClass([&apos;red&apos;]);  //完美</span><br><span class="line">// Node2(item5).addClass([&apos;red&apos;])   是不是有种似曾相识的感觉</span><br></pre></td></tr></table></figure>
<h3 id="说好的jQuery呢？-你把Node2替换成jQuery-在试试"><a href="#说好的jQuery呢？-你把Node2替换成jQuery-在试试" class="headerlink" title="说好的jQuery呢？ 你把Node2替换成jQuery  在试试"></a>说好的jQuery呢？ 你把Node2替换成jQuery  在试试</h3><blockquote>
<p>是不是有点感觉了   这是最简单版  以后会慢慢高大上的</p>
</blockquote>
<h3 id="jQuery最强大的莫过于选择器-Selector"><a href="#jQuery最强大的莫过于选择器-Selector" class="headerlink" title="jQuery最强大的莫过于选择器 Selector"></a>jQuery最强大的莫过于选择器 Selector</h3><blockquote>
<p>你肯定听说过一句话  “选择大于能力” (啊！没听过？  现在听过了！)</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">window.jQyery = function(nodeOrSelector)&#123;</span><br><span class="line">            let node ; </span><br><span class="line">            if(typeof nodeOrSelector ===&apos;string&apos;)&#123;</span><br><span class="line">                node = document.querySelector(nodeOrSelector);</span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                node = nodeOrSelector;</span><br><span class="line">            &#125;</span><br><span class="line">            return &#123;</span><br><span class="line">                addClass:function(classArr)&#123;</span><br><span class="line">                    var len = classArr.length;</span><br><span class="line">                    for(let i = 0 ;i &lt; len ; i++)&#123;</span><br><span class="line">                        node.classList.add(classArr[i]);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">var jqyery = jQyery(item4);</span><br><span class="line">jqyery.addClass([&apos;red&apos;]);</span><br></pre></td></tr></table></figure>
<h3 id="如果用过的人肯定知道jQuery选择器返回的是个伪数组才对"><a href="#如果用过的人肯定知道jQuery选择器返回的是个伪数组才对" class="headerlink" title="如果用过的人肯定知道jQuery选择器返回的是个伪数组才对"></a>如果用过的人肯定知道jQuery选择器返回的是个伪数组才对</h3><blockquote>
<p>我们使用querySelectorAll()它返回的是一个节点数组（伪数组）</p>
</blockquote>
<blockquote>
<p>然后给我们内部声明的 nodes 复制获取的每个节点</p>
</blockquote>
<blockquote>
<p>如果是节点数组就挨个拷贝  如果是一个 我也把你搞成伪数组哪怕就一个甚至没有<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">window.jQyery = function(nodeOrSelector)&#123;</span><br><span class="line">            let nodes = &#123;&#125;; </span><br><span class="line">            if(typeof nodeOrSelector ===&apos;string&apos;)&#123;</span><br><span class="line">                let temp = document.querySelectorAll(nodeOrSelector);</span><br><span class="line">                for(let i=0;i&lt;temp.length;i++)&#123;</span><br><span class="line">                    nodes[i] = temp[i];</span><br><span class="line">                &#125;   </span><br><span class="line">                nodes.length = temp.length;</span><br><span class="line">            &#125;else if(nodeOrSelector instanceof Node)&#123;</span><br><span class="line">                nodes = &#123;</span><br><span class="line">                    0:nodeOrSelector,</span><br><span class="line">                    length:1</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            nodes.addClass = function(classes)&#123;</span><br><span class="line">                for(let i=0;i&lt;classes.length;i++)&#123;</span><br><span class="line">                    for(let j=0;j&lt;nodes.length;j++)&#123;</span><br><span class="line">                        nodes[j].classList.add(classes[i]);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                return nodes;</span><br><span class="line">            &#125; </span><br><span class="line">            return nodes;</span><br><span class="line">        &#125;</span><br><span class="line">//这样我们就可以用$(选择器)调用了</span><br><span class="line">window.$ = jQyery;</span><br><span class="line">//$(item3).addClass([&apos;red&apos;]);</span><br><span class="line">$(&apos;ul li&apos;).addClass([&apos;red&apos;])</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="你肯定会疑惑-为啥每次都-return-nodes-gt-答案就是链式操作"><a href="#你肯定会疑惑-为啥每次都-return-nodes-gt-答案就是链式操作" class="headerlink" title="你肯定会疑惑 为啥每次都 return nodes ==&gt; 答案就是链式操作"></a>你肯定会疑惑 为啥每次都 return nodes ==&gt; 答案就是链式操作</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(&apos;ul li&apos;).addClass([&apos;red&apos;]).Text(&apos;hi&apos;); //Text 我们还没有实现  ok 马上开始</span><br></pre></td></tr></table></figure>
<blockquote>
<p>在内部继续挂载方法   Text( ) 你传递参数就代表设置text你不传递就代表get</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">nodes.Text = function (text)&#123;</span><br><span class="line">    if(text === undefined)&#123;</span><br><span class="line">        var texts = [];</span><br><span class="line">        for(let i=0;i&lt;nodes.length;i++)&#123;</span><br><span class="line">            texts.push(nodes[i].textContent);</span><br><span class="line">        &#125;</span><br><span class="line">        return texts;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        for(let i=0;i&lt;nodes.length;i++)&#123;</span><br><span class="line">            nodes[i].textContent = text;</span><br><span class="line">        &#125;</span><br><span class="line">        return nodes;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>欢迎批评指正！ </p>
</blockquote>
<h3 id="END"><a href="#END" class="headerlink" title="END"></a>END</h3>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/前端知识点/">前端知识点</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/11/27/N027_DOM_API/" title="DOM_API" itemprop="url">DOM_API</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Stevin" target="_blank" itemprop="author">Stevin</a>
		
  <p class="article-time">
    <time datetime="2017-11-27T09:58:43.000Z" itemprop="datePublished"> Published 2017-11-27</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="DOM-API"><a href="#DOM-API" class="headerlink" title="DOM_API"></a>DOM_API</h3><blockquote>
<p>我们写HTML时会先写一个文档头&lt;!Doctype html&gt; 然后html head body</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!Doctype html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;head&gt;&lt;/head&gt;</span><br><span class="line">    &lt;body&gt;&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>head/body是可以省略的，这其实就是一棵树 </p>
</blockquote>
<p><img src="https://sltrust.github.io/note/img/note027_0.png" alt="1"></p>
<p>这是我们大脑中对html的理解，而不是内存中的理解 </p>
<p><img src="https://sltrust.github.io/note/img/note027_1.png" alt="2"></p>
<p>内存里是DOM（Document Object Model）文档对象模型</p>
<p><img src="https://sltrust.github.io/note/img/note027_2.png" alt="3"><br><img src="https://sltrust.github.io/note/img/note027_3.png" alt="4"></p>
<ul>
<li>页面上所有标签都有跟它对应的构造函数</li>
<li>浏览器只要看到一个标签就会给给它构造出来一个对应的内存中的对象</li>
<li>页面中的节点通过（构造函数）==&gt; 对象</li>
</ul>
<blockquote>
<p>这就是DOM api 如果你想操作一个节点就可以操作这个对象对应的api</p>
</blockquote>
<p>Node接口</p>
<p>1.属性</p>
<blockquote>
<p>childNodes,firstChild,innerText,lastChild,nextSibling,nodeName,nodeType,nodeValue,outerText,ownerDocument,parentElement,parentNode,previousSibling,textContent</p>
</blockquote>
<ul>
<li>document //  document</li>
<li>document.documentElement //html</li>
<li>document.body  // 代表body</li>
</ul>
<h4 id="childNodes-amp-amp-children"><a href="#childNodes-amp-amp-children" class="headerlink" title="childNodes &amp;&amp; children"></a>childNodes &amp;&amp; children</h4><blockquote>
<p>如果是节点是包含回车的</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">document.body.childNodes //获取body下所有子节点 (注意子节点不是子元素,回车也是文本节点)</span><br><span class="line">document.body.children //获取body下所有子元素</span><br></pre></td></tr></table></figure>
<h4 id="firstChild-lastChild-amp-amp-firstElementChild-lastElementChild"><a href="#firstChild-lastChild-amp-amp-firstElementChild-lastElementChild" class="headerlink" title="firstChild/lastChild &amp;&amp; firstElementChild lastElementChild"></a>firstChild/lastChild &amp;&amp; firstElementChild lastElementChild</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">document.body.firstChild  //body的第一个子节点  注意是子节点  回车也是文本节点</span><br><span class="line">document.body.lastChild   //body的最后一个子节点  注意是子节点  回车也是文本节点</span><br><span class="line"></span><br><span class="line">document.body.firstElementChild  //body的第一个子节点  注意是子节点  回车也是文本节点</span><br><span class="line">document.body.lastElementChild   //body的最后一个子节点  注意是子节点  回车也是文本节点</span><br></pre></td></tr></table></figure>
<h4 id="previousSibling-nextSibling-amp-amp-previousElementSibling-nextElementSibling"><a href="#previousSibling-nextSibling-amp-amp-previousElementSibling-nextElementSibling" class="headerlink" title="previousSibling nextSibling &amp;&amp; previousElementSibling nextElementSibling"></a>previousSibling nextSibling &amp;&amp; previousElementSibling nextElementSibling</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//兄弟节点 与 兄弟元素</span><br><span class="line">document.head.previousSibling  //head前一个节点</span><br><span class="line">document.head.nextSibling      //head后一个节点</span><br><span class="line"></span><br><span class="line">document.head.previousElementSibling  //head前一个元素</span><br><span class="line">document.head.nextElementSibling      //head后一个元素</span><br></pre></td></tr></table></figure>
<h4 id="nodeName"><a href="#nodeName" class="headerlink" title="nodeName"></a>nodeName</h4><blockquote>
<p>只有svg元素 返回的是小写”svg” 其他标签返回的都是大写</p>
</blockquote>
<h4 id="nodeType"><a href="#nodeType" class="headerlink" title="nodeType"></a>nodeType</h4><ul>
<li>返回节点的节点类型 是数值（为啥是数值，因为以前的内存紧张 节省内存 8M是豪华配置 ）</li>
<li>1代表元素节点</li>
<li>3代表文本节点 </li>
<li>除了这个 1、3它还存了一个常量 用来表示节点类型 Node.ELEMENT_NODE &gt;</li>
</ul>
<blockquote>
<p>自行MDN</p>
</blockquote>
<ul>
<li>1 元素节点</li>
<li>3 文本节点</li>
<li>7</li>
<li>8 注释节点</li>
<li>9 Document节点</li>
<li>11 DocumentFragment 节点</li>
</ul>
<h4 id="innerText-amp-amp-textContent"><a href="#innerText-amp-amp-textContent" class="headerlink" title="innerText &amp;&amp; textContent"></a>innerText &amp;&amp; textContent</h4><blockquote>
<p>在IE发明innerText之前 前端想要获取htmk代码的文本需要这样写</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">    1&lt;span&gt;2&lt;/span&gt;3&lt;span&gt;&lt;/span&gt;4</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">var text =&apos;&apos;;</span><br><span class="line">for(var i=0;i&lt;div.childNodes.length;i++)&#123;</span><br><span class="line">    if(div.childNodes[i].nodeType === 3)&#123;</span><br><span class="line">        text += div.childNodes[i].nodeValue;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>于是IE发明了 innerText 你爱用不用我自己觉得很爽</p>
</blockquote>
<blockquote>
<p>FF说了 你IE又搞特殊 于是FF出了个 textContent</p>
</blockquote>
<p>innerText &amp;&amp; textContent区别</p>
<ul>
<li>textContent 会获取所有元素的内容，包括 script 和 style 元素，然而 innerText 不会。</li>
<li>innerText意识到样式，并且不会返回隐藏元素的文本，而textContent会。</li>
<li>由于 innerText 受 CSS 样式的影响，它会触发重排（reflow），但textContent 不会。</li>
<li>与 textContent 不同的是, 在 Internet Explorer (对于小于等于 IE11 的版本) 中对 innerText 进行修改， 不仅会移除当前元素的子节点，而且还会永久性地破坏所有后代文本节点（所以不可能再次将节点再次插入到任何其他元素或同一元素中）。</li>
</ul>
<h4 id="到底用谁"><a href="#到底用谁" class="headerlink" title="到底用谁"></a>到底用谁</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&apos;textContent&apos; in document.body ? document.body.textContent : document.body.innerText</span><br></pre></td></tr></table></figure>
<p>2.方法（如果一个属性是函数，那么这个属性就也叫做方法；换言之，方法是函数属性）</p>
<ul>
<li>createElement()  //创建节点</li>
<li>appendChild()  </li>
<li>cloneNode()   //复制一个节点   有一个参数[param] true/false 默认false true代表深拷贝</li>
<li>contains()    //Node.contains()返回的是一个布尔值，来表示传入的节点是否为该节点的后代节点。</li>
<li>hasChildNodes() //判断一个节点是否有后代节点</li>
<li>insertBefore() </li>
<li>isEqualNode()  //节点是否相等 div2 = div1.cloneNode(true);   div2.isEqualNode(div1) 返回true</li>
<li>isSameNode()   //判断是否相同(就是是不是同一个)  你与你自己肯定是同一个人  1===1</li>
<li>removeChild()  //移除一个节点，但是这个节点不是真的没了，还在内存里 只是从页面移除了</li>
<li>replaceChild() //替换一个节点，但是这个节点不是真的没了，还在内存里 只是从页面移除了</li>
<li>normalize() // 常规化 </li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">var wrapper = document.createElement(&quot;div&quot;);</span><br><span class="line"></span><br><span class="line">wrapper.appendChild(document.createTextNode(&quot;Part 1 &quot;));</span><br><span class="line">wrapper.appendChild(document.createTextNode(&quot;Part 2 &quot;));</span><br><span class="line"></span><br><span class="line">// 这时(规范化之前),wrapper.childNodes.length === 2</span><br><span class="line">// wrapper.childNodes[0].textContent === &quot;Part 1 &quot;</span><br><span class="line">// wrapper.childNodes[1].textContent === &quot;Part 2 &quot;</span><br><span class="line"></span><br><span class="line">wrapper.normalize();</span><br><span class="line">// 现在(规范化之后), wrapper.childNodes.length === 1</span><br><span class="line">// wrapper.childNodes[0].textContent === &quot;Part 1 Part 2&quot;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>搞清楚英文单词的意思就知道用法</p>
</blockquote>
<p>如果发现知道英文后依然不明白用法，看 MDN 的例子即可，如 normalize</p>
<blockquote>
<p>DOM APi 无外乎「增删改查」</p>
</blockquote>
<h3 id="Document-接口"><a href="#Document-接口" class="headerlink" title="Document 接口"></a>Document 接口</h3><h4 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h4><ul>
<li>anchors  //废弃 详情mdn 返回a标签 集合</li>
<li>body </li>
<li>characterSet  //返回字符集</li>
<li>childElementCount  //返回元素个数</li>
<li>children //返回子元素 伪数组</li>
<li>doctype //返回文档头</li>
<li>documentElement //返回页面根元素 html</li>
<li>domain  //返回域名</li>
<li>fullscreen</li>
<li>head</li>
<li>hidden</li>
<li>images </li>
<li>links</li>
<li>location</li>
<li>onxxxxxxxxx  //监听事件</li>
<li>origin   </li>
<li>plugins //安装的插件 静态集合</li>
<li>readyState </li>
<li>referrer  //你访问一个网址  浏览器会问你的引荐者是谁  不然就会被拒之门外</li>
<li>scripts </li>
<li>scrollingElement</li>
<li>styleSheets</li>
<li>title</li>
<li>visibilityState</li>
</ul>
<h4 id="方法："><a href="#方法：" class="headerlink" title="方法："></a>方法：</h4><ul>
<li>close()</li>
<li>createDocumentFragment()</li>
<li>createElement()</li>
<li>createTextNode()</li>
<li>execCommand()</li>
<li>exitFullscreen()</li>
<li>getElementById()</li>
<li>getElementsByClassName()</li>
<li>getElementsByName()</li>
<li>getElementsByTagName()</li>
<li>getSelection()</li>
<li>hasFocus()</li>
<li>open()</li>
<li>querySelector()</li>
<li>querySelectorAll()</li>
<li>registerElement()</li>
<li>write()</li>
<li>writeln()</li>
</ul>
<h2 id="考点"><a href="#考点" class="headerlink" title="考点"></a>考点</h2><ol>
<li>previousSibling nextSibling </li>
<li>innerText 和 textContent 的区别</li>
<li>nodeType  1代表元素节点  3代表文本节点</li>
<li>cloneNode() 设置参数可以深拷贝</li>
<li>isEqualNode isSameNode 的区别  isEqualNode是两个节点是否一个样 isSameNode 是 是否是同一个  </li>
<li>normalize() 主要体现mdn的作用</li>
</ol>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/前端知识点/">前端知识点</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/11/25/N026_JS里的Function/" title="JS里的Function" itemprop="url">JS里的Function</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Stevin" target="_blank" itemprop="author">Stevin</a>
		
  <p class="article-time">
    <time datetime="2017-11-25T09:44:34.000Z" itemprop="datePublished"> Published 2017-11-25</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h4 id="函数的基本结构"><a href="#函数的基本结构" class="headerlink" title="函数的基本结构"></a>函数的基本结构</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function fn(参数1，参数2)&#123;</span><br><span class="line">  //不写return  它会自动返回 undefined  </span><br><span class="line">  return undefined</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="函数的五种声明方式"><a href="#函数的五种声明方式" class="headerlink" title="函数的五种声明方式"></a>函数的五种声明方式</h4><p>1.第一种  具名函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function x(a,b)&#123;</span><br><span class="line">  return a+b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>2.第二种 声明一个匿名函数 但是不能单独使用，会报错<br>需要赋值给一个变量<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// function (a,b)&#123;return a+b&#125; 报错</span><br><span class="line">var fn = function(a,b)&#123;return a+b&#125;</span><br></pre></td></tr></table></figure></p>
<p>3.第三种 具名的函数赋值给一个变量<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var x = function y(a,b)&#123;return a+b;&#125;</span><br><span class="line">//console.log(y) 报错 y没有定义</span><br><span class="line">//但是单独定义一个函数  function x()&#123;&#125;  </span><br><span class="line">//然后console.log(x) 不会报错</span><br><span class="line">//js又一垃圾之处  不一致性  语法没有错误   原因在于作用域 </span><br><span class="line">// function x()&#123;&#125; 全局作用域</span><br><span class="line">// var x = function y()&#123; //作用域在函数里面&#125;</span><br></pre></td></tr></table></figure></p>
<p>4.第四种 window.Function 全局对象<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var f = new Function(&apos;a&apos;,&apos;b&apos;,&apos;return a+b&apos;);</span><br><span class="line"></span><br><span class="line">//面试题  假定n=1</span><br><span class="line">var f = new Function(&apos;a&apos;,&apos;b&apos;,&apos;return a+&apos;+n+&apos;b&apos;)</span><br><span class="line">f(1,2)  //4</span><br></pre></td></tr></table></figure></p>
<p>5.第五种 箭头函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var f = (x,y)=&gt;&#123;return x+y&#125;</span><br><span class="line">var f2 = (x,y) =&gt;x+y;</span><br><span class="line">var f3 = x=&gt;x*2;</span><br><span class="line">var f4 = (x,y)=&gt;&#123;var a = 1; var b =2; return a+b+x+y;&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="函数的name属性"><a href="#函数的name属性" class="headerlink" title="函数的name属性"></a>函数的name属性</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">function f()&#123;&#125;</span><br><span class="line">f.name // &quot;f&quot;</span><br><span class="line">var f2 = function()&#123;&#125;</span><br><span class="line">f2.name // &quot;f2&quot;</span><br><span class="line">var f3 =function f4()&#123;&#125;</span><br><span class="line">f3.name // &quot;f4&quot;</span><br><span class="line">f5 = new Function(&apos;x&apos;,&apos;y&apos;,&apos;return x+y&apos;);</span><br><span class="line">f5.name //&quot;anonymous&quot;</span><br></pre></td></tr></table></figure>
<h4 id="函数的本质"><a href="#函数的本质" class="headerlink" title="函数的本质"></a>函数的本质</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function sum(x,y)&#123;</span><br><span class="line">    return x+y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p> sum(1,2)      &lt;==&gt;     sum.call(undefined,1,2)</p>
</blockquote>
<blockquote>
<p> 小白都这样用 sum(1,2)   sum(2,5)  这个是语法糖 但是对你深入没有任何帮助<br> 硬核玩家这样用  sum.call(undefined,1,2)  </p>
</blockquote>
<blockquote>
<h4 id="只有sum-call-调用的方式-你才能真正理解-this"><a href="#只有sum-call-调用的方式-你才能真正理解-this" class="headerlink" title="只有sum.call()调用的方式  你才能真正理解  this"></a>只有sum.call()调用的方式  你才能真正理解  this</h4></blockquote>
<h3 id="this-amp-amp-arguments"><a href="#this-amp-amp-arguments" class="headerlink" title="this &amp;&amp; arguments"></a>this &amp;&amp; arguments</h3><ul>
<li>f.call(undefined,1,2) 的第一个参数是 this</li>
<li>f.call(undefined,1,2) 第一个后面的参数是 arguments<blockquote>
<p><img src="https://sltrust.github.io/note/img/note026_1.png" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">var f = function()&#123;</span><br><span class="line">    console.log(this)</span><br><span class="line">&#125;</span><br><span class="line">f.call(1)    //1</span><br><span class="line">f.call(&apos;sss&apos;) //&apos;sss&apos;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// 潜规则   普通模式下 如果this是undefined 浏览器会自动把this变成window</span><br><span class="line">f.call(undefined)   // window</span><br><span class="line"></span><br><span class="line">//如果是严格模式  this就是原本的值</span><br><span class="line">var f2 = function()&#123;</span><br><span class="line">    &apos;use strict&apos;</span><br><span class="line">    console.log(this)</span><br><span class="line">&#125;</span><br><span class="line">f2.call(undefined);  // undefined</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
</ul>
<h6 id="arguments"><a href="#arguments" class="headerlink" title="arguments"></a>arguments</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">var f = function()&#123;</span><br><span class="line">    console.log(arguments);</span><br><span class="line">&#125;</span><br><span class="line">f.call(undefined,1,2,3)    </span><br><span class="line">/*</span><br><span class="line">&#123;</span><br><span class="line">0:1,</span><br><span class="line">1:2,</span><br><span class="line">2:3,</span><br><span class="line">length:3</span><br><span class="line">callee:f()&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line">*/</span><br></pre></td></tr></table></figure>
<blockquote>
<p>arguments 不是数组 它的原型链中没有Array.prototype</p>
</blockquote>
<h4 id="call-stack-调用栈"><a href="#call-stack-调用栈" class="headerlink" title="call stack 调用栈"></a>call stack 调用栈</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="作用域面试题"><a href="#作用域面试题" class="headerlink" title="作用域面试题"></a>作用域面试题</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">var a = 1;</span><br><span class="line">function f1()&#123;</span><br><span class="line">    var a  = 2;</span><br><span class="line">    f2.call();</span><br><span class="line">    console.log(a);</span><br><span class="line">    </span><br><span class="line">    function f2()&#123;</span><br><span class="line">        var a =3;</span><br><span class="line">        console.log(a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">f1.call();</span><br><span class="line">console.log(a);</span><br><span class="line">// 3</span><br><span class="line">// 2</span><br><span class="line">// 1</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">var a = 1;</span><br><span class="line">function f1()&#123;</span><br><span class="line">    f2.call();</span><br><span class="line">    console.log(a);</span><br><span class="line">    var a= 2 ; //变量提升</span><br><span class="line">    </span><br><span class="line">    function f2()&#123;</span><br><span class="line">        var a =3;</span><br><span class="line">        console.log(a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">f1.call();</span><br><span class="line">console.log(a);</span><br><span class="line">// 3</span><br><span class="line">// undefined</span><br><span class="line">// 1</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意分析时要把所有变量提升</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">var a = 1;</span><br><span class="line">function f1()&#123;</span><br><span class="line">    console.log(a);</span><br><span class="line">    var a= 2 ; //变量提升</span><br><span class="line">    f4.call();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function f4()&#123;</span><br><span class="line">    console.log(a);</span><br><span class="line">&#125;</span><br><span class="line">f1.call();</span><br><span class="line">console.log(a);</span><br><span class="line">//   undefined</span><br><span class="line">//   1</span><br><span class="line">//   1</span><br></pre></td></tr></table></figure>
<h4 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var a  = 1;</span><br><span class="line">function f4()&#123;</span><br><span class="line">  console.log(a);</span><br><span class="line">&#125;</span><br><span class="line">//如果一个函数，使用了它范围外的变量，那么这个就叫闭包</span><br></pre></td></tr></table></figure>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/前端知识点/">前端知识点</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/11/23/N025_JS里的Array/" title="JS里的Array" itemprop="url">JS里的Array</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Stevin" target="_blank" itemprop="author">Stevin</a>
		
  <p class="article-time">
    <time datetime="2017-11-23T09:15:16.000Z" itemprop="datePublished"> Published 2017-11-23</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="基本类型-amp-amp-复杂类型"><a href="#基本类型-amp-amp-复杂类型" class="headerlink" title="基本类型 &amp;&amp; 复杂类型"></a>基本类型 &amp;&amp; 复杂类型</h3><blockquote>
<p>复杂类型的对象使用不使用new都会返回对象<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Objcet(1)  // 返回一个Number对象</span><br><span class="line">Object(&apos;sss&apos;) //返回一个String对象</span><br><span class="line">Object(true)  //返回一个 Boolean对象</span><br><span class="line">Object() // 返回一个对象 &#123;&#125;</span><br><span class="line">new Object() //返回一个对象&#123;&#125;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">String(1) //  &apos;1&apos;</span><br><span class="line">String(true)  // &apos;true&apos;</span><br><span class="line">String(null)  //  &apos;null&apos;</span><br><span class="line"></span><br><span class="line">new String(1)  // String对象</span><br><span class="line">new String(&apos;sss&apos;)  //String对象</span><br><span class="line"></span><br><span class="line">Number(1)  //  数值类型  1</span><br><span class="line">Number(&apos;sss&apos;)  // 数值类型  NaN</span><br><span class="line"></span><br><span class="line">new Number(1)  // Number对象</span><br><span class="line"></span><br><span class="line">Boolean(1)  // true</span><br><span class="line">new Boolean(1)  //Boolean对象</span><br><span class="line">new Boolean(&apos;   &apos;) //Boolean对象</span><br></pre></td></tr></table></figure>
<blockquote>
<p><img src="https://sltrust.github.io/note/img/note025_2.png" alt></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//不一致性的一个恶心的问题</span><br><span class="line">var arr = new Array(3); //这个数组的length为3</span><br><span class="line">//arr[0]未指定 arr[1]未指定 arr[2] 未指定</span><br><span class="line">console.log(0 in arr) //false</span><br><span class="line">console.log(1 in arr) //false</span><br><span class="line">console.log(2 in arr) //false</span><br></pre></td></tr></table></figure>
<blockquote>
</blockquote>
<h4 id="JS七种数据类型"><a href="#JS七种数据类型" class="headerlink" title="JS七种数据类型"></a>JS七种数据类型</h4><blockquote>
<p>number   string   boolean   symbol   null   undefined   object</p>
</blockquote>
<h4 id="五个falsy值"><a href="#五个falsy值" class="headerlink" title="五个falsy值"></a>五个falsy值</h4><blockquote>
<p>0 NaN 空字符 null undefined</p>
</blockquote>
<h4 id="Array"><a href="#Array" class="headerlink" title="Array"></a>Array</h4><blockquote>
<p>用法</p>
</blockquote>
<h5 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var a1 = [&apos;a&apos;,&apos;b&apos;];   //推荐使用</span><br><span class="line">var a2 = new Array(&apos;a&apos;,&apos;b&apos;)</span><br><span class="line">// 两种方式没区别</span><br></pre></td></tr></table></figure>
<h4 id="不一致性-Array-3-和-Array-3-3-坑爹之处"><a href="#不一致性-Array-3-和-Array-3-3-坑爹之处" class="headerlink" title="不一致性 Array(3) 和 Array(3,3) (坑爹之处)"></a>不一致性 Array(3) 和 Array(3,3) (坑爹之处)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var a1 = Array(3) //单个参数  声明了length = 3 的数组 每个值是undefined</span><br><span class="line">var a2 = Array(2,3) // 声明了 length = 2 的数组  [2,3]</span><br></pre></td></tr></table></figure>
<blockquote>
<p><img src="https://sltrust.github.io/note/img/note025_01.png" alt></p>
</blockquote>
<h4 id="function-amp-amp-Function"><a href="#function-amp-amp-Function" class="headerlink" title="function &amp;&amp; Function"></a>function &amp;&amp; Function</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">//function 是关键字  </span><br><span class="line">//Function是全局对象</span><br><span class="line"></span><br><span class="line">//声明方式  </span><br><span class="line">//具名函数</span><br><span class="line">function fn ()&#123; &#125;</span><br><span class="line"></span><br><span class="line">// 匿名函数</span><br><span class="line">function()&#123; &#125;   </span><br><span class="line"></span><br><span class="line">var f2 = new Function(&apos;a&apos;,&apos;b&apos;,&apos;return a+b&apos;);   //闲的蛋疼才用   很极限的情况下才会应用</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var f = function ()&#123;return &apos;a&apos;;&#125;</span><br><span class="line">// var a = 1的变体  只不过  function存在堆里 f 存的是引用</span><br></pre></td></tr></table></figure>
<h4 id="继续研究数组"><a href="#继续研究数组" class="headerlink" title="继续研究数组"></a>继续研究数组</h4><blockquote>
<p><img src="https://sltrust.github.io/note/img/note025_03.png" alt></p>
</blockquote>
<h4 id="Array-amp-amp-伪数组"><a href="#Array-amp-amp-伪数组" class="headerlink" title="Array &amp;&amp; 伪数组"></a>Array &amp;&amp; 伪数组</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">var arr = [1,2,3];</span><br><span class="line">for(var i=0;i&lt;arr.length;i++)&#123;</span><br><span class="line">  console.log(arr[i])</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//伪数组</span><br><span class="line">var obj = &#123;0:1,1:2,2:3,length:3&#125;</span><br><span class="line">for(var i=0;i&lt;obj.length;i++)&#123;</span><br><span class="line">  console.log(obj[i])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>数组与伪数组的区别就是  伪数组的原型链里没有Array.prototype这一层<br><img src="https://sltrust.github.io/note/img/note025_04.png" alt></p>
</blockquote>
<h4 id="forEach"><a href="#forEach" class="headerlink" title="forEach"></a>forEach</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var a =[1,2,3]</span><br><span class="line">a.forEach(function(val,idx,arr)&#123; </span><br><span class="line">  //遍历方法要接受一个函数</span><br><span class="line">  //函数有三个参数  val是值 idx是索引  arr就是这个数组对象</span><br><span class="line">  console.log(val,idx,arr)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//接受一个函数并执行</span><br><span class="line">function myExe( fn)&#123;</span><br><span class="line">  fn(666);</span><br><span class="line">&#125;</span><br><span class="line">myExe(function(xxx)&#123;</span><br><span class="line">                console.log(xxx)</span><br><span class="line">            &#125;)</span><br><span class="line">// 666</span><br></pre></td></tr></table></figure>
<blockquote>
<p>简化版forEach<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">function forEach(arr,fn)&#123;</span><br><span class="line">    for(var i=0;i&lt;arr.length;i++)&#123;</span><br><span class="line">        fn(arr[i],i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var arr = [&apos;a&apos;,&apos;b&apos;,&apos;c&apos;]</span><br><span class="line">forEach(arr,function(v,i)&#123;console.log(v,i)&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//数组的forEach</span><br><span class="line">arr.forEach(function(v,i)&#123;</span><br><span class="line">                     console.log(v,i)</span><br><span class="line">            &#125;)</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>疑惑 为什么a.forEach() 没有像我们的forEach一样传递 arr呢？<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">arr.forEach(function()&#123;&#125;) </span><br><span class="line">//等价于下面的形式</span><br><span class="line">arr.forEach.call(arr,function()&#123;&#125;)</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>再看<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var obj = &#123;0:&apos;a&apos;,1:&apos;b&apos;,2:&apos;c&apos;,length:2&#125;;</span><br><span class="line">obj.forEach = function(fn)&#123;</span><br><span class="line">    for(var i=0;i&lt;this.length;i++)&#123;</span><br><span class="line">        fn(this[i],i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">//forEach实际上接收了 obj 就是用this来接收</span><br><span class="line">// js蛋疼之处</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h5 id="sort"><a href="#sort" class="headerlink" title="sort()"></a>sort()</h5><p>它内置的排序一般是快排<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var a = [5,3,2,1,4];</span><br><span class="line">a.sort(); // 1,2,3,4,5 默认升序</span><br><span class="line">//你也可以传递一个函数 函数的返回值为正数、0或负数</span><br><span class="line">a.sort(function(x,y)&#123;return x-y;&#125;)  //1,2,3,4,5</span><br><span class="line">a.sort(function(x,y)&#123;function y-x&#125;;) //5,4,3,2,1</span><br></pre></td></tr></table></figure></p>
<h3 id="复杂的排序"><a href="#复杂的排序" class="headerlink" title="复杂的排序"></a>复杂的排序</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">hash = &#123;</span><br><span class="line">    &apos;马云&apos;:167.22,</span><br><span class="line">    &apos;马化腾&apos;:379,</span><br><span class="line">    &apos;李彦宏&apos;:229.11</span><br><span class="line">&#125;;</span><br><span class="line">//按资产排序 倒序</span><br><span class="line">var a = [&apos;马云&apos;,&apos;马化腾&apos;,&apos;李彦宏&apos;]</span><br><span class="line">a.sort(function(x,y)&#123;</span><br><span class="line">    return hash[y] - hash[x]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h5 id="join"><a href="#join" class="headerlink" title="join"></a>join</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var a = [1,2,3];</span><br><span class="line">a.join() ; //1,2,3</span><br><span class="line">a.join(&apos;--&apos;) //1--2--3</span><br></pre></td></tr></table></figure>
<h5 id="concat"><a href="#concat" class="headerlink" title="concat()"></a>concat()</h5><blockquote>
<p>concat会返回一个新的数组<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var a = [1,2,3]</span><br><span class="line">var b = [4,5,6]</span><br><span class="line">var c = a.concat(b);</span><br><span class="line">// 返回一个新的数组  [1,2,3,4,5,6]  </span><br><span class="line"></span><br><span class="line">// 非常厉害的用法快速复制一个数组</span><br><span class="line">var d =a.concat([]) // 新数组 [1,2,3]</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h5 id="map"><a href="#map" class="headerlink" title="map()"></a>map()</h5><blockquote>
<p>跟forEach的区别</p>
<ul>
<li>forEach没有返回值</li>
<li>map有返回值<br>map的含义 是映射<br><img src="https://sltrust.github.io/note/img/note025_5.png" alt><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var a = [1,2,3]</span><br><span class="line">a.map(function()&#123;return value*2&#125;) // [2,3,6]</span><br><span class="line">//箭头函数的写法</span><br><span class="line">a.map(value=&gt;value*2)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</blockquote>
<h5 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h5><blockquote>
<p>过滤<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var a = [1,2,3,4,5,6,7,8,9,10]</span><br><span class="line">a.filter(function(value)&#123;</span><br><span class="line">    return value%2===0;</span><br><span class="line">&#125;)</span><br><span class="line">// [2,4,6,8,10]</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h5 id="reduce"><a href="#reduce" class="headerlink" title="reduce"></a>reduce</h5><blockquote>
<p>减少 降<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">var a = [1,2,3,4,5,6,7,8,9,10]</span><br><span class="line">//第一个参数是一个函数 函数有两个参数 第一个参数 之前的结果 当前的值</span><br><span class="line">//第二个参数代表初始值</span><br><span class="line">a.reduce(function(sum,n)&#123;</span><br><span class="line">  return sum+n</span><br><span class="line">&#125;,0) </span><br><span class="line">// 55</span><br><span class="line"></span><br><span class="line">//箭头函数</span><br><span class="line">a.reduce((sum,n)=&gt;sum+n,0);</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h5 id="map用reduce代替"><a href="#map用reduce代替" class="headerlink" title="map用reduce代替"></a>map用reduce代替</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var a  = [1,2,3];</span><br><span class="line">a.reduce(function(arr,n)&#123;</span><br><span class="line">  arr.push(n*2);</span><br><span class="line">  return arr</span><br><span class="line">&#125;,[])  //[2,4,6]</span><br></pre></td></tr></table></figure>
<h5 id="filter用reduce代替"><a href="#filter用reduce代替" class="headerlink" title="filter用reduce代替"></a>filter用reduce代替</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var a  = [1,2,3,4,5,6,7,8,9,10];</span><br><span class="line">a.reduce(function(arr,n)&#123;</span><br><span class="line">  if(n%2===0)&#123;</span><br><span class="line">    arr.push(n)</span><br><span class="line">  &#125;</span><br><span class="line">  return arr</span><br><span class="line">&#125;,[])  //[2,4,6,8,10]</span><br></pre></td></tr></table></figure>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/前端知识点/">前端知识点</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>







  <nav id="page-nav" class="clearfix">
    <a class="extend prev" rel="prev" href="/page/45/"><span></span>Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/44/">44</a><a class="page-number" href="/page/45/">45</a><span class="page-number current">46</span><a class="page-number" href="/page/47/">47</a><a class="page-number" href="/page/48/">48</a><a class="page-number" href="/page/49/">49</a><a class="extend next" rel="next" href="/page/47/">Next<span></span></a>
  </nav>

</div>
      <div class="openaside"><a class="navbutton" href="#" title="Show Sidebar"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div>
<aside class="clearfix">

  


  

  
<div class="tagslist">
	<p class="asidetitle">Tags</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/oak/" title="oak">oak<sup>71</sup></a></li>
			
		
			
				<li><a href="/tags/前端知识点/" title="前端知识点">前端知识点<sup>43</sup></a></li>
			
		
			
				<li><a href="/tags/java/" title="java">java<sup>37</sup></a></li>
			
		
			
				<li><a href="/tags/Node后端/" title="Node后端">Node后端<sup>34</sup></a></li>
			
		
			
				<li><a href="/tags/M06/" title="M06">M06<sup>29</sup></a></li>
			
		
			
				<li><a href="/tags/fullstack/" title="fullstack">fullstack<sup>27</sup></a></li>
			
		
			
				<li><a href="/tags/M07/" title="M07">M07<sup>27</sup></a></li>
			
		
			
				<li><a href="/tags/python/" title="python">python<sup>26</sup></a></li>
			
		
			
				<li><a href="/tags/M08/" title="M08">M08<sup>25</sup></a></li>
			
		
			
				<li><a href="/tags/M04/" title="M04">M04<sup>22</sup></a></li>
			
		
			
				<li><a href="/tags/M03/" title="M03">M03<sup>20</sup></a></li>
			
		
			
				<li><a href="/tags/M02/" title="M02">M02<sup>17</sup></a></li>
			
		
			
				<li><a href="/tags/React入门/" title="React入门">React入门<sup>17</sup></a></li>
			
		
			
				<li><a href="/tags/ReactWheels/" title="ReactWheels">ReactWheels<sup>16</sup></a></li>
			
		
			
				<li><a href="/tags/TS入门/" title="TS入门">TS入门<sup>16</sup></a></li>
			
		
			
				<li><a href="/tags/M01/" title="M01">M01<sup>9</sup></a></li>
			
		
			
				<li><a href="/tags/vue/" title="vue">vue<sup>8</sup></a></li>
			
		
			
				<li><a href="/tags/ES6速学/" title="ES6速学">ES6速学<sup>7</sup></a></li>
			
		
			
				<li><a href="/tags/mongodb/" title="mongodb">mongodb<sup>7</sup></a></li>
			
		
			
				<li><a href="/tags/mysql/" title="mysql">mysql<sup>7</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">Links</p>
    <ul>
        
          <li>
            
            	<a href="https://coderq.com" target="_blank" title="一个面向程序员交流分享的新一代社区">码农圈</a>
            
          </li>
        
          <li>
            
            	<a href="http://wuchong.me" target="_blank" title="Jark&#39;s Blog">Jark&#39;s Blog</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS</a>
</div>

  <div class="weiboshow">
  <p class="asidetitle">Weibo</p>
    <iframe width="100%" height="119" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=119&fansRow=2&ptype=1&speed=0&skin=9&isTitle=1&noborder=1&isWeibo=0&isFans=0&uid=&verifier=b3593ceb&dpc=1"></iframe>
</div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m Larry Page in Google. <br/>
			This is my blog,believe it or not.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/2176287895" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2020 
		
		<a href="/about" target="_blank" title="Stevin">Stevin</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>












<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?e6d1f421bbc9962127a50488f9ed37d1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="Back to Top"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
 </html>
