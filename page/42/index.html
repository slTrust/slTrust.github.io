<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  

  
  <title>Almost</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Almost">
<meta property="og:url" content="http://yoursite.com/page/42/index.html">
<meta property="og:site_name" content="Almost">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Almost">
  
    <link rel="alternate" href="/atom.xml" title="Almost" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Almost</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-P016_03_python匿名函数" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/28/P016_03_python匿名函数/" class="article-date">
  <time datetime="2018-07-28T03:55:36.000Z" itemprop="datePublished">2018-07-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/28/P016_03_python匿名函数/">P016_03_python匿名函数</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="匿名函数"><a href="#匿名函数" class="headerlink" title="匿名函数"></a>匿名函数</h3><p>为实现很简单需求而设计的一句话函数</p>
<h4 id="匿名函数使用规范"><a href="#匿名函数使用规范" class="headerlink" title="匿名函数使用规范"></a>匿名函数使用规范</h4><ul>
<li>匿名函数关键字是lambda</li>
<li>lambda写在最前面其后跟参数，然后以「:」为分割,最后实际的逻辑也就是最后的结果</li>
<li>必须一行结束</li>
<li>多个参数用「,」分开</li>
</ul>
<blockquote>
<p>万能公式  lambda 参数 : 返回值</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">xxx = lambda n:n*n</span><br><span class="line"></span><br><span class="line">#两个参数</span><br><span class="line">xxx = lambda m,n:m*n</span><br></pre></td></tr></table></figure>
<blockquote>
<p>求字段里值最大的</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">xx = &#123;&apos;k1&apos;:10,&apos;k2&apos;:20,&apos;k3&apos;:30&#125;</span><br><span class="line"></span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line">def fn(key):</span><br><span class="line">    return xx[key]</span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line">max(xx,key=lambda k:xx[k])</span><br></pre></td></tr></table></figure>
<h4 id="容易拿分的面试题"><a href="#容易拿分的面试题" class="headerlink" title="容易拿分的面试题"></a>容易拿分的面试题</h4><blockquote>
<p>1.问执行结果</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">d = lambda p:p*2</span><br><span class="line">t = lambda p:p*3</span><br><span class="line"></span><br><span class="line">x = 2</span><br><span class="line">x = d(x) # 4</span><br><span class="line">x = t(x) # 12</span><br><span class="line">x = d(x) # 24</span><br><span class="line">print(x)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>2.有俩元组((‘a’),(‘b’)),((‘c’),(‘d’))如何转换为列表[{‘a’:’c’},{‘b’:’d’}]</p>
</blockquote>
<p>提示zip拉链方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"># step001 先用zip把格式转换</span><br><span class="line">a = ((&apos;a&apos;),(&apos;b&apos;))</span><br><span class="line">b = ((&apos;c&apos;),(&apos;d&apos;))</span><br><span class="line"></span><br><span class="line">res = zip(a,b) # 此时是一个生成器</span><br><span class="line"></span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line">for i in res:</span><br><span class="line">    print(i)</span><br><span class="line"></span><br><span class="line">结果：</span><br><span class="line">(&apos;a&apos;,&apos;c&apos;) </span><br><span class="line">(&apos;b&apos;:&apos;d&apos;)</span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line"></span><br><span class="line"># step002 遍历这个生成器 将元组变为字典</span><br><span class="line"># filter/map/sorted/max/min</span><br><span class="line"></span><br><span class="line"># 分析出：明显是用map</span><br><span class="line">def func(tup):</span><br><span class="line">    return &#123;tup[0]:tup[1]&#125;</span><br><span class="line">res = map(func,res)</span><br><span class="line"></span><br><span class="line"># step003 优化用lambda</span><br><span class="line"></span><br><span class="line">res = map(lambda tup:&#123;tup[0]:tup[1]&#125;,res)</span><br><span class="line">print(list(res))</span><br><span class="line"></span><br><span class="line"># step004 各种优化</span><br><span class="line">res = map(lambda tup:&#123;tup[0]:tup[1]&#125;,zip(a,b))</span><br><span class="line"></span><br><span class="line">res = list(map(lambda tup:&#123;tup[0]:tup[1]&#125;,zip(a,b)))</span><br></pre></td></tr></table></figure>
<blockquote>
<p>3.刁钻面试题</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">def xx():</span><br><span class="line">    return (lambda x:i*x for i in range(4))</span><br><span class="line"></span><br><span class="line">[m(2) for m in xx()]</span><br><span class="line"></span><br><span class="line">结果</span><br><span class="line">[0,2,4,6]</span><br><span class="line"></span><br><span class="line">解析</span><br><span class="line">先看xx函数</span><br><span class="line">def xx():</span><br><span class="line">    return (lambda x:0*x,lambda x:1*x,lambda x:2*x,lambda x:3*x)</span><br><span class="line">[m(2) for m in xx()]</span><br><span class="line"></span><br><span class="line">m(2)实际就是个函数 并传递参数2带入。。。</span><br><span class="line">[0,2,4,6]</span><br></pre></td></tr></table></figure>
<h4 id="推荐一个流程图的工具ProcessOn"><a href="#推荐一个流程图的工具ProcessOn" class="headerlink" title="推荐一个流程图的工具ProcessOn"></a>推荐一个流程图的工具ProcessOn</h4>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/07/28/P016_03_python匿名函数/" data-id="cklhjp22l00cyulfy8ojpjkqr" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/fullstack/">fullstack</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-P016_02_python_memoryview用途" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/27/P016_02_python_memoryview用途/" class="article-date">
  <time datetime="2018-07-27T04:33:25.000Z" itemprop="datePublished">2018-07-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/27/P016_02_python_memoryview用途/">P016_02_python_memoryview用途</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<h2 id="注意：非重点知识点-几乎用不到"><a href="#注意：非重点知识点-几乎用不到" class="headerlink" title="注意：非重点知识点(几乎用不到)"></a>注意：非重点知识点(几乎用不到)</h2></blockquote>
<h3 id="memoryview"><a href="#memoryview" class="headerlink" title="memoryview"></a>memoryview</h3><ul>
<li>bytearray是可变(mutable)的字节序列，相对于Python2中的str，但str是不可变(immutable)的。</li>
<li>在Python3中由于str默认是unicode编码，所以只有通过bytearray才能按字节访问。</li>
</ul>
<blockquote>
<p>memoryview为支持buffer protocol[1,2]的对象提供了按字节的内存访问接口，好处是不会有内存拷贝。</p>
</blockquote>
<p>默认str和bytearray支持buffer procotol。</p>
<h4 id="下面两种行为的对比："><a href="#下面两种行为的对比：" class="headerlink" title="下面两种行为的对比："></a>下面两种行为的对比：</h4><blockquote>
<p>简单点就是，str和bytearray的切片操作会产生新的切片str和bytearry并拷贝数据，使用memoryview之后不会。</p>
</blockquote>
<h5 id="1-不使用memoryview"><a href="#1-不使用memoryview" class="headerlink" title="1.不使用memoryview"></a>1.不使用memoryview</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt; a = &apos;aaaaaa&apos;</span><br><span class="line">&gt;&gt; b = a[:2]    # 会产生新的字符串</span><br><span class="line"></span><br><span class="line">&gt;&gt; a = bytearray(&apos;aaaaaa&apos;)</span><br><span class="line">&gt;&gt; b = a[:2]    # 会产生新的bytearray</span><br><span class="line">&gt;&gt; b[:2] = &apos;bb&apos; # 对b的改动不影响a</span><br><span class="line">&gt;&gt; a</span><br><span class="line">bytearray(b&apos;aaaaaa&apos;)</span><br><span class="line">&gt;&gt; b</span><br><span class="line">bytearray(b&apos;bb&apos;)</span><br></pre></td></tr></table></figure>
<h5 id="2-使用memoryview"><a href="#2-使用memoryview" class="headerlink" title="2.使用memoryview"></a>2.使用memoryview</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt; a = &apos;aaaaaa&apos;</span><br><span class="line">&gt;&gt; ma = memoryview(a)</span><br><span class="line">&gt;&gt; ma.readonly  # 只读的memoryview</span><br><span class="line">True</span><br><span class="line">&gt;&gt; mb = ma[:2]  # 不会产生新的字符串</span><br><span class="line"></span><br><span class="line">&gt;&gt; a = bytearray(&apos;aaaaaa&apos;)</span><br><span class="line">&gt;&gt; ma = memoryview(a)</span><br><span class="line">&gt;&gt; ma.readonly  # 可写的memoryview</span><br><span class="line">False</span><br><span class="line">&gt;&gt; mb = ma[:2]      # 不会会产生新的bytearray</span><br><span class="line">&gt;&gt; mb[:2] = &apos;bb&apos;    # 对mb的改动就是对ma的改动</span><br><span class="line">&gt;&gt; mb.tobytes()</span><br><span class="line">&apos;bb&apos;</span><br><span class="line">&gt;&gt; ma.tobytes()</span><br><span class="line">&apos;bbaaaa&apos;</span><br></pre></td></tr></table></figure>
<h4 id="我的使用场景是网络程序中socket接收和接收数据的解析："><a href="#我的使用场景是网络程序中socket接收和接收数据的解析：" class="headerlink" title="我的使用场景是网络程序中socket接收和接收数据的解析："></a>我的使用场景是网络程序中socket接收和接收数据的解析：</h4><ol>
<li>使用memoryview之前的sock接收代码简化如下</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">def read(size):</span><br><span class="line">    ret = &apos;&apos; </span><br><span class="line">    remain = size</span><br><span class="line">    while True:</span><br><span class="line">        data = sock.recv(remain)</span><br><span class="line">        ret += data     # 这里不断会有新的str对象产生</span><br><span class="line">        if len(data) == remain:</span><br><span class="line">            break</span><br><span class="line">        remain -= len(data)</span><br><span class="line">    return ret</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>使用meoryview之后，避免了不断的字符串拼接和新对象的产生</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">def read(size):</span><br><span class="line">    ret = memoryview(bytearray(size)) </span><br><span class="line">    remain = size</span><br><span class="line">    while True:</span><br><span class="line">        data = sock.recv(remain)</span><br><span class="line">        length = len(data)</span><br><span class="line">        ret[size - remain: size - remain + length] = data</span><br><span class="line">        if len(data) == remain:</span><br><span class="line">            break</span><br><span class="line">        remain -= len(data)</span><br><span class="line">    return ret</span><br></pre></td></tr></table></figure>
<blockquote>
<p>返回memoryview还有一个优点，在使用struct进行unpack解析时可以直接接收memoryview对象，非常高效（避免大的str进行分段解析时大量的切片操作）。</p>
</blockquote>
<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mv = memoryview(&apos;\x00\x01\x02\x00\x00\xff...&apos;)</span><br><span class="line">type, len = struct.unpack(&apos;!BI&apos;, mv[:5])</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/07/27/P016_02_python_memoryview用途/" data-id="cklhjp22k00cxulfy96pswdhm" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/fullstack/">fullstack</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-P016_01_python内置函数收尾" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/26/P016_01_python内置函数收尾/" class="article-date">
  <time datetime="2018-07-26T13:54:31.000Z" itemprop="datePublished">2018-07-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/26/P016_01_python内置函数收尾/">P016_01_python内置函数收尾</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="python中一个让你懵的面试题"><a href="#python中一个让你懵的面试题" class="headerlink" title="python中一个让你懵的面试题"></a>python中一个让你懵的面试题</h3><blockquote>
<p>数据类型有哪些？</p>
</blockquote>
<ul>
<li>int</li>
<li>bool</li>
</ul>
<blockquote>
<p>数据结构</p>
</blockquote>
<ul>
<li>dict</li>
<li>list</li>
<li>tuple</li>
<li>set</li>
<li>str</li>
</ul>
<h3 id="剩余内置函数"><a href="#剩余内置函数" class="headerlink" title="剩余内置函数"></a>剩余内置函数</h3><blockquote>
<p>reversed() 保留原列表，返回一个反向的迭代器</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">l = [1,2,3,4,5]</span><br><span class="line">l.reverse()</span><br><span class="line">print(l) # 此时 l 还是那个列表只不过内容反序了</span><br><span class="line"></span><br><span class="line">l = [1,2,3,4,5]</span><br><span class="line">l2 = reversed(l)  # 保留 l 不变 ，返回一个反序的迭代器</span><br><span class="line">print(l2)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>slice() 切片方法</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">l = (1,2,23,213,5612,342,43)</span><br><span class="line">sli = slice(1,5,2)</span><br><span class="line">print(l[sli])</span><br><span class="line">print(l[1:5:2])</span><br></pre></td></tr></table></figure>
<h4 id="字符串相关内置方法"><a href="#字符串相关内置方法" class="headerlink" title="字符串相关内置方法"></a>字符串相关内置方法</h4><blockquote>
<p>format()</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">print(format(&apos;test&apos;, &apos;&lt;20&apos;)) # 开辟20个字符空间 左对齐</span><br><span class="line">print(format(&apos;test&apos;, &apos;&gt;40&apos;)) # 开辟40个字符空间 右对齐</span><br><span class="line">print(format(&apos;test&apos;, &apos;^40&apos;)) # 开辟40个字符空间 居中对齐</span><br><span class="line"></span><br><span class="line">结果：</span><br><span class="line">test                </span><br><span class="line">                                    test</span><br><span class="line">                  test</span><br></pre></td></tr></table></figure>
<blockquote>
<p>bytes() 把unicode转换成 「对应编码」 的bytes</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># 我拿到的是gbk编码的，我想转成utf-8编码</span><br><span class="line">print(bytes(&apos;你好&apos;,encoding=&apos;GBK&apos;))     # unicode转换成GBK的bytes</span><br><span class="line">print(b&apos;\xc4\xe3\xba\xc3&apos;.decode(encoding=&apos;GBK&apos;))</span><br><span class="line">print(bytes(&apos;你好&apos;,encoding=&apos;utf-8&apos;))   # unicode转换成utf-8的bytes</span><br><span class="line">print(b&apos;\xe4\xbd\xa0\xe5\xa5\xbd&apos;.decode(encoding=&apos;utf-8&apos;))</span><br><span class="line">结果：</span><br><span class="line">b&apos;\xc4\xe3\xba\xc3&apos;   gbk编码的byte编码</span><br><span class="line">你好    decode按照gbk解码后的unicode字符</span><br><span class="line">b&apos;\xe4\xbd\xa0\xe5\xa5\xbd&apos;   utf-8编码的byte编码</span><br><span class="line">你好    decode按照utf-8解码后的unicode字符</span><br></pre></td></tr></table></figure>
<blockquote>
<p>bytearry()</p>
</blockquote>
<ul>
<li>网络编程 只能传二进制</li>
<li>照片和视频也是以二进制存储</li>
<li>html网页爬取到的也是编码</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">b_array = bytearray(&apos;你好&apos;,encoding=&apos;utf-8&apos;) # unicode 你好转换为 utf-8编码的 byte数组</span><br><span class="line">print(b_array)</span><br><span class="line">print(len(b_array))</span><br><span class="line">print(b_array[0])</span><br><span class="line"></span><br><span class="line">结果：</span><br><span class="line">bytearray(b&apos;\xe4\xbd\xa0\xe5\xa5\xbd&apos;)</span><br><span class="line">6</span><br><span class="line">228</span><br></pre></td></tr></table></figure>
<blockquote>
<p>memoryview (非重点知识点)</p>
</blockquote>
<ul>
<li>将数据转换为指定编码的byte之后进行一次memoryview就可以进行切片,同时：这个切片不创建新的,而且这个切片是字节类型的</li>
</ul>
<p><a href="https://segmentfault.com/q/1010000007137721" target="_blank" rel="noopener">详情请参考 https://segmentfault.com/q/1010000007137721</a></p>
<p>也可以看我的摘录上述链接的信息在 [P016_01_python内置函数收尾]</p>
<blockquote>
<p>ord() 字符按照unicode转数字</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">print(ord(&apos;好&apos;)) # 22909</span><br><span class="line">print(ord(&apos;a&apos;))  # 97</span><br><span class="line">print(ord(&apos;1&apos;))  # 49</span><br></pre></td></tr></table></figure>
<blockquote>
<p>chr() 将数字转字符</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chr(97) # a</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ascii() </p>
</blockquote>
<p>只要是ascii码中的内容，就打印出来，不是就转换成\u</p>
<blockquote>
<h4 id="repr-原样输出"><a href="#repr-原样输出" class="headerlink" title="repr() 原样输出"></a>repr() 原样输出</h4></blockquote>
<p>用于%r格式化输出(%r实际就是调用repr())</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">name = &apos;egg&apos;</span><br><span class="line">print(&apos;你好%r&apos;%name)</span><br><span class="line">print(repr(&apos;1&apos;))</span><br><span class="line">print(repr(1))</span><br><span class="line"></span><br><span class="line">结果：</span><br><span class="line">你好&apos;egg&apos;</span><br><span class="line">&apos;1&apos;</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<h4 id="数据集合相关方法"><a href="#数据集合相关方法" class="headerlink" title="数据集合相关方法"></a>数据集合相关方法</h4><ol>
<li>字典：</li>
</ol>
<ul>
<li>dict</li>
</ul>
<ol start="2">
<li>集合：</li>
</ol>
<ul>
<li>set：无序排序且不重复，是可变的。</li>
<li>frozenset：是冻结的集合，他是不可变的，存在哈希值。可以作为字典的key</li>
</ul>
<h4 id="判断值的False-True"><a href="#判断值的False-True" class="headerlink" title="判断值的False/True"></a>判断值的False/True</h4><ul>
<li>all</li>
<li>any</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">all([&apos;a&apos;,&apos;&apos;,123]) # False 有一个值是False就是False</span><br><span class="line"></span><br><span class="line">any([&apos;a&apos;,123]) # True </span><br><span class="line">any([&apos;a&apos;,&apos;&apos;,123]) # True 有一个值是True就是True</span><br></pre></td></tr></table></figure>
<h4 id="拉链方法"><a href="#拉链方法" class="headerlink" title="拉链方法"></a>拉链方法</h4><ul>
<li>zip</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">a = [1,2,3]</span><br><span class="line">b = [&apos;a&apos;,&apos;b&apos;,&apos;c&apos;]</span><br><span class="line"># zip(a,b) # 返回的是 迭代器</span><br><span class="line">for i in zip(a,b):</span><br><span class="line">    print(i)</span><br><span class="line"></span><br><span class="line">结果：</span><br><span class="line">(1,&apos;a&apos;)</span><br><span class="line">(2,&apos;b&apos;)</span><br><span class="line">(3,&apos;c&apos;)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>如果俩个列表长度不一致呢？</p>
</blockquote>
<p>从头开始对齐，以短列表长度为准</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">a = [1,2,3,4]</span><br><span class="line">b = [&apos;a&apos;,&apos;b&apos;,&apos;c&apos;]</span><br><span class="line">for i in zip(a,b):</span><br><span class="line">    print(i)</span><br><span class="line"></span><br><span class="line">结果：</span><br><span class="line">(1,&apos;a&apos;)</span><br><span class="line">(2,&apos;b&apos;)</span><br><span class="line">(3,&apos;c&apos;)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>多个呢？而且是元组呢？元组子元素继续是列表呢？</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">a = [1,2,3,4]</span><br><span class="line">b = [&apos;a&apos;,&apos;b&apos;,&apos;c&apos;]</span><br><span class="line">c = (&apos;*&apos;,&apos;**&apos;,[1,2])</span><br><span class="line">for i in zip(a,b,c):</span><br><span class="line">    print(i)</span><br><span class="line"></span><br><span class="line">结果：</span><br><span class="line">(1,&apos;a&apos;,&apos;*&apos;)</span><br><span class="line">(2,&apos;b&apos;,&apos;**&apos;)</span><br><span class="line">(3,&apos;c&apos;,[1,2])</span><br></pre></td></tr></table></figure>
<blockquote>
<p>如果是字典呢？</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">a = [1,2,3,4]</span><br><span class="line">b = [&apos;a&apos;,&apos;b&apos;,&apos;c&apos;]</span><br><span class="line">c = (&apos;*&apos;,&apos;**&apos;,[1,2])</span><br><span class="line">d = &#123;&quot;k1&quot;:1,&quot;k2&quot;:2&#125;</span><br><span class="line">for i in zip(a,b,c,d):</span><br><span class="line">    print(i)</span><br><span class="line"></span><br><span class="line">结果：</span><br><span class="line">(1,&apos;a&apos;,&apos;*&apos;,&apos;k1&apos;)</span><br><span class="line">(2,&apos;b&apos;,&apos;**&apos;,&apos;k2&apos;)</span><br><span class="line">-----------------------------由于字典的key是无序的 所以 k1 k2的顺序不是固定的</span><br></pre></td></tr></table></figure>
<h4 id="filter和map"><a href="#filter和map" class="headerlink" title="filter和map"></a>filter和map</h4><blockquote>
<p>filter(函数名,可迭代的数据类型)</p>
</blockquote>
<p>根据返回值的布尔值来过滤</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">def is_odd(x):</span><br><span class="line">    return x%2 == 1</span><br><span class="line"></span><br><span class="line">res = filter(is_odd,[1,4,6,7,9,12,17])</span><br><span class="line">print(res) # 又是一个迭代器</span><br><span class="line"></span><br><span class="line">for i in res:</span><br><span class="line">    print(i)</span><br><span class="line">结果：</span><br><span class="line">1</span><br><span class="line">7</span><br><span class="line">9</span><br><span class="line">17</span><br></pre></td></tr></table></figure>
<blockquote>
<p>练习：求1-100开平方是100的数字</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#要引入模块了</span><br><span class="line">form math import sqrt</span><br><span class="line">def func(n):</span><br><span class="line">    res = sqrt(n)</span><br><span class="line">    return res%1 == 0 </span><br><span class="line"></span><br><span class="line">res = filter(func,range(1,101))</span><br></pre></td></tr></table></figure>
<blockquote>
<p>map</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">res = map(abs,[1,-4,6,-8])</span><br><span class="line">for i in res:</span><br><span class="line">    print(i)</span><br><span class="line">结果：</span><br><span class="line">1</span><br><span class="line">4</span><br><span class="line">6</span><br><span class="line">8</span><br></pre></td></tr></table></figure>
<blockquote>
<p>总结:</p>
</blockquote>
<ul>
<li>filter执行之后的结果集合 &lt;= 数据源</li>
<li>map 执行之后元素个数不变,值可能发生改变</li>
</ul>
<h4 id="sorted函数"><a href="#sorted函数" class="headerlink" title="sorted函数"></a>sorted函数</h4><p>可定制的排序</p>
<ul>
<li>生成了一个新列表</li>
<li>不改变原列表</li>
<li>占内存</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a = [1,-4,6,5,-10]</span><br><span class="line">a.sort(key=abs) # 在原列表基础上进行排序</span><br><span class="line"></span><br><span class="line">b =  [2,-4,6,-5]</span><br><span class="line">print(sorted(b)) # 直接返回排序后的列表（已经不是生成器了，所以慎用），它排序后原列表还在</span><br><span class="line">print(b)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>花式用法</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sorted(a,reversed=False)</span><br><span class="line">sorted(a,reversed=True)</span><br><span class="line">sorted(a,key=abs,reversed=False)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>练习：列表按照每一个元素的长度排序</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a = [&apos;   &apos;,[1,2],&apos;hello world&apos;]</span><br><span class="line">new_a = sorted(a,key=len)</span><br><span class="line"></span><br><span class="line">你也可以这样</span><br><span class="line">def xxx(n):</span><br><span class="line">    return len(n)</span><br><span class="line">new_a = sorted(a,key=xxx)</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/07/26/P016_01_python内置函数收尾/" data-id="cklhjp22k00cuulfyvd09qb04" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/fullstack/">fullstack</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-P015_02_python内置函数二" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/26/P015_02_python内置函数二/" class="article-date">
  <time datetime="2018-07-26T12:43:11.000Z" itemprop="datePublished">2018-07-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/26/P015_02_python内置函数二/">P015_02_python内置函数二</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="字符串类型代码的执行"><a href="#字符串类型代码的执行" class="headerlink" title="字符串类型代码的执行"></a>字符串类型代码的执行</h3><ul>
<li>eval </li>
<li>exec</li>
<li>compile</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">eval(&apos;print(123)&apos;) # 123</span><br><span class="line">exec(&apos;print(123)&apos;) # 123</span><br><span class="line"></span><br><span class="line">eval(&apos;1+2+3&apos;) # 10</span><br><span class="line">exec(&apos;1+2+3&apos;) # None</span><br></pre></td></tr></table></figure>
<blockquote>
<p>eval 和 exec区别</p>
</blockquote>
<ul>
<li>都可以执行字符串代码</li>
<li>exec没有返回值</li>
</ul>
<blockquote>
<h4 id="eval建议不要轻易使用，只能用在你明确知道要执行的代码"><a href="#eval建议不要轻易使用，只能用在你明确知道要执行的代码" class="headerlink" title="eval建议不要轻易使用，只能用在你明确知道要执行的代码"></a>eval建议不要轻易使用，只能用在你明确知道要执行的代码</h4></blockquote>
<p>尤其eval(文件里的字符串/用户输入的) 非常危险</p>
<blockquote>
<p>compile编译</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">code = &apos;&apos;&apos;for i in range(10):</span><br><span class="line">    print(i)</span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line">exec(code) #</span><br></pre></td></tr></table></figure>
<blockquote>
<p>如果code的内容是500行代码 每次exec都要编译</p>
</blockquote>
<blockquote>
<p>compile就是一次编译多次执行</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">code1 = &apos;for i in range(10):print(i)&apos;</span><br><span class="line">compile1 = compile(code1,&apos;&apos;,&apos;exec&apos;)</span><br><span class="line">exec(compile1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">code1 = &apos;1+2+3&apos;</span><br><span class="line">compile2 = compile(code2,&apos;&apos;,&apos;eval&apos;)</span><br><span class="line">print(eval(compile2)) # 6</span><br></pre></td></tr></table></figure>
<blockquote>
<p>pycharm没法帮你找到字符串里的变量声明</p>
</blockquote>
<blockquote>
<h4 id="交互类命令要用-single"><a href="#交互类命令要用-single" class="headerlink" title="交互类命令要用 single"></a>交互类命令要用 single</h4></blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">code3 = &apos;name = input(&quot;请输入账号&quot;)&apos;</span><br><span class="line">compile3 = compile(code3,&apos;&apos;,&apos;single&apos;)</span><br><span class="line">print(exec(compile3)) # 执行交互命令</span><br><span class="line">print(name) # pycharm无法检测到name 因为它在待编译的模板里还没有执行</span><br></pre></td></tr></table></figure>
<h3 id="和数字相关"><a href="#和数字相关" class="headerlink" title="和数字相关"></a>和数字相关</h3><ul>
<li>complex 复数</li>
<li>bool</li>
<li>int </li>
<li>float 当你小数位过多时就不准了</li>
</ul>
<blockquote>
<p>进制转换</p>
</blockquote>
<ul>
<li>bin() 二进制 0b开头</li>
<li>oct() 八进制 0o开头</li>
<li>hex() 十六进制 0x开头</li>
</ul>
<blockquote>
<p>数学运算</p>
</blockquote>
<ul>
<li>abs() 绝对值</li>
<li>divmod()  div除法 mod取余 ==》 分页处理</li>
<li>round() 四舍五入</li>
<li>pow() 幂运算</li>
<li>sum()</li>
<li>min()</li>
<li>max()</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">abs(-5) # 5</span><br><span class="line">divmod(7,2) # (7整除2,7对2取余) =&gt;(3,1)</span><br><span class="line">divmod(9,5) # (9整除5,9对5取余) =&gt;(1,4)</span><br><span class="line">round(3.1415926,3) # 3.14</span><br><span class="line"></span><br><span class="line">pow(2,3) # 2*2*2 ==》8</span><br><span class="line">如果三个参数就是 对最后的参数取余</span><br><span class="line">pow(2,3,3) # 8取余3 ==》2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sum(1,2,3) # 6</span><br><span class="line">sum([1,2,3]) # 6</span><br><span class="line">sum([1,2,3],10) # 10代表起始值  ==》 31</span><br><span class="line"></span><br><span class="line">min([1,2,3,4]) # 1</span><br><span class="line">min(1,2,3,4) # 1</span><br><span class="line">min(1,2,3,-4) # -4</span><br><span class="line">min(1,2,3,-4,key=abs) # 1</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/07/26/P015_02_python内置函数二/" data-id="cklhjp22j00ctulfyuwkys9xo" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/fullstack/">fullstack</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-P015_01_python内置函数" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/26/P015_01_python内置函数/" class="article-date">
  <time datetime="2018-07-26T10:46:33.000Z" itemprop="datePublished">2018-07-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/26/P015_01_python内置函数/">P015_01_python内置函数</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="什么是内置函数"><a href="#什么是内置函数" class="headerlink" title="什么是内置函数"></a>什么是内置函数</h3><p>就是不用你def就可以直接调用的 如 </p>
<ul>
<li>print()</li>
<li>input()</li>
<li>len()</li>
<li>type()</li>
<li>open()</li>
<li>tuple()</li>
<li>list()</li>
<li>int()</li>
<li>bool()</li>
<li>set()</li>
<li>dir()</li>
<li>id()</li>
<li>str()</li>
</ul>
<h4 id="作用域相关"><a href="#作用域相关" class="headerlink" title="作用域相关"></a>作用域相关</h4><ul>
<li>locals()</li>
<li>globals()</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">global 变量</span><br><span class="line">nonlocal 变量</span><br></pre></td></tr></table></figure>
<h4 id="迭代器-生成器相关"><a href="#迭代器-生成器相关" class="headerlink" title="迭代器/生成器相关"></a>迭代器/生成器相关</h4><ul>
<li>range</li>
<li>next</li>
<li>iter</li>
</ul>
<blockquote>
<p>next()</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">迭代器.__next__() 这个是迭代器的方法</span><br><span class="line">next(迭代器) 这个是内置函数</span><br><span class="line"></span><br><span class="line">它俩完成的事一样，而__next__()是真正完成功能的地方</span><br><span class="line">------------------------------</span><br><span class="line"># next()的实质就是</span><br><span class="line">def next(迭代器):</span><br><span class="line">    迭代器.__next__()</span><br><span class="line"></span><br><span class="line"># len()的实质就是</span><br><span class="line">def len([]):</span><br><span class="line">    [].__len__()</span><br></pre></td></tr></table></figure>
<blockquote>
<p>iter()</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">迭代器 = iter(可迭代的)</span><br><span class="line">迭代器 = 可迭代的.__iter__()</span><br></pre></td></tr></table></figure>
<blockquote>
<p>range()</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">print(&apos;__next__&apos; in dir(range(10))) # False 可迭代的，但不是一个迭代器</span><br><span class="line"></span><br><span class="line">print(&apos;__next__&apos; in dir(iter(range(10))) # True 通过iter转换为迭代器</span><br></pre></td></tr></table></figure>
<h4 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h4><blockquote>
<p>dir</p>
</blockquote>
<p>查看一个变量拥有的方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dir([])</span><br><span class="line">dir(&#123;&#125;)</span><br><span class="line">dir(1)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>callable </p>
</blockquote>
<p>调用相关,我们知道函数调用要使用()才可以,但是我们怎么知道一个xxx()就可以调用呢？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">print(callable(print)) # True</span><br><span class="line"></span><br><span class="line">a = 1</span><br><span class="line">print(callable(a)) # False</span><br></pre></td></tr></table></figure>
<h4 id="help"><a href="#help" class="headerlink" title="help"></a>help</h4><blockquote>
<p>查看帮助文档(在一些政府，银行禁网的封闭开发情况下)</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">help(str) # 打印和 str相关的方法 以及用法</span><br></pre></td></tr></table></figure>
<h4 id="模块相关"><a href="#模块相关" class="headerlink" title="模块相关"></a>模块相关</h4><ul>
<li>import</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import time # 表面是调用了一个关键字</span><br><span class="line">time.time()</span><br><span class="line">实际上是</span><br><span class="line">time = __import__(time)</span><br><span class="line">time.time()</span><br></pre></td></tr></table></figure>
<h4 id="文件相关"><a href="#文件相关" class="headerlink" title="文件相关"></a>文件相关</h4><ul>
<li>open</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">f = open(&apos;1.txt&apos;)</span><br><span class="line">print(f.writeable())  # 代表能不能写入</span><br><span class="line">print(f.readable())  # 代表能不能读取</span><br></pre></td></tr></table></figure>
<h4 id="内存相关"><a href="#内存相关" class="headerlink" title="内存相关"></a>内存相关</h4><ul>
<li>id()  获取变量的内存地址</li>
<li>hash() 和内存相关的东西</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">print(hash(12345))  # 有结果   </span><br><span class="line">print(hash(&apos;fsdafsadfasdf&apos;))   # 有结果</span><br><span class="line">print(hash((1,&apos;aaa&apos;)))   # 有结果</span><br><span class="line"></span><br><span class="line">print(hash([1,2,3]))  # 报错 unhashable type:&apos;list&apos; 意思就是不可哈希</span><br></pre></td></tr></table></figure>
<blockquote>
<p>对于可哈希数据类型的hash值在一次程序执行过程中总是不变的</p>
</blockquote>
<p>如出现两次 ‘hahaha’ 他俩哈希值相同</p>
<blockquote>
<h4 id="hash函数和字典的存储规则有关系"><a href="#hash函数和字典的存储规则有关系" class="headerlink" title="hash函数和字典的存储规则有关系"></a>hash函数和字典的存储规则有关系</h4></blockquote>
<p>字典的查找速度特别快，只要有key可以瞬间找到值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">原理：</span><br><span class="line">step001</span><br><span class="line">dict = &#123;</span><br><span class="line">    key:value</span><br><span class="line">&#125;</span><br><span class="line">第一次创建key的时候 会生成一个hash值 3214141244(标识一个内存地址)</span><br><span class="line">然后把value放到这个地址里</span><br><span class="line"></span><br><span class="line">最后查询 dict[key] 实际是 hash(key) ==&gt; value</span><br></pre></td></tr></table></figure>
<h4 id="输入输出"><a href="#输入输出" class="headerlink" title="输入输出"></a>输入输出</h4><ul>
<li>input</li>
<li>print</li>
</ul>
<blockquote>
<p>input</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">res = input(&apos;请输入账号&apos;) # 输入成功后按回车才把值给 res</span><br></pre></td></tr></table></figure>
<blockquote>
<p>print 其实你不会</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">print() # 每次print会自动给你一个换行</span><br><span class="line"></span><br><span class="line">不想要换行咋办</span><br><span class="line"></span><br><span class="line">print(&apos;我们是祖国的花朵&apos;,end=&apos;&apos;)</span><br><span class="line">print(&apos;我们是祖国的花朵&apos;,end=&apos;&apos;)</span><br><span class="line"># 我们是祖国的花朵我们是祖国的花朵</span><br><span class="line"></span><br><span class="line">print(1,2,3,4,5) # 1 2 3 4 5</span><br><span class="line"></span><br><span class="line">有分隔符的输出</span><br><span class="line"></span><br><span class="line">print(1,2,3,4,5,sep=&apos;|&apos;) # 1|2|3|4|5</span><br><span class="line"></span><br><span class="line">将输出写入到文件</span><br><span class="line">f = open(&apos;file&apos;,&apos;w&apos;)</span><br><span class="line">print(&apos;aaa&apos;,file=f)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/07/26/P015_01_python内置函数/" data-id="cklhjp22i00cqulfywxg5u71c" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/fullstack/">fullstack</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-P014_01_python生成器进阶及生成器表达式、列表推导式" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/25/P014_01_python生成器进阶及生成器表达式、列表推导式/" class="article-date">
  <time datetime="2018-07-25T06:23:38.000Z" itemprop="datePublished">2018-07-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/25/P014_01_python生成器进阶及生成器表达式、列表推导式/">P014_01_python生成器进阶及生成器表达式、列表推导式</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="生成器回顾"><a href="#生成器回顾" class="headerlink" title="生成器回顾"></a>生成器回顾</h3><blockquote>
<p>双下方法 ： 很少直接调用的方法。一般情况下，是通过其他语法触发的</p>
</blockquote>
<h4 id="next"><a href="#next" class="headerlink" title="next()"></a>next()</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#娃哈哈%i</span><br><span class="line">def wahaha():</span><br><span class="line">    for i in range(2000000):</span><br><span class="line">        yield &apos;娃哈哈%s&apos;%i</span><br><span class="line"></span><br><span class="line"># wahaha是一个生成器函数</span><br><span class="line">g = wahaha()</span><br><span class="line"></span><br><span class="line">#我们获取它的内容明显不该 这样</span><br><span class="line"># g.__next__()</span><br><span class="line"></span><br><span class="line">print(next(g))</span><br><span class="line">print(next(g))</span><br><span class="line">print(next(g))</span><br><span class="line">print(next(g))</span><br></pre></td></tr></table></figure>
<h4 id="send"><a href="#send" class="headerlink" title="send()"></a>send()</h4><blockquote>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">def generator():</span><br><span class="line">    print(123)</span><br><span class="line">    content = yield 1</span><br><span class="line">    print(&apos;=======&apos;,content)</span><br><span class="line">    print(456)</span><br><span class="line">    yield 2</span><br><span class="line"></span><br><span class="line"># 返回生成器对象</span><br><span class="line">g = generator() </span><br><span class="line"></span><br><span class="line"># 返回第一个yield 后的值 1</span><br><span class="line">ret = g.__next__()</span><br><span class="line">print(&apos;***&apos;,ret)</span><br><span class="line"></span><br><span class="line"># 给上一个  yield传递一个值</span><br><span class="line">ret = g.send(&apos;hello&apos;)   #send的效果和next一样</span><br><span class="line">print(&apos;***&apos;,ret)</span><br><span class="line"></span><br><span class="line">结果：</span><br><span class="line">123</span><br><span class="line">*** 1</span><br><span class="line">======= hello</span><br><span class="line">456</span><br><span class="line">*** 2</span><br></pre></td></tr></table></figure>
<h4 id="send和-next的区别"><a href="#send和-next的区别" class="headerlink" title="send和 next的区别"></a>send和 next的区别</h4><ul>
<li>相同点：都可以让生成器向下走一步</li>
<li>异同点： send 可以给一个值，这个值作为上一个 yield 的整体的结果返回</li>
</ul>
<blockquote>
<p>使用send的注意事项:</p>
</blockquote>
<ol>
<li>第一次使用生成器的时候,必须要用next获取下一个值(因为send是给上一个yield 设置结果，而第一次的时候没有上一个yield)</li>
<li>最后一个yield不能接受外部的值(因为后面没有 yield 了)</li>
</ol>
<blockquote>
<p>为啥第一次不能用send() </p>
</blockquote>
<p>因为会报错！！！详情请看 <a href="https://www.zhihu.com/question/28105502" target="_blank" rel="noopener">为什么python的yield第一次不能用send发送数据？</a></p>
<h4 id="经典练习"><a href="#经典练习" class="headerlink" title="经典练习"></a>经典练习</h4><blockquote>
<p>求移动平均值</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&apos;&apos;&apos;</span><br><span class="line">10 =&gt; 10</span><br><span class="line">10 20 =&gt; 15</span><br><span class="line">10 20 30 =&gt; 20</span><br><span class="line">10 20 30 10 =&gt; 17.5</span><br><span class="line">avg =sum/count</span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line">def xxx():</span><br><span class="line">    sum = 0</span><br><span class="line">    count = 0</span><br><span class="line">    num = 0</span><br><span class="line">    avg = 0</span><br><span class="line">    while True:</span><br><span class="line">        # num = yield # 接受一个10</span><br><span class="line">        sum += num  # 10</span><br><span class="line">        count += 1  # 1</span><br><span class="line">        avg = sum/count</span><br><span class="line">        num = yield avg</span><br><span class="line"></span><br><span class="line">avg_g = xxx()</span><br><span class="line"></span><br><span class="line">avg_g.__next__()</span><br><span class="line">avg_g.send(10)</span><br><span class="line">avg_g.send(20)</span><br><span class="line">avg_g.send(30)</span><br><span class="line">avg_g.send(10)</span><br><span class="line"></span><br><span class="line">结果：</span><br><span class="line">0.0</span><br><span class="line">5.0</span><br><span class="line">10.0</span><br><span class="line">15.0</span><br></pre></td></tr></table></figure>
<blockquote>
<p>移动平均值优化</p>
</blockquote>
<p>需求就是不要第一次调用next(),因为对使用者没有意义</p>
<p>提示：装饰器</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">def init(func):</span><br><span class="line">    def inner(*args,**kwargs):</span><br><span class="line">        g = func(*args,**kwargs)</span><br><span class="line">        g.__next__()</span><br><span class="line">        return g</span><br><span class="line">    return inner</span><br><span class="line"></span><br><span class="line">@init</span><br><span class="line">def xxx():</span><br><span class="line">    sum = 0</span><br><span class="line">    count = 0</span><br><span class="line">    num = 0</span><br><span class="line">    avg = 0</span><br><span class="line">    while True:</span><br><span class="line">        # num = yield # 接受一个10</span><br><span class="line">        sum += num  # 10</span><br><span class="line">        count += 1  # 1</span><br><span class="line">        avg = sum/count</span><br><span class="line">        num = yield avg</span><br><span class="line"></span><br><span class="line">avg_g = xxx()</span><br><span class="line"></span><br><span class="line">res = avg_g.send(10)</span><br><span class="line">print(res)</span><br><span class="line">res = avg_g.send(20)</span><br><span class="line">print(res)</span><br><span class="line">res = avg_g.send(30)</span><br><span class="line">print(res)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>这个效果就是 预激活装饰器</p>
</blockquote>
<h4 id="python3新增知识点"><a href="#python3新增知识点" class="headerlink" title="python3新增知识点"></a>python3新增知识点</h4><p>先看如下例子:把a,b里面的字符一个一个的返回</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">def xxx():</span><br><span class="line">    a = &apos;abc&apos;</span><br><span class="line">    b = &apos;123&apos;</span><br><span class="line"></span><br><span class="line">    for i in a:</span><br><span class="line">        yield i</span><br><span class="line">    for i in b:</span><br><span class="line">        yield i</span><br><span class="line"></span><br><span class="line">g = xxx()</span><br><span class="line"></span><br><span class="line">for i in g:</span><br><span class="line">    print(i)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">结果：</span><br><span class="line">a</span><br><span class="line">b</span><br><span class="line">c</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td></tr></table></figure>
<p>添加 yield from</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">def xxx():</span><br><span class="line">    a = &apos;abc&apos;</span><br><span class="line">    b = &apos;123&apos;</span><br><span class="line"></span><br><span class="line">    yield from a</span><br><span class="line">    yield from b</span><br><span class="line"></span><br><span class="line">g = xxx()</span><br><span class="line"></span><br><span class="line">for i in g:</span><br><span class="line">    print(i)</span><br><span class="line"></span><br><span class="line">结果：</span><br><span class="line">a</span><br><span class="line">b</span><br><span class="line">c</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td></tr></table></figure>
<blockquote>
<h4 id="yield-from-的作用就是："><a href="#yield-from-的作用就是：" class="headerlink" title="yield from 的作用就是："></a>yield from 的作用就是：</h4></blockquote>
<p>从一个容器类型里取得值不需要一个一个取而是集体返回</p>
<h3 id="各种表达式推到式"><a href="#各种表达式推到式" class="headerlink" title="各种表达式推到式"></a>各种表达式推到式</h3><h4 id="列表推到式"><a href="#列表推到式" class="headerlink" title="列表推到式"></a>列表推到式</h4><p>10个鸡蛋的列表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&apos;&apos;&apos;</span><br><span class="line">eggList = []</span><br><span class="line">for i in range(10):</span><br><span class="line">    eggList.append(&quot;鸡蛋%s&quot;%i)</span><br><span class="line"></span><br><span class="line">print(eggList)</span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line"></span><br><span class="line"># 一句话代替上面的效果</span><br><span class="line">eggList2 = [&quot;鸡蛋%s&quot;%i for i in range(10)] #列表推到式</span><br><span class="line">print(eggList2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[i for i in range(10)] # [0,1,2,3,4,5,6,7,8,9]</span><br><span class="line"></span><br><span class="line">[i*i for i in range(10)] # [0,1,4,9,16,25,36,49,64,81]</span><br></pre></td></tr></table></figure>
<h4 id="生成器表达式"><a href="#生成器表达式" class="headerlink" title="生成器表达式"></a>生成器表达式</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">g = ( i for i in range(10) )</span><br><span class="line">print(g) #注意这是生成器</span><br></pre></td></tr></table></figure>
<blockquote>
<p>列表推导式和生成器表达式的区别</p>
</blockquote>
<ul>
<li>括号不一样</li>
<li>返回值不同，生成器表达式几乎不占用内存</li>
</ul>
<blockquote>
<p>一道面试题</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">g = ( i for i in range(10) )</span><br><span class="line"></span><br><span class="line">发生了什么：</span><br><span class="line">1.跟函数定义一样什么也不执行</span><br><span class="line">2.直到 g.__next__() 时，里面的循环才走一次</span><br></pre></td></tr></table></figure>
<h4 id="各种推导式"><a href="#各种推导式" class="headerlink" title="各种推导式"></a>各种推导式</h4><p>公式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[每一个元素 for 元素 in 可迭代数据类型]</span><br><span class="line">[满足条件元素 for 元素 in 可迭代数据类型 if 元素相关条件判断]</span><br></pre></td></tr></table></figure>
<blockquote>
<p>30以内被3整除的数</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[i for i in range(30) if i%3 == 0]</span><br></pre></td></tr></table></figure>
<blockquote>
<p>30以内被3整除的数的平方</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[i*i for i in range(30) if i%3 == 0]</span><br></pre></td></tr></table></figure>
<blockquote>
<p>找到多重嵌套列表内名字包含e字母 超过两个的</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">names = [</span><br><span class="line">    [&apos;ae&apos;,&apos;ee&apos;,&apos;eve&apos;,&apos;even&apos;],</span><br><span class="line">    [&apos;xx&apos;,&apos;xe&apos;,&apos;egg&apos;,&apos;ele&apos;]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">[name for lst in names for name in lst if name.count(&apos;e&apos;)==2 ]</span><br></pre></td></tr></table></figure>
<blockquote>
<h5 id="字典推导式"><a href="#字典推导式" class="headerlink" title="字典推导式"></a>字典推导式</h5></blockquote>
<p>将一个字典的key和value颠倒</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xx = &#123;&apos;a&apos;:10,&apos;b&apos;:22&#125;</span><br><span class="line"></span><br><span class="line">xx2 = &#123; xx[k]:k for k in xx&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<h5 id="集合推导式"><a href="#集合推导式" class="headerlink" title="集合推导式"></a>集合推导式</h5></blockquote>
<p>计算列表中每个值的平方，在带去重功能</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">squared = &#123;x**2 for x in [1, -1, 2]&#125;</span><br><span class="line">print(squared)</span><br><span class="line"># set([1, 4])</span><br></pre></td></tr></table></figure>
<h3 id="面试题详解"><a href="#面试题详解" class="headerlink" title="面试题详解"></a>面试题详解</h3><blockquote>
<p>面试题1</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">def demo():</span><br><span class="line">    for i in range(4):</span><br><span class="line">        yield i</span><br><span class="line"></span><br><span class="line">g = demo()</span><br><span class="line">g1 = ( i for i in g)</span><br><span class="line">g2 = ( i for i in g1)</span><br><span class="line"></span><br><span class="line">print(list(g1))</span><br><span class="line">print(list(g2))</span><br><span class="line"></span><br><span class="line">结果：</span><br><span class="line">[0,1,2,3]</span><br><span class="line">[]</span><br><span class="line"></span><br><span class="line">前5行啥都没干</span><br><span class="line">直到print(list(g1)) 时才从g中生成到g1 ,但是g1是一个生成器 在list(g1)时把g1里的值已经取走了</span><br><span class="line"></span><br><span class="line">所以到print(list(g2))的时候 是个空列表</span><br></pre></td></tr></table></figure>
<blockquote>
<p>面试题2</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">def add(n,i):</span><br><span class="line">    return n+i</span><br><span class="line"></span><br><span class="line">def test():</span><br><span class="line">    for i in range(4):</span><br><span class="line">        yield i</span><br><span class="line"></span><br><span class="line">g = test()</span><br><span class="line">for n in [1,10,5]:</span><br><span class="line">    g =( add(n,i) for i in g)</span><br><span class="line"></span><br><span class="line">print(list(g))</span><br><span class="line"></span><br><span class="line">解析：</span><br><span class="line">第一步</span><br><span class="line">n = 1 </span><br><span class="line">g= (add(n,i) for i in g)</span><br><span class="line">n = 10 </span><br><span class="line">g= (add(n,i) for i in g)</span><br><span class="line">n = 5</span><br><span class="line">g= (add(n,i) for i in g)</span><br><span class="line">第二步--》换元法</span><br><span class="line">n = 1 </span><br><span class="line">g= (add(n,i) for i in test())</span><br><span class="line">n = 10 </span><br><span class="line">g= (add(n,i) for i in (add(n,i) for i in test()))</span><br><span class="line">第三步--》换元法</span><br><span class="line">n = 5</span><br><span class="line">g= (add(n,i) for i in (add(n,i) for i in (add(n,i) for i in test())) )</span><br><span class="line">第四步带入 n =5  0,1,2,3</span><br><span class="line">(add(n,i) for i in (add(n,i) for i in (add(n,i) for i in (0,1,2,3))))</span><br><span class="line"></span><br><span class="line">n = 5</span><br><span class="line">(add(n,i) for i in (add(n,i) for i in (5,6,7,8)))</span><br><span class="line">n = 5</span><br><span class="line">(add(n,i) for i in (10,11,12,13))</span><br><span class="line"></span><br><span class="line">(15,16,17,18)</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/07/25/P014_01_python生成器进阶及生成器表达式、列表推导式/" data-id="cklhjp22h00coulfyhdjtktx8" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/fullstack/">fullstack</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-P013_01_python迭代器和生成器" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/24/P013_01_python迭代器和生成器/" class="article-date">
  <time datetime="2018-07-24T11:42:30.000Z" itemprop="datePublished">2018-07-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/24/P013_01_python迭代器和生成器/">P013_01_python迭代器</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="迭代器初识"><a href="#迭代器初识" class="headerlink" title="迭代器初识"></a>迭代器初识</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">a = [1,2,3]</span><br><span class="line"># 索引</span><br><span class="line"># 循环for</span><br><span class="line"></span><br><span class="line">for i in a:</span><br><span class="line">    print(i)</span><br><span class="line"></span><br><span class="line">for k in dic:</span><br><span class="line">    pass</span><br></pre></td></tr></table></figure>
<ul>
<li>list</li>
<li>dic</li>
<li>str</li>
<li>set</li>
<li>tuple</li>
<li>f = open()文件</li>
<li>range()</li>
<li>enumerate</li>
</ul>
<h3 id="迭代器的概念"><a href="#迭代器的概念" class="headerlink" title="迭代器的概念"></a>迭代器的概念</h3><blockquote>
<p>先来一个小知识点，查看一个对象可用的方法 dir</p>
</blockquote>
<p>dir(对象)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">print(dir([])) #告诉我列表拥有的方法</span><br><span class="line">print(dir(&#123;&#125;)) #告诉我字典拥有的方法</span><br><span class="line">print(dir(&apos;&apos;)) #告诉我字符串拥有的方法</span><br><span class="line">print(dir(range(10))) #告诉我range(10)拥有的方法</span><br></pre></td></tr></table></figure>
<blockquote>
<p>我们知道数组相加如下</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[1] + [2] # [1,2]</span><br><span class="line">实际上就是调用  [1].__add__([2])</span><br></pre></td></tr></table></figure>
<blockquote>
<p>找这些能被for循环使用的方法的交集</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 取这些可被for循环的数据类型的交集</span><br><span class="line">ret = set(dir([]))&amp;set(dir(&#123;&#125;))&amp;set(dir(&apos;&apos;))&amp;set(dir(range(10)))</span><br><span class="line">print(ret)  #iterable</span><br></pre></td></tr></table></figure>
<p>只要能被for循环的数据类型，就一定有<strong>iter</strong>方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">print(&apos;__iter__&apos; in dir(int))</span><br><span class="line">print(&apos;__iter__&apos; in dir(bool))</span><br><span class="line">print(&apos;__iter__&apos; in dir(list))</span><br><span class="line">print(&apos;__iter__&apos; in dir(dict))</span><br><span class="line">print(&apos;__iter__&apos; in dir(set))</span><br><span class="line">print(&apos;__iter__&apos; in dir(tuple))</span><br><span class="line">print(&apos;__iter__&apos; in dir(enumerate([])))</span><br><span class="line">print(&apos;__iter__&apos; in dir(range(1)))</span><br><span class="line"></span><br><span class="line">结果：</span><br><span class="line">False</span><br><span class="line">False</span><br><span class="line">True</span><br><span class="line">True</span><br><span class="line">True</span><br><span class="line">True</span><br><span class="line">True</span><br><span class="line">True</span><br></pre></td></tr></table></figure>
<h4 id="一个列表执行了iter-之后的返回值就是一个迭代器"><a href="#一个列表执行了iter-之后的返回值就是一个迭代器" class="headerlink" title="一个列表执行了iter()之后的返回值就是一个迭代器"></a>一个列表执行了<strong>iter</strong>()之后的返回值就是一个迭代器</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">print(dir([]))</span><br><span class="line">print(dir([].__iter__()))</span><br><span class="line">print(set(dir([].__iter__())) - set(dir([])))</span><br><span class="line">print([1,&apos;a&apos;,&apos;bbb&apos;].__iter__().__length_hint__())  #元素个数</span><br></pre></td></tr></table></figure>
<p>再看双下划线 next方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">l = [1,2,3]</span><br><span class="line">iterator = l.__iter__()</span><br><span class="line">print(iterator.__next__()) # 1</span><br><span class="line">print(iterator.__next__()) # 2</span><br><span class="line">print(iterator.__next__()) # 3</span><br><span class="line">print(iterator.__next__()) # 报错</span><br><span class="line"></span><br><span class="line">[].__iter__() 迭代器  -- &gt; __next__  #通过next就可以从迭代器中一个一个的取值</span><br></pre></td></tr></table></figure>
<blockquote>
<p>迭代器要点：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Iterable  可迭代的    -- &gt; __iter__  #只要含有__iter__方法的都是可迭代的</span><br><span class="line"> </span><br><span class="line">只要含有__iter__方法的都是可迭代的 —— 可迭代协议</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">l = [1,2,3,4]</span><br><span class="line">for i in l.__iter__():</span><br><span class="line">    print(i)</span><br></pre></td></tr></table></figure>
<h4 id="迭代器的概念-1"><a href="#迭代器的概念-1" class="headerlink" title="迭代器的概念"></a>迭代器的概念</h4><blockquote>
<p>迭代器协议 —— 内部含有<strong>next</strong>和<strong>iter</strong>方法的就是迭代器</p>
</blockquote>
<h4 id="迭代器协议和可迭代协议"><a href="#迭代器协议和可迭代协议" class="headerlink" title="迭代器协议和可迭代协议"></a>迭代器协议和可迭代协议</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">可以被for循环的都是可迭代的</span><br><span class="line">可迭代的内部都有__iter__方法</span><br><span class="line">只要是迭代器 一定可迭代</span><br><span class="line">可迭代的.__iter__()方法就可以得到一个迭代器</span><br><span class="line">迭代器中的__next__()方法可以一个一个的获取值</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">for循环其实就是在使用迭代器</span><br><span class="line">iterator</span><br><span class="line">可迭代对象</span><br><span class="line">直接给你内存地址</span><br><span class="line">print([].__iter__())</span><br><span class="line">print(range(10))</span><br></pre></td></tr></table></figure>
<h4 id="for循环的本质"><a href="#for循环的本质" class="headerlink" title="for循环的本质"></a>for循环的本质</h4><blockquote>
<p>只有 是可迭代对象的时候 才能用for<br>当我们遇到一个新的变量，不确定能不能for循环的时候，就判断它是否可迭代</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">for i in l:</span><br><span class="line">    pass</span><br><span class="line"></span><br><span class="line"># for循环的本质就是迭代器</span><br><span class="line">#iterator = l.__iter__()</span><br><span class="line">#iterator.__next__()</span><br></pre></td></tr></table></figure>
<h4 id="迭代器的好处："><a href="#迭代器的好处：" class="headerlink" title="迭代器的好处："></a>迭代器的好处：</h4><ul>
<li>从容器类型中一个一个的取值，会把所有的值都取到。</li>
<li>节省内存空间<br>  迭代器并不会在内存中再占用一大块内存，<br>  而是随着循环 每次生成一个<br>  每次next每次给我一个</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">range(10000000000000000)  # 并不是立即生成，否则很浪费内存空间</span><br><span class="line"></span><br><span class="line">list(range(10000000000000000)) # 估计内存炸了，把迭代器转为列表</span><br></pre></td></tr></table></figure>
<h3 id="生成器"><a href="#生成器" class="headerlink" title="生成器"></a>生成器</h3><p>本质是个迭代器</p>
<h4 id="生成器函数"><a href="#生成器函数" class="headerlink" title="生成器函数"></a>生成器函数</h4><blockquote>
<p>1.我们先实现一个普通方法</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">def generator():</span><br><span class="line">    print(1)</span><br><span class="line">    return &apos;a&apos;</span><br><span class="line"></span><br><span class="line">xxx = generator()</span><br><span class="line">print(xxx)</span><br><span class="line"></span><br><span class="line">结果</span><br><span class="line">1</span><br><span class="line">a</span><br></pre></td></tr></table></figure>
<blockquote>
<p>2.yield关键字</p>
</blockquote>
<p>将刚刚的return 换成 yield</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">def generator():</span><br><span class="line">    print(1)</span><br><span class="line">    yield &apos;a&apos;</span><br><span class="line"></span><br><span class="line">xxx = generator()</span><br><span class="line">print(xxx)</span><br><span class="line"></span><br><span class="line">结果：</span><br><span class="line">&lt;generator object generator at 0x000000000238C518&gt;</span><br><span class="line"></span><br><span class="line">------------------------------------------------------------</span><br><span class="line">print(xxx.__next__())</span><br><span class="line">结果：</span><br><span class="line">1</span><br><span class="line">a</span><br></pre></td></tr></table></figure>
<p>####　什么是生成器</p>
<ul>
<li>只要含有yield关键字的函数都是生成器函数</li>
<li>yield不能和return共用而且需要写在函数内部</li>
<li>函数内部有yield关键字，这个函数执行返回的结果就是生成器，并且不会执行函数内部代码</li>
</ul>
<blockquote>
<h4 id="生成器函数-：-执行之后会得到一个生成器作为返回值"><a href="#生成器函数-：-执行之后会得到一个生成器作为返回值" class="headerlink" title="生成器函数 ： 执行之后会得到一个生成器作为返回值"></a>生成器函数 ： 执行之后会得到一个生成器作为返回值</h4></blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">def xxx():</span><br><span class="line">    print(&apos;====&gt;a&apos;)</span><br><span class="line">    yield 1</span><br><span class="line">    print(&apos;====&gt;b&apos;)</span><br><span class="line">    yield 2</span><br><span class="line">    print(&apos;====&gt;c&apos;)</span><br><span class="line">    yield 3</span><br><span class="line">    print(&apos;====&gt;end&apos;)</span><br><span class="line"></span><br><span class="line">g=xxx()</span><br><span class="line"></span><br><span class="line">print(g.__next__()) # 返回第一次yield关键字后面的值</span><br><span class="line">print(g.__next__()) # 返回第二次yield关键字后面的值</span><br><span class="line">print(g.__next__()) # 返回第三次yield关键字后面的值</span><br><span class="line">print(g.__next__()) # 报错 </span><br><span class="line"></span><br><span class="line">====&gt;a</span><br><span class="line">1</span><br><span class="line">====&gt;b</span><br><span class="line">2</span><br><span class="line">====&gt;c</span><br><span class="line">3</span><br><span class="line">====&gt;end</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;D:/python_code/py20180718/001.py&quot;, line 18, in &lt;module&gt;</span><br><span class="line">    print(g.__next__())</span><br><span class="line">StopIteration</span><br></pre></td></tr></table></figure>
<blockquote>
<p>需求打印 200,0000次 哇哈哈1==》哇哈哈2000000，而我现在只要50个</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#娃哈哈%i</span><br><span class="line">def wahaha():</span><br><span class="line">    for i in range(2000000):</span><br><span class="line">        yield &apos;娃哈哈%s&apos;%i</span><br><span class="line"></span><br><span class="line">g = wahaha()</span><br><span class="line">count = 0</span><br><span class="line">for i in g:</span><br><span class="line">    count +=1</span><br><span class="line">    if count &gt; 50:</span><br><span class="line">        break</span><br><span class="line">    print(&apos;```````````&apos;+i+&apos;`````````````&apos;)</span><br></pre></td></tr></table></figure>
<h4 id="生成器真的省内存吗？"><a href="#生成器真的省内存吗？" class="headerlink" title="生成器真的省内存吗？"></a>生成器真的省内存吗？</h4><blockquote>
<p>碰巧前面我们刚学过如何测试效率和装饰器，正好拿来练习！！！</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">import time</span><br><span class="line"></span><br><span class="line">def test(func):</span><br><span class="line">    def inner(*args,**kwargs):</span><br><span class="line">        start_time = time.time()</span><br><span class="line">        res = func(*args,**kwargs)</span><br><span class="line">        end_time = time.time()</span><br><span class="line">        print(&quot;测试效率:&quot;, end_time - start_time)</span><br><span class="line">        return res</span><br><span class="line">    return inner</span><br><span class="line"></span><br><span class="line">@test</span><br><span class="line">def getList(n):</span><br><span class="line">    l1 = list(range(n))</span><br><span class="line">@test</span><br><span class="line">def getGenerator(n):</span><br><span class="line">    for i in range(n):</span><br><span class="line">        yield i</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">getList(100000)</span><br><span class="line">getGenerator(100000)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">结果：</span><br><span class="line">测试效率: 0.004000663757324219</span><br><span class="line">测试效率: 0.0</span><br></pre></td></tr></table></figure>
<blockquote>
<p>分析下就可以知道，列表是将0-99999都生成后放进列表里了，所以用时比较多。<br>而生成器只是封装了算法，每次调用在去调用算法，这样做就可以做到节省内存了。</p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/07/24/P013_01_python迭代器和生成器/" data-id="cklhjp22g00clulfytls8184m" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/fullstack/">fullstack</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-P012_01_python装饰器进阶" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/24/P012_01_python装饰器进阶/" class="article-date">
  <time datetime="2018-07-24T04:27:01.000Z" itemprop="datePublished">2018-07-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/24/P012_01_python装饰器进阶/">P012_01_python装饰器进阶</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="先来看看一些题外话-一个函数的相关信息"><a href="#先来看看一些题外话-一个函数的相关信息" class="headerlink" title="先来看看一些题外话(一个函数的相关信息)"></a>先来看看一些题外话(一个函数的相关信息)</h3><ul>
<li>name 函数名</li>
<li>doc 函数文档</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">def xxx():</span><br><span class="line">    &apos;&apos;&apos;</span><br><span class="line">    一个打印 哈哈哈 的函数</span><br><span class="line">    &apos;&apos;&apos;</span><br><span class="line">    print(&apos;哈哈哈&apos;)</span><br><span class="line"></span><br><span class="line">print(xxx.__name__)  # xxx</span><br><span class="line">print(xxx.__doc__)   # 一个打印 哈哈哈 的函数</span><br></pre></td></tr></table></figure>
<blockquote>
<p>那要是被装饰器的函数呢？</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">def wrapper(func):</span><br><span class="line">    def inner(*args,**kwargs):</span><br><span class="line">        res = func(*args,**kwargs)</span><br><span class="line">        return res</span><br><span class="line">    return inner</span><br><span class="line"></span><br><span class="line">@wrapper</span><br><span class="line">def xxx2():</span><br><span class="line">    &apos;&apos;&apos;</span><br><span class="line">    测试xxx2</span><br><span class="line">    &apos;&apos;&apos;</span><br><span class="line">    print(&apos;HAHA&apos;)</span><br><span class="line"></span><br><span class="line">print(xxx2.__name__) # inner</span><br><span class="line">print(xxx2.__doc__)  # None</span><br></pre></td></tr></table></figure>
<h4 id="wraps模块"><a href="#wraps模块" class="headerlink" title="wraps模块"></a>wraps模块</h4><blockquote>
<p>解决查看函数相关信息的问题</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># step1引入wraps模块</span><br><span class="line">from functools import wraps</span><br><span class="line"></span><br><span class="line">def wrapper(func):</span><br><span class="line">    # step2 使用这个模块的装饰器函数</span><br><span class="line">    @wraps(func)</span><br><span class="line">    def inner(*args,**kwargs):</span><br><span class="line">        res = func(*args,**kwargs)</span><br><span class="line">        return res</span><br><span class="line">    return inner</span><br><span class="line"></span><br><span class="line">@wrapper</span><br><span class="line">def xxx2():</span><br><span class="line">    &apos;&apos;&apos;</span><br><span class="line">    测试xxx2</span><br><span class="line">    &apos;&apos;&apos;</span><br><span class="line">    print(&apos;HAHA&apos;)</span><br><span class="line"></span><br><span class="line">print(xxx2.__name__) # xxx2</span><br><span class="line">print(xxx2.__doc__)  # 测试xxx2</span><br></pre></td></tr></table></figure>
<h3 id="带参数装饰器"><a href="#带参数装饰器" class="headerlink" title="带参数装饰器"></a>带参数装饰器</h3><p>通过布尔值来决定「是否」启动装饰器</p>
<blockquote>
<p>首先装饰器的原理是闭包</p>
</blockquote>
<blockquote>
<p>控制装饰器是否开启的原理就是：在原装饰器的基础上再一次的闭包</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">import time</span><br><span class="line">FLAGE = False # 决定装饰器是否开启的布尔值</span><br><span class="line">def timmer_out(flag):  #接受参数的装饰器用来处理是否开启装饰器</span><br><span class="line">    def timmer(func):</span><br><span class="line">        def inner(*args,**kwargs):</span><br><span class="line">            if flag:</span><br><span class="line">                start = time.time()</span><br><span class="line">                ret = func(*args,**kwargs)</span><br><span class="line">                end = time.time()</span><br><span class="line">                print(end-start)</span><br><span class="line">                return ret</span><br><span class="line">            else:</span><br><span class="line">                ret = func(*args, **kwargs)</span><br><span class="line">                return ret</span><br><span class="line">        return inner</span><br><span class="line">    return timmer</span><br><span class="line">    </span><br><span class="line"># timmer = timmer_out(FLAGE)</span><br><span class="line">@timmer_out(FLAGE)    #wahaha = timmer(wahaha)</span><br><span class="line">def wahaha():</span><br><span class="line">    time.sleep(0.1)</span><br><span class="line">    print(&apos;wahahahahahaha&apos;)</span><br><span class="line"></span><br><span class="line">@timmer_out(FLAGE)</span><br><span class="line">def wahaha2():</span><br><span class="line">    time.sleep(0.1)</span><br><span class="line">    print(&apos;wahahahahahaha2222222&apos;)</span><br><span class="line"></span><br><span class="line">wahaha()</span><br><span class="line">wahaha2()</span><br></pre></td></tr></table></figure>
<h3 id="多个装饰器调用顺序"><a href="#多个装饰器调用顺序" class="headerlink" title="多个装饰器调用顺序"></a>多个装饰器调用顺序</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">def wrapper1(func):</span><br><span class="line">    def inner1():</span><br><span class="line">        print(&apos;wrapper1 ,before func&apos;)</span><br><span class="line">        ret = func()</span><br><span class="line">        print(&apos;wrapper1 ,after func&apos;)</span><br><span class="line">        return ret</span><br><span class="line">    return inner1</span><br><span class="line"></span><br><span class="line">def wrapper2(func):</span><br><span class="line">    def inner2():</span><br><span class="line">        print(&apos;wrapper2 ,before func&apos;)</span><br><span class="line">        ret = func()</span><br><span class="line">        print(&apos;wrapper2 ,after func&apos;)</span><br><span class="line">        return ret</span><br><span class="line">    return inner2</span><br><span class="line"></span><br><span class="line">def wrapper3(func):</span><br><span class="line">    def inner3():</span><br><span class="line">        print(&apos;wrapper3 ,before func&apos;)</span><br><span class="line">        ret = func()</span><br><span class="line">        print(&apos;wrapper3 ,after func&apos;)</span><br><span class="line">        return ret</span><br><span class="line">    return inner3</span><br><span class="line"></span><br><span class="line">@wrapper3</span><br><span class="line">@wrapper2</span><br><span class="line">@wrapper1</span><br><span class="line">def f():</span><br><span class="line">    print(&apos;in f&apos;)</span><br><span class="line">    return &apos;哈哈哈&apos;</span><br><span class="line"></span><br><span class="line">print(f())</span><br><span class="line"></span><br><span class="line">结果：</span><br><span class="line">wrapper3 ,before func</span><br><span class="line">wrapper2 ,before func</span><br><span class="line">wrapper1 ,before func</span><br><span class="line">in f</span><br><span class="line">wrapper1 ,after func</span><br><span class="line">wrapper2 ,after func</span><br><span class="line">wrapper3 ,after func</span><br><span class="line">哈哈哈</span><br></pre></td></tr></table></figure>
<blockquote>
<p>多个装饰器的效果就是「俄罗斯套娃」</p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/07/24/P012_01_python装饰器进阶/" data-id="cklhjp22g00cjulfy1llfg6jg" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/fullstack/">fullstack</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-P011_01_python装饰器初识" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/23/P011_01_python装饰器初识/" class="article-date">
  <time datetime="2018-07-23T13:16:00.000Z" itemprop="datePublished">2018-07-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/23/P011_01_python装饰器初识/">P011_01_python装饰器初识</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="1-零碎知识点"><a href="#1-零碎知识点" class="headerlink" title="1.零碎知识点"></a>1.零碎知识点</h3><h4 id="三目运算符"><a href="#三目运算符" class="headerlink" title="三目运算符"></a>三目运算符</h4><blockquote>
<p>公式： 变量 = 条件返回True的结果  if 条件 else 条件返回False的结果</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a = 1</span><br><span class="line">b = 5</span><br><span class="line">c = a if a&gt;b else b # 三元运算</span><br><span class="line">print(c) # 5</span><br></pre></td></tr></table></figure>
<h4 id="time模块"><a href="#time模块" class="headerlink" title="time模块"></a>time模块</h4><ul>
<li>time.time() </li>
<li>time.sleep() 让程序执行到这个位置的时候停一会儿</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import time </span><br><span class="line">time.sleep(5) # 让程序执行到这个位置的时候停一会儿</span><br><span class="line">print(&apos;哈哈哈&apos;)</span><br><span class="line"></span><br><span class="line">print(time.time()) # 1514426720.953799 返回从1970.1.1 0:0:0到现在的 秒</span><br><span class="line"></span><br><span class="line"># 5秒后 打印 哈哈哈</span><br></pre></td></tr></table></figure>
<h3 id="2-装饰器前奏之年终评级测试代码效率"><a href="#2-装饰器前奏之年终评级测试代码效率" class="headerlink" title="2.装饰器前奏之年终评级测试代码效率"></a>2.装饰器前奏之年终评级测试代码效率</h3><blockquote>
<p>1.测试效率</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import time </span><br><span class="line"></span><br><span class="line">def test():</span><br><span class="line">    time.sleep(0.1)</span><br><span class="line">    print(&apos;老板好同事好大家好&apos;)</span><br><span class="line"></span><br><span class="line">def timmer(func):</span><br><span class="line">    start = time.time()</span><br><span class="line">    func()</span><br><span class="line">    end = time.time()</span><br><span class="line">    print(end - start)</span><br><span class="line"></span><br><span class="line"># 测试代码效率</span><br><span class="line">timmer(test)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>2.这样虽然实现了，但是你的同事必须 每次都timmer(xx) /timmer(aa) /timmer(bb)</p>
</blockquote>
<p>我们想要的最终结果就是 直接调用func()</p>
<blockquote>
<p>需求：不想修改函数的调用方式，但是还想在原来函数前后添加功能</p>
</blockquote>
<blockquote>
<h4 id="timmer-就是一个装饰器函数，只是对一个函数，有一些装饰作用"><a href="#timmer-就是一个装饰器函数，只是对一个函数，有一些装饰作用" class="headerlink" title="timmer 就是一个装饰器函数，只是对一个函数，有一些装饰作用"></a>timmer 就是一个装饰器函数，只是对一个函数，有一些装饰作用</h4></blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import time </span><br><span class="line"></span><br><span class="line">def test():</span><br><span class="line">    time.sleep(0.1)</span><br><span class="line">    print(&apos;老板好同事好大家好&apos;)</span><br><span class="line"></span><br><span class="line">def timmer(func):</span><br><span class="line">    def inner():</span><br><span class="line">        start = time.time()</span><br><span class="line">        func()</span><br><span class="line">        end = time.time()</span><br><span class="line">        print(end - start)</span><br><span class="line">    return inner</span><br><span class="line"></span><br><span class="line"># 这样的效果就是如下</span><br><span class="line">test = timmer(test)</span><br><span class="line">test()</span><br></pre></td></tr></table></figure>
<h3 id="3-装饰器初识"><a href="#3-装饰器初识" class="headerlink" title="3.装饰器初识"></a>3.装饰器初识</h3><blockquote>
<p>原则：开放封闭原则</p>
</blockquote>
<ul>
<li>开放：对扩展是开放的（在不改变原功能函数调用方式的基础上扩展）</li>
<li>封闭：对修改是封闭的（不修改原功能函数）</li>
</ul>
<h4 id="语法糖"><a href="#语法糖" class="headerlink" title="语法糖"></a>语法糖</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import time </span><br><span class="line"></span><br><span class="line">def timmer(func):  #装饰器函数</span><br><span class="line">    def inner():</span><br><span class="line">        start = time.time()</span><br><span class="line">        func()</span><br><span class="line">        end = time.time()</span><br><span class="line">        print(end - start)</span><br><span class="line">    return inner</span><br><span class="line"></span><br><span class="line">@timmer          #语法糖 @+装饰器函数</span><br><span class="line">def test():      #被装饰的函数</span><br><span class="line">    time.sleep(0.1)</span><br><span class="line">    print(&apos;老板好同事好大家好&apos;)</span><br><span class="line"></span><br><span class="line"># 直接这样就实现了刚刚的功能</span><br><span class="line"># test = timmer(test) 语法糖就是去掉了这句话</span><br><span class="line">test()</span><br><span class="line"></span><br><span class="line">print(test) #None</span><br></pre></td></tr></table></figure>
<p>为什么最后 test()的结果是None</p>
<ul>
<li>inner没有返回值</li>
</ul>
<p>修改如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import time </span><br><span class="line">def timmer(func):  #装饰器函数</span><br><span class="line">    def inner():</span><br><span class="line">        start = time.time()</span><br><span class="line">        res = func() # 用一个变量保存 func的执行结果</span><br><span class="line">        end = time.time()</span><br><span class="line">        print(end - start)</span><br><span class="line">        return res</span><br><span class="line">    return inner</span><br><span class="line"></span><br><span class="line">@timmer         </span><br><span class="line">def test():     </span><br><span class="line">    time.sleep(0.1)</span><br><span class="line">    print(&apos;老板好同事好大家好&apos;)</span><br><span class="line">    return &apos;老板好&apos;</span><br><span class="line"></span><br><span class="line">test() # &apos;老板好&apos;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>虽然我们简单的实现了装饰器的雏形，但是如果功能函数要接受参会素怎么办？</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import time </span><br><span class="line">def timmer(func):  #装饰器函数</span><br><span class="line">    def inner(a):</span><br><span class="line">        start = time.time()</span><br><span class="line">        res = func(a) # 用一个变量保存 func的执行结果</span><br><span class="line">        end = time.time()</span><br><span class="line">        print(end - start)</span><br><span class="line">        return res</span><br><span class="line">    return inner</span><br><span class="line"></span><br><span class="line">@timmer         </span><br><span class="line">def test(a):     </span><br><span class="line">    time.sleep(0.1)</span><br><span class="line">    print(&apos;老板好同事好大家好&apos;,a)</span><br><span class="line">    return &apos;老板好&apos;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 内部原理</span><br><span class="line"># test = timmer(test) 此时 test = inner</span><br><span class="line"># test(1)  inner(1)</span><br><span class="line"></span><br><span class="line">test(1)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>如果有两个参数呢？继续傻傻的填参数修改。。。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import time </span><br><span class="line">def timmer(func):  #装饰器函数</span><br><span class="line">    def inner(a,b):</span><br><span class="line">        start = time.time()</span><br><span class="line">        res = func(a,b) # 用一个变量保存 func的执行结果</span><br><span class="line">        end = time.time()</span><br><span class="line">        print(end - start)</span><br><span class="line">        return res</span><br><span class="line">    return inner</span><br><span class="line"></span><br><span class="line">@timmer         </span><br><span class="line">def test(a,b):     </span><br><span class="line">    time.sleep(0.1)</span><br><span class="line">    print(&apos;老板好同事好大家好&apos;,a,b)</span><br><span class="line">    return &apos;老板好&apos;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 内部原理</span><br><span class="line"># test = timmer(test) 此时 test = inner</span><br><span class="line"># test(1,2)  inner(1,2)</span><br><span class="line"></span><br><span class="line">test(1,2)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>我们不知道函数参数有多少或者是什么形式的（万能参数）</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import time </span><br><span class="line">def timmer(func):  #装饰器函数</span><br><span class="line">    def inner(*args,**kwargs):</span><br><span class="line">        start = time.time()</span><br><span class="line">        res = func(*args,**kwargs) # 用一个变量保存 func的执行结果</span><br><span class="line">        end = time.time()</span><br><span class="line">        print(end - start)</span><br><span class="line">        return res</span><br><span class="line">    return inner</span><br><span class="line"></span><br><span class="line">@timmer         </span><br><span class="line">def test(a,b,c):     </span><br><span class="line">    time.sleep(0.1)</span><br><span class="line">    print(&apos;老板好同事好大家好&apos;,a,b)</span><br><span class="line">    return &apos;老板好&apos;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 内部原理</span><br><span class="line"># test = timmer(test) 此时 test = inner</span><br><span class="line"># test(1,2,c=3)  inner(1,2,c=3)</span><br><span class="line"></span><br><span class="line">test(1,2,c=3)</span><br></pre></td></tr></table></figure>
<blockquote>
<h4 id="去掉所有多余的代码-再看装饰器代码"><a href="#去掉所有多余的代码-再看装饰器代码" class="headerlink" title="去掉所有多余的代码,再看装饰器代码"></a>去掉所有多余的代码,再看装饰器代码</h4></blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">def wrapper(func):  #装饰器函数 func是被装饰的函数</span><br><span class="line">    def inner(*args,**kwargs):</span><br><span class="line">        res = func(*args,**kwargs) # 用一个变量保存 func的执行结果</span><br><span class="line">        return res</span><br><span class="line">    return inner</span><br><span class="line"></span><br><span class="line">@wrapper        # test = wrapper(test)         </span><br><span class="line">def test(a,b,c):     </span><br><span class="line">    time.sleep(0.1)</span><br><span class="line">    print(&apos;老板好同事好大家好&apos;,a,b)</span><br><span class="line">    return &apos;老板好&apos;</span><br></pre></td></tr></table></figure>
<h4 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h4><p>装饰器</p>
<ul>
<li>开发原则：开放封闭原则</li>
<li>装饰器的作用：在不改变原函数的调用方式的情况下，在函数前后添加功能</li>
<li>装饰器的本质：闭包函数</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/07/23/P011_01_python装饰器初识/" data-id="cklhjp22f00cgulfypha9zjd8" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/fullstack/">fullstack</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-P010_01_python命名空间和作用域" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/23/P010_01_python命名空间和作用域/" class="article-date">
  <time datetime="2018-07-23T03:25:58.000Z" itemprop="datePublished">2018-07-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/23/P010_01_python命名空间和作用域/">P010_01_python命名空间和作用域</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="函数的命名空间"><a href="#函数的命名空间" class="headerlink" title="函数的命名空间"></a>函数的命名空间</h3><blockquote>
<p>命名空间一共分为三种：</p>
</blockquote>
<ul>
<li>内置命名空间 —— Python解释器<ol>
<li>就是python解释器一启动就可以使用的名字存储在内置命名空间中</li>
<li>内置的名字在启动解释器的时候被加载进内存里<br>print() 、len()、list、tuple等</li>
</ol>
</li>
<li>全局命名空间 —— 我们写的代码但不是函数中的代码<ol>
<li>是在程序从上到下被执行的过程中依次加载进内存的</li>
<li>放置了我们设置的所有变量名和函数名</li>
</ol>
</li>
<li>局部命名空间 —— 函数<ol>
<li>就是函数内部定义的名字</li>
<li>当调用函数的时候，才会产生这个名称空间，随着函数执行的结束，这个命名空间又消失了</li>
</ol>
</li>
</ul>
<blockquote>
<p>注意：</p>
</blockquote>
<ul>
<li>在局部:可以使用全局、内置命名空间中的名字</li>
<li>在全局:可以使用内置命名空间中的名字，但是不能用局部的</li>
<li>在内置:不能使用局部和全局的名字的</li>
</ul>
<h4 id="命名空间的使用"><a href="#命名空间的使用" class="headerlink" title="命名空间的使用"></a>命名空间的使用</h4><blockquote>
<p>全局不能访问局部</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">def func():</span><br><span class="line">    a = 1</span><br><span class="line"></span><br><span class="line">func()</span><br><span class="line">print(a) # 报错 a为 func函数内部定义的变量为局部变量，不能在全局中访问</span><br></pre></td></tr></table></figure>
<blockquote>
<p>内置和全局都存在的max方法</p>
</blockquote>
<p>这个非常神似js的作用域链</p>
<ol>
<li>max为系统定义过的</li>
<li>你在全局里重新定义max</li>
<li>调用的时候就会使用全局里定义的(就近原则)</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">def max(l):</span><br><span class="line">    print(&apos;in max func&apos;)</span><br><span class="line"></span><br><span class="line">print(max([1,2,3]))</span><br></pre></td></tr></table></figure>
<blockquote>
<p>python的关怀</p>
</blockquote>
<ul>
<li>func  –&gt; 函数的内存地址</li>
<li>函数名() 函数的调用</li>
<li>函数的内存地址() 函数的调用</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">def xxx():</span><br><span class="line">    print(1)</span><br><span class="line"></span><br><span class="line">print(xxx) # 打印出一个地址  &lt;function xxx at 0x00000000004D2E18&gt;</span><br></pre></td></tr></table></figure>
<p>通过函数名调用明显比 调用形如「0x00000000004D2E18 」的十六进制数表示的内存地址要快。</p>
<p>(在一个班级的环境中：你是选择用人名来产生会话？还是身份证号。)</p>
<blockquote>
<p>xxx函数的调用过程</p>
</blockquote>
<ol>
<li>xxx() 的时候</li>
<li>会现在全局范围内找有没有 xxx的定义，有则调用，反之去它的上一层也就是 内置命名空间，有则调用，反之报错</li>
</ol>
<h3 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h3><h4 id="作用域的种类"><a href="#作用域的种类" class="headerlink" title="作用域的种类"></a>作用域的种类</h4><ul>
<li>全局作用域 —— 作用在全局 —— 内置和全局名字空间中的名字都属于全局作用域  ——globals()<br>  注：永远打印全局的名字</li>
<li>局部作用域 —— 作用在局部 —— 函数（局部名字空间中的名字属于局部作用域） ——locals()<br>  注：输出什么，根据locals所在的位置(根据调用位置来输出结果)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">print(globals())</span><br><span class="line">print(locals())</span><br><span class="line"># 结果一样  因为都在全局作用域里</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">def func():</span><br><span class="line">    a = 12</span><br><span class="line">    b = 20</span><br><span class="line">    print(locals())</span><br><span class="line">    print(globals())</span><br><span class="line"></span><br><span class="line">func()</span><br><span class="line"># 结果不一样 </span><br><span class="line"># globals在哪里调用都是输出全局作用域里的内容</span><br><span class="line"># locals 这里只有   &#123;&apos;a&apos;: 12 , &apos;b&apos;: 20&#125;</span><br></pre></td></tr></table></figure>
<h4 id="global关键字的作用"><a href="#global关键字的作用" class="headerlink" title="global关键字的作用"></a>global关键字的作用</h4><ol>
<li>对于不可变数据类型，在局部可查看全局作用域中的变量，但是不能直接修改</li>
<li>如果想要修改的时候影响到全局，需要在程序的一开始添加global声明</li>
<li>如果在一个局部（函数）内声明了一个global变量，那么这个变量在局部的所有操作将对全局的变量有效</li>
</ol>
<blockquote>
<p>不修改的情况下可以直接访问全局作用域的变量</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a = 1</span><br><span class="line">def xxx():</span><br><span class="line">    print(a)</span><br><span class="line"></span><br><span class="line">xxx() # 1</span><br></pre></td></tr></table></figure>
<blockquote>
<p>修改全局变量</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">a = 1</span><br><span class="line">def xxx():</span><br><span class="line">    a = 2</span><br><span class="line">    print(a)</span><br><span class="line"></span><br><span class="line">xxx() # 2</span><br><span class="line">print(a) # 1</span><br><span class="line"></span><br><span class="line"># 影响到全局</span><br><span class="line">b = 1</span><br><span class="line">def xxx():</span><br><span class="line">    global b</span><br><span class="line">    b = 2</span><br><span class="line">    print(b)</span><br><span class="line"></span><br><span class="line">xxx() # 2</span><br><span class="line">print(b) # 2</span><br></pre></td></tr></table></figure>
<h3 id="函数的嵌套和作用域链"><a href="#函数的嵌套和作用域链" class="headerlink" title="函数的嵌套和作用域链"></a>函数的嵌套和作用域链</h3><h4 id="1-函数的嵌套调用"><a href="#1-函数的嵌套调用" class="headerlink" title="1.函数的嵌套调用"></a>1.函数的嵌套调用</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">def max(a,b):</span><br><span class="line">    return a if a&gt;b else b</span><br><span class="line"></span><br><span class="line">def the_max(x,y,z):  #函数的嵌套调用</span><br><span class="line">    c = max(x,y)</span><br><span class="line">    return max(c,z)</span><br><span class="line"></span><br><span class="line">print(the_max(1,2,3))</span><br></pre></td></tr></table></figure>
<h4 id="2-函数的嵌套定义"><a href="#2-函数的嵌套定义" class="headerlink" title="2.函数的嵌套定义"></a>2.函数的嵌套定义</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">def f1():</span><br><span class="line">    print(&quot;f1&quot;)</span><br><span class="line">    def f2():</span><br><span class="line">        print(&quot;f2&quot;)</span><br><span class="line">    f2()</span><br><span class="line"></span><br><span class="line">f1()</span><br></pre></td></tr></table></figure>
<h4 id="3-函数的作用域链"><a href="#3-函数的作用域链" class="headerlink" title="3.函数的作用域链"></a>3.函数的作用域链</h4><blockquote>
<p>初学让你疑惑的执行结果！！！ 尤其是你会js </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">def f1():</span><br><span class="line">    a = 1</span><br><span class="line">    def f2():</span><br><span class="line">        a = 2</span><br><span class="line">    f2()</span><br><span class="line">    print(&apos;a in f1 : &apos;,a)</span><br><span class="line"></span><br><span class="line">f1() # a in f1 :  1</span><br><span class="line"></span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line">f2中修改了 局部变量 a 的值</span><br><span class="line">但是 在 f1中a值仍然为 1 </span><br><span class="line"></span><br><span class="line">ps ： js里这个肯定是 2 </span><br><span class="line">&apos;&apos;&apos;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>原来python里要加 nonlocal 声明</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">def f1():</span><br><span class="line">    a = 1</span><br><span class="line">    def f2():</span><br><span class="line">        nonlocal a</span><br><span class="line">        a = 2</span><br><span class="line">    f2()</span><br><span class="line">    print(&apos;a in f1 : &apos;,a)</span><br><span class="line"></span><br><span class="line">f1() # a in f1 :  2</span><br></pre></td></tr></table></figure>
<blockquote>
<h4 id="nonlocal"><a href="#nonlocal" class="headerlink" title="nonlocal"></a>nonlocal</h4></blockquote>
<p>首先，要明确 nonlocal 关键字是定义在闭包里面的。请看以下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">x = 0</span><br><span class="line">def outer():</span><br><span class="line">    x = 1</span><br><span class="line">    def inner():</span><br><span class="line">        x = 2</span><br><span class="line">        print(&quot;inner:&quot;, x)</span><br><span class="line"></span><br><span class="line">    inner()</span><br><span class="line">    print(&quot;outer:&quot;, x)</span><br><span class="line"> </span><br><span class="line">outer()</span><br><span class="line">print(&quot;global:&quot;, x)</span><br><span class="line"></span><br><span class="line">结果：</span><br><span class="line">inner: 2</span><br><span class="line">outer: 1</span><br><span class="line">global: 0</span><br></pre></td></tr></table></figure>
<p>现在，在闭包里面加入nonlocal关键字进行声明：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">x = 0</span><br><span class="line">def outer():</span><br><span class="line">    x = 1</span><br><span class="line">    def inner():</span><br><span class="line">        nonlocal x</span><br><span class="line">        x = 2</span><br><span class="line">        print(&quot;inner:&quot;, x)</span><br><span class="line"></span><br><span class="line">    inner()</span><br><span class="line">    print(&quot;outer:&quot;, x)</span><br><span class="line"> </span><br><span class="line">outer()</span><br><span class="line">print(&quot;global:&quot;, x)</span><br><span class="line"></span><br><span class="line">结果：</span><br><span class="line">inner: 2</span><br><span class="line">outer: 2</span><br><span class="line">global: 0</span><br></pre></td></tr></table></figure>
<blockquote>
<h4 id="区别：一个函数里面嵌套了一个函数。当使用-nonlocal-时，就声明了该变量不只在嵌套函数inner（）里面才有效，-而是在整个大函数里面都有效。"><a href="#区别：一个函数里面嵌套了一个函数。当使用-nonlocal-时，就声明了该变量不只在嵌套函数inner（）里面才有效，-而是在整个大函数里面都有效。" class="headerlink" title="区别：一个函数里面嵌套了一个函数。当使用 nonlocal 时，就声明了该变量不只在嵌套函数inner（）里面才有效， 而是在整个大函数里面都有效。"></a>区别：一个函数里面嵌套了一个函数。当使用 nonlocal 时，就声明了该变量不只在嵌套函数inner（）里面才有效， 而是在整个大函数里面都有效。</h4></blockquote>
<p>我们在看 global</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">x = 0</span><br><span class="line">def outer():</span><br><span class="line">    x = 1</span><br><span class="line">    def inner():</span><br><span class="line">        global x</span><br><span class="line">        x = 2</span><br><span class="line">        print(&quot;inner:&quot;, x)</span><br><span class="line"></span><br><span class="line">    inner()</span><br><span class="line">    print(&quot;outer:&quot;, x)</span><br><span class="line"> </span><br><span class="line">outer()</span><br><span class="line">print(&quot;global:&quot;, x)</span><br><span class="line"></span><br><span class="line">结果：</span><br><span class="line">inner: 2</span><br><span class="line">outer: 1</span><br><span class="line">global: 2</span><br></pre></td></tr></table></figure>
<p>结论：global 是对整个环境下的变量起作用，而不是对函数类的变量起作用。</p>
<h4 id="4-函数的本质"><a href="#4-函数的本质" class="headerlink" title="4.函数的本质"></a>4.函数的本质</h4><ol>
<li><p>可以被引用</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">def func():</span><br><span class="line">    print(&apos;in func&apos;)</span><br><span class="line"></span><br><span class="line">f = func</span><br><span class="line">print(f)</span><br></pre></td></tr></table></figure>
</li>
<li><p>可以被当作容器类型的元素</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">def f1():</span><br><span class="line">    print(&apos;f1&apos;)</span><br><span class="line"></span><br><span class="line">def f2():</span><br><span class="line">    print(&apos;f2&apos;)</span><br><span class="line"></span><br><span class="line">def f3():</span><br><span class="line">    print(&apos;f3&apos;)</span><br><span class="line"></span><br><span class="line">l = [f1,f2,f3]</span><br><span class="line">d = &#123;&apos;f1&apos;:f1,&apos;f2&apos;:f2,&apos;f3&apos;:f3&#125;</span><br><span class="line">#调用</span><br><span class="line">l[0]()</span><br><span class="line">d[&apos;f2&apos;]()</span><br></pre></td></tr></table></figure>
</li>
<li><p>可以当作的参数和返回值</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">def func():</span><br><span class="line">    print(123)</span><br><span class="line"></span><br><span class="line">def wahaha(f):</span><br><span class="line">    f()</span><br><span class="line">    return f           #函数名可以作为函数的返回值</span><br><span class="line"></span><br><span class="line">qqxing = wahaha(func)   # 函数名可以作为函数的参数</span><br><span class="line">qqxing()</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="5-闭包"><a href="#5-闭包" class="headerlink" title="5.闭包"></a>5.闭包</h4><blockquote>
<p>嵌套函数，内部函数调用外部函数的变量</p>
</blockquote>
<ol>
<li><p>常用方式</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">def func():</span><br><span class="line">    name = &apos;eva&apos;</span><br><span class="line">    def inner():</span><br><span class="line">        print(name)</span><br><span class="line">    return inner</span><br><span class="line"></span><br><span class="line">f = func()</span><br><span class="line">f()</span><br></pre></td></tr></table></figure>
</li>
<li><p>判断闭包函数的方法 closure</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">#输出的__closure__有cell元素 ：是闭包函数</span><br><span class="line">def func():</span><br><span class="line">    name = &apos;eva&apos;</span><br><span class="line">    def inner():</span><br><span class="line">        print(name)</span><br><span class="line">    print(inner.__closure__)</span><br><span class="line">    return inner</span><br><span class="line"></span><br><span class="line">f = func()</span><br><span class="line">f()</span><br><span class="line"></span><br><span class="line">结果：</span><br><span class="line">(&lt;cell at 0x0000000001ECA4C8: str object at 0x0000000001DCB1B8&gt;,)</span><br><span class="line">eva</span><br><span class="line">-------------------------华丽的分割线--------------------------------------------------------------</span><br><span class="line">#输出的__closure__为None ：不是闭包函数</span><br><span class="line">name = &apos;egon&apos;</span><br><span class="line">def func2():</span><br><span class="line">    def inner():</span><br><span class="line">        print(name)</span><br><span class="line">    print(inner.__closure__)</span><br><span class="line">    return inner</span><br><span class="line"></span><br><span class="line">f2 = func2()</span><br><span class="line">f2()</span><br><span class="line"></span><br><span class="line">结果：</span><br><span class="line">None</span><br><span class="line">egon</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>闭包嵌套</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">def wrapper():</span><br><span class="line">    money = 1000</span><br><span class="line">    def func():</span><br><span class="line">        name = &apos;eva&apos;</span><br><span class="line">        def inner():</span><br><span class="line">            print(name,money)</span><br><span class="line">        return inner</span><br><span class="line">    return func</span><br><span class="line"></span><br><span class="line">f = wrapper()</span><br><span class="line">i = f()</span><br><span class="line">i()</span><br><span class="line"></span><br><span class="line">结果：</span><br><span class="line">eva 1000</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>闭包函数获取网络应用</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">from urllib.request import urlopen</span><br><span class="line"></span><br><span class="line">def index():</span><br><span class="line">    url = &quot;http://www.xiaohua100.cn/index.html&quot;</span><br><span class="line">    def get():</span><br><span class="line">        return urlopen(url).read()</span><br><span class="line">    return get</span><br><span class="line"></span><br><span class="line">xiaohua = index()</span><br><span class="line">content = xiaohua()</span><br><span class="line">print(content)</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/07/23/P010_01_python命名空间和作用域/" data-id="cklhjp22e00ceulfyqngnqm65" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/fullstack/">fullstack</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/41/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/40/">40</a><a class="page-number" href="/page/41/">41</a><span class="page-number current">42</span><a class="page-number" href="/page/43/">43</a><a class="page-number" href="/page/44/">44</a><span class="space">&hellip;</span><a class="page-number" href="/page/55/">55</a><a class="extend next" rel="next" href="/page/43/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS/">CSS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ES6速学/">ES6速学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JS不知深浅/">JS不知深浅</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M01/">M01</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M02/">M02</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M03/">M03</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M04/">M04</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M06/">M06</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M07/">M07</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M08/">M08</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M09/">M09</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NodeWeb/">NodeWeb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Node后端/">Node后端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ReactWheels/">ReactWheels</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React入门/">React入门</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TS入门/">TS入门</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/express/">express</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fullstack/">fullstack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/http/">http</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jQuery/">jQuery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mobile/">mobile</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/">mongodb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node/">node</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node每日精进/">node每日精进</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/oak/">oak</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tools/">tools</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vim/">vim</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vue/">vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vultr/">vultr</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web性能优化/">web性能优化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web面经/">web面经</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端知识点/">前端知识点</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/CSS/" style="font-size: 13.91px;">CSS</a> <a href="/tags/ES6速学/" style="font-size: 14.35px;">ES6速学</a> <a href="/tags/JS不知深浅/" style="font-size: 11.3px;">JS不知深浅</a> <a href="/tags/M01/" style="font-size: 13.48px;">M01</a> <a href="/tags/M02/" style="font-size: 15.22px;">M02</a> <a href="/tags/M03/" style="font-size: 15.65px;">M03</a> <a href="/tags/M04/" style="font-size: 16.09px;">M04</a> <a href="/tags/M06/" style="font-size: 18.26px;">M06</a> <a href="/tags/M07/" style="font-size: 17.83px;">M07</a> <a href="/tags/M08/" style="font-size: 16.96px;">M08</a> <a href="/tags/M09/" style="font-size: 11.74px;">M09</a> <a href="/tags/NodeWeb/" style="font-size: 15.65px;">NodeWeb</a> <a href="/tags/Node后端/" style="font-size: 18.7px;">Node后端</a> <a href="/tags/ReactWheels/" style="font-size: 16.52px;">ReactWheels</a> <a href="/tags/React入门/" style="font-size: 15.22px;">React入门</a> <a href="/tags/TS入门/" style="font-size: 14.78px;">TS入门</a> <a href="/tags/express/" style="font-size: 10.43px;">express</a> <a href="/tags/fullstack/" style="font-size: 17.83px;">fullstack</a> <a href="/tags/http/" style="font-size: 12.17px;">http</a> <a href="/tags/jQuery/" style="font-size: 10px;">jQuery</a> <a href="/tags/java/" style="font-size: 19.13px;">java</a> <a href="/tags/linux/" style="font-size: 10.87px;">linux</a> <a href="/tags/mobile/" style="font-size: 11.3px;">mobile</a> <a href="/tags/mongodb/" style="font-size: 12.61px;">mongodb</a> <a href="/tags/mysql/" style="font-size: 12.61px;">mysql</a> <a href="/tags/node/" style="font-size: 10.43px;">node</a> <a href="/tags/node每日精进/" style="font-size: 10px;">node每日精进</a> <a href="/tags/oak/" style="font-size: 20px;">oak</a> <a href="/tags/python/" style="font-size: 17.39px;">python</a> <a href="/tags/tools/" style="font-size: 10px;">tools</a> <a href="/tags/vim/" style="font-size: 10px;">vim</a> <a href="/tags/vue/" style="font-size: 13.04px;">vue</a> <a href="/tags/vultr/" style="font-size: 10px;">vultr</a> <a href="/tags/web性能优化/" style="font-size: 10px;">web性能优化</a> <a href="/tags/web面经/" style="font-size: 10px;">web面经</a> <a href="/tags/前端知识点/" style="font-size: 19.57px;">前端知识点</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/02/23/Node-web05-09-03博客系统使用nginx/">Node-web05-09-03博客系统使用nginx</a>
          </li>
        
          <li>
            <a href="/2021/02/22/Node-web05-09-02博客系统部署最新版流程/">Node-web05-09-02博客系统部署最新版流程</a>
          </li>
        
          <li>
            <a href="/2021/02/20/Node-web05-09-01博客统部署2/">Node-web05-09-01博客统部署优化解释</a>
          </li>
        
          <li>
            <a href="/2021/02/20/Node-web05-08博客统页面完善/">Node-web05-08博客统页面完善</a>
          </li>
        
          <li>
            <a href="/2021/02/19/Node-web05-07-03服务器端构建/">Node-web05-07-03服务器端构建</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 Stevin<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>