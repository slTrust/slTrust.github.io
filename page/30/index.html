<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  

  
  <title>Almost</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Almost">
<meta property="og:url" content="http://yoursite.com/page/30/index.html">
<meta property="og:site_name" content="Almost">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Almost">
  
    <link rel="alternate" href="/atom.xml" title="Almost" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Almost</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-Py007-01-06requests综合实战" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/30/Py007-01-06requests综合实战/" class="article-date">
  <time datetime="2018-11-30T13:08:18.000Z" itemprop="datePublished">2018-11-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/30/Py007-01-06requests综合实战/">Py007-01-06requests综合实战</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="综合项目实战"><a href="#综合项目实战" class="headerlink" title="综合项目实战"></a>综合项目实战</h3><ul>
<li>需求：爬取搜狗知乎某一个词条对应一定范围页码表示的页面数据</li>
</ul>
<blockquote>
<p>分析网址</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"># 原始url</span><br><span class="line">baseUrl = &apos;https://zhihu.sogou.com/zhihu?query=%E9%92%89%E9%92%89&amp;ie=utf8&amp;w=&amp;oq=dd&amp;ri=1&amp;sourceid=sugg&amp;stj=1%3B0%3B0%3B0&amp;stj2=0&amp;stj0=1&amp;stj1=0&amp;hp=0&amp;hp1=&amp;sut=1909&amp;sst0=1543542920653&amp;lkt=3%2C1543542918642%2C1543542920549&apos;</span><br><span class="line"></span><br><span class="line"># 移除get参数的url</span><br><span class="line">url2 = &apos;https://zhihu.sogou.com/zhihu&apos;</span><br><span class="line"></span><br><span class="line"># get 参数 = &apos;query=%E9%92%89%E9%92%89&amp;ie=utf8&amp;w=&amp;oq=dd&amp;ri=1&amp;sourceid=sugg&amp;stj=1%3B0%3B0%3B0&amp;stj2=0&amp;stj0=1&amp;stj1=0&amp;hp=0&amp;hp1=&amp;sut=1909&amp;sst0=1543542920653&amp;lkt=3%2C1543542918642%2C1543542920549&apos;</span><br><span class="line">params = &#123;</span><br><span class="line">    query: 钉钉</span><br><span class="line">    ie: utf8</span><br><span class="line">    w: </span><br><span class="line">    oq: dd</span><br><span class="line">    ri: 1</span><br><span class="line">    sourceid: sugg</span><br><span class="line">    stj: 1;0;0;0</span><br><span class="line">    stj2: 0</span><br><span class="line">    stj0: 1</span><br><span class="line">    stj1: 0</span><br><span class="line">    hp: 0</span><br><span class="line">    hp1: </span><br><span class="line">    sut: 1909</span><br><span class="line">    sst0: 1543542920653</span><br><span class="line">    lkt: 3,1543542918642,1543542920549</span><br><span class="line">&#125;</span><br><span class="line"># 移除无用参数</span><br><span class="line">params = &#123;</span><br><span class="line">    &apos;query&apos;: 搜索词,</span><br><span class="line">    &apos;page&apos;: 页码,</span><br><span class="line">    &apos;ie&apos;: &apos;utf-8&apos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>代码实现</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"># 前三页页面数据（1，2，3）</span><br><span class="line">import requests</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line"># 创建一个文件夹</span><br><span class="line">if not os.path.exists(&apos;./pages&apos;):</span><br><span class="line">    os.mkdir(&apos;./pages&apos;)</span><br><span class="line"></span><br><span class="line">word = input(&apos;enter a word:&apos;)</span><br><span class="line"></span><br><span class="line"># 动态指定页码的范围</span><br><span class="line">start_pageNum = int(input(&apos;enter a start pageNum:&apos;))</span><br><span class="line">end_pageNum = int(input(&apos;enter a end pageNum:&apos;))</span><br><span class="line"># 自定义请求头信息</span><br><span class="line">headers = &#123;</span><br><span class="line">    &apos;User-Agent&apos;: &apos;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36&apos;,</span><br><span class="line">&#125;</span><br><span class="line"># 1.指定url:设计成一个具有通用的url</span><br><span class="line"></span><br><span class="line"># 请求url</span><br><span class="line">url = &apos;https://zhihu.sogou.com/zhihu&apos;</span><br><span class="line">for page in range(start_pageNum, end_pageNum + 1):</span><br><span class="line">    param = &#123;</span><br><span class="line">        &apos;query&apos;: word,</span><br><span class="line">        &apos;page&apos;: page,</span><br><span class="line">        &apos;ie&apos;: &apos;utf-8&apos;</span><br><span class="line">    &#125;</span><br><span class="line">    response = requests.get(url=url, params=param, headers=headers)</span><br><span class="line"></span><br><span class="line">    # 获取响应中的页面数据（指定页码（page））</span><br><span class="line">    page_text = response.text</span><br><span class="line"></span><br><span class="line">    # 进行持久化存储</span><br><span class="line">    fileName = word + str(page) + &apos;.html&apos;</span><br><span class="line">    filePath = &apos;pages/&apos; + fileName</span><br><span class="line">    with open(filePath, &apos;w&apos;, encoding=&apos;utf-8&apos;) as fp:</span><br><span class="line">        fp.write(page_text)</span><br><span class="line">        print(&apos;第%d页数据写入成功&apos; % page)</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/11/30/Py007-01-06requests综合实战/" data-id="cklhgn2hd00izkyfy4zuo4t3d" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/M07/">M07</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Py007-01-05requests模块之post和ajax" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/29/Py007-01-05requests模块之post和ajax/" class="article-date">
  <time datetime="2018-11-29T15:52:05.000Z" itemprop="datePublished">2018-11-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/29/Py007-01-05requests模块之post和ajax/">Py007-01-05requests模块之post和ajax</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="requests模块之post请求"><a href="#requests模块之post请求" class="headerlink" title="requests模块之post请求"></a>requests模块之post请求</h3><blockquote>
<p>简单需求，登录豆瓣网，获取成功后的数据</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line"># 1.post请求的url</span><br><span class="line">url = &apos;https://accounts.douban.com/login&apos;</span><br><span class="line"></span><br><span class="line"># 封装post请求参数数据</span><br><span class="line">data = &#123;</span><br><span class="line">    &quot;source&quot;:&apos;movie&apos;,</span><br><span class="line">    &apos;redir&apos;:&apos;https://movie.douban.com/&apos;,</span><br><span class="line">    &apos;form_email&apos;:&apos;15027900535&apos;,</span><br><span class="line">    &apos;form_password&apos;:&apos;bobo@15027900535&apos;,</span><br><span class="line">    &apos;login&apos;:&apos;登录&apos;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#自定义请求头信息</span><br><span class="line">headers=&#123;</span><br><span class="line">    &apos;User-Agent&apos;: &apos;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36&apos;,</span><br><span class="line">&#125;</span><br><span class="line"># 2 发起post请求</span><br><span class="line">response = requests.post(url=url,data=data,headers=headers)</span><br><span class="line"></span><br><span class="line"># 3 获取响应对象中的页面数据</span><br><span class="line">page_text = response.text</span><br><span class="line"></span><br><span class="line"># 4 持久化存储</span><br><span class="line">with open(&apos;movie.html&apos;,&apos;w&apos;,encoding=&apos;utf-8&apos;) as f:</span><br><span class="line">    f.write(page_text)</span><br></pre></td></tr></table></figure>
<h3 id="ajax的请求"><a href="#ajax的请求" class="headerlink" title="ajax的请求"></a>ajax的请求</h3><h4 id="基于ajax的get请求"><a href="#基于ajax的get请求" class="headerlink" title="基于ajax的get请求"></a>基于ajax的get请求</h4><blockquote>
<p>抓取豆瓣电影首页-排行榜-某一分类的电影的下拉加载数据</p>
</blockquote>
<ul>
<li>排行榜 <a href="https://movie.douban.com/chart" target="_blank" rel="noopener">https://movie.douban.com/chart</a></li>
<li>喜剧分类 <a href="https://movie.douban.com/typerank?type_name=%E5%96%9C%E5%89%A7&amp;type=24&amp;interval_id=100:90&amp;action=" target="_blank" rel="noopener">https://movie.douban.com/typerank?type_name=%E5%96%9C%E5%89%A7&amp;type=24&amp;interval_id=100:90&amp;action=</a></li>
<li>下拉加载的动态数据接口 <a href="https://movie.douban.com/j/chart/top_list?type=24&amp;interval_id=100%3A90&amp;action=&amp;start=40&amp;limit=20" target="_blank" rel="noopener">https://movie.douban.com/j/chart/top_list?type=24&amp;interval_id=100%3A90&amp;action=&amp;start=40&amp;limit=20</a></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line"># 原始url</span><br><span class="line"># baseurl = &apos;https://movie.douban.com/j/chart/top_list?type=24&amp;interval_id=100%3A90&amp;action=&amp;start=40&amp;limit=20&apos;</span><br><span class="line"></span><br><span class="line"># 指定url</span><br><span class="line">url = &apos;https://movie.douban.com/j/chart/top_list&apos;</span><br><span class="line"></span><br><span class="line"># 封装ajax中  get参数</span><br><span class="line">params = &#123;</span><br><span class="line">    &apos;type&apos;:24,</span><br><span class="line">    &apos;interval_id&apos;:&apos;100:90&apos;,</span><br><span class="line">    &apos;action&apos;:&apos;&apos;,</span><br><span class="line">    &apos;start&apos;:40,</span><br><span class="line">    &apos;limit&apos;:20</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 自定义请求头信息</span><br><span class="line">headers=&#123;</span><br><span class="line">    &apos;User-Agent&apos;: &apos;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36&apos;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response = requests.get(url=url,params=params,headers=headers)</span><br><span class="line"></span><br><span class="line">print(response.text)</span><br></pre></td></tr></table></figure>
<h4 id="基于ajax的post请求"><a href="#基于ajax的post请求" class="headerlink" title="基于ajax的post请求"></a>基于ajax的post请求</h4><p>获取肯德基城市餐厅位置数据</p>
<ul>
<li>肯德基官网 <a href="http://www.kfc.com.cn/kfccda/index.aspx" target="_blank" rel="noopener">http://www.kfc.com.cn/kfccda/index.aspx</a></li>
<li>餐厅位置查询页面 <a href="http://www.kfc.com.cn/kfccda/storelist/index.aspx" target="_blank" rel="noopener">http://www.kfc.com.cn/kfccda/storelist/index.aspx</a></li>
<li>搜索查询 北京 餐厅列表  看浏览器里的network里的抓包信息 获得url = <a href="http://www.kfc.com.cn/kfccda/ashx/GetStoreList.ashx?op=keyword" target="_blank" rel="noopener">http://www.kfc.com.cn/kfccda/ashx/GetStoreList.ashx?op=keyword</a></li>
<li>餐厅列表有分页但是是  post的 继续分析他的请求参数</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">http://www.kfc.com.cn/kfccda/ashx/GetStoreList.ashx?op=keyword</span><br><span class="line"></span><br><span class="line">参数</span><br><span class="line">cname: </span><br><span class="line">pid: </span><br><span class="line">keyword: 上海</span><br><span class="line">pageIndex: 2</span><br><span class="line">pageSize: 10</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = &apos;http://www.kfc.com.cn/kfccda/ashx/GetStoreList.ashx?op=keyword&apos;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 封装ajax中  post参数</span><br><span class="line">data = &#123;</span><br><span class="line">    &apos;cname&apos;:&apos;&apos;,</span><br><span class="line">    &apos;pid&apos;:&apos;&apos;,</span><br><span class="line">    &apos;keyword&apos;: &apos;上海&apos;,</span><br><span class="line">    &apos;pageIndex&apos;:2,</span><br><span class="line">    &apos;pageSize&apos;:10</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#自定义请求头信息</span><br><span class="line">headers=&#123;</span><br><span class="line">    &apos;User-Agent&apos;: &apos;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36&apos;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response = requests.post(url=url,data=data,headers=headers)</span><br><span class="line"></span><br><span class="line">print(response.text)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>结论</p>
</blockquote>
<ul>
<li>如果使用requests发起ajax请求 跟普通get/post请求是一样的</li>
<li>无法通过地址栏请求，通过浏览器开发者工具抓包信息获取请求的url</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/11/29/Py007-01-05requests模块之post和ajax/" data-id="cklhgn2hm00jkkyfy0hq6fulc" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/M07/">M07</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Py007-01-04requests模块" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/29/Py007-01-04requests模块/" class="article-date">
  <time datetime="2018-11-29T15:09:15.000Z" itemprop="datePublished">2018-11-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/29/Py007-01-04requests模块/">Py007-01-04requests模块</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="requests模块"><a href="#requests模块" class="headerlink" title="requests模块"></a>requests模块</h3><ul>
<li>什么是requests模块</li>
</ul>
<p>requests模块是python中原生的基于网络请求的模块，其主要作用是用来模拟浏览器发起请求。功能强大，用法简洁高效。在爬虫领域中占据着半壁江山的地位。</p>
<ul>
<li>为什么要使用requests模块</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&gt; 因为在使用urllib模块的时候，会有诸多不便之处，总结如下：</span><br><span class="line">    1 手动处理url编码</span><br><span class="line">    2 手动处理post请求参数</span><br><span class="line">    3 处理cookie和代理操作繁琐</span><br><span class="line">        &gt; cookie</span><br><span class="line">        - 创建一个cookiejar对象</span><br><span class="line">        - 创建一个handler对象</span><br><span class="line">        - 创建一个opener对象</span><br><span class="line"></span><br><span class="line">        &gt; 代理</span><br><span class="line">        - 创建handler对象，代理ip和端口封装到该对象</span><br><span class="line">        - 创建opener对象</span><br><span class="line"></span><br><span class="line">&gt; 使用requests模块：</span><br><span class="line">    - 自动处理url编码</span><br><span class="line">    - 自动处理post请求参数</span><br><span class="line">    - 大大简化cookie和代理操作</span><br><span class="line">    。。。</span><br></pre></td></tr></table></figure>
<h4 id="requests如何使用"><a href="#requests如何使用" class="headerlink" title="requests如何使用"></a>requests如何使用</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 安装</span><br><span class="line">pip install requests</span><br></pre></td></tr></table></figure>
<blockquote>
<p>使用流程</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. 指定url</span><br><span class="line">2. 使用requests模块发请求</span><br><span class="line">3. 获取响应数据</span><br><span class="line">4. 进行持久化存储</span><br></pre></td></tr></table></figure>
<h4 id="通过5个基于requests模块的爬虫项目对该模块进行系统的学习和巩固"><a href="#通过5个基于requests模块的爬虫项目对该模块进行系统的学习和巩固" class="headerlink" title="通过5个基于requests模块的爬虫项目对该模块进行系统的学习和巩固"></a>通过5个基于requests模块的爬虫项目对该模块进行系统的学习和巩固</h4><ul>
<li>get</li>
<li>post</li>
<li>ajax的get</li>
<li>ajax的post</li>
<li>综合</li>
</ul>
<h4 id="get请求"><a href="#get请求" class="headerlink" title="get请求"></a>get请求</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line"># 指定url</span><br><span class="line">url = &apos;https://www.sogou.com/&apos;</span><br><span class="line"></span><br><span class="line"># 发get请求,get方法会返回请求成功的响应内容</span><br><span class="line">response = requests.get(url=url)</span><br><span class="line"></span><br><span class="line"># 获取响应中的数据值：text可以获取响应对象中字符串形式的页面数据</span><br><span class="line">page_data = response.text</span><br><span class="line"></span><br><span class="line">print(page_data)</span><br><span class="line"></span><br><span class="line"># 持久化存储</span><br><span class="line">with open(&apos;./sogou.html&apos;,&apos;w&apos;,encoding=&apos;utf-8&apos;) as fp:</span><br><span class="line">    fp.write(page_data)</span><br></pre></td></tr></table></figure>
<h4 id="requests其他常用属性"><a href="#requests其他常用属性" class="headerlink" title="requests其他常用属性"></a>requests其他常用属性</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = &apos;https://www.sogou.com/&apos;</span><br><span class="line"></span><br><span class="line">response = requests.get(url=url)</span><br><span class="line"></span><br><span class="line">page_data = response.text</span><br><span class="line"># 获取响应对象中二进制(byte)类型的数据</span><br><span class="line">print(response.content)</span><br><span class="line"></span><br><span class="line"># 返回响应的状态码 </span><br><span class="line">print(response.status_code)</span><br><span class="line"></span><br><span class="line"># 获取响应的头信息(字典的形式)</span><br><span class="line">print(response.headers)</span><br><span class="line"></span><br><span class="line"># 获取请求的url</span><br><span class="line">print(response.url)</span><br></pre></td></tr></table></figure>
<h4 id="request携带参数的get请求方式一"><a href="#request携带参数的get请求方式一" class="headerlink" title="request携带参数的get请求方式一"></a>request携带参数的get请求方式一</h4><blockquote>
<p>获取搜狗搜索结果对应的界面数据爬取 </p>
</blockquote>
<p>获取周杰伦对应的搜狗页面</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = &apos;https://www.sogou.com/web?query=周杰伦&amp;ie=utf-8&apos;</span><br><span class="line"></span><br><span class="line">response = requests.get(url=url)</span><br><span class="line"></span><br><span class="line">page_text = response.text</span><br><span class="line"></span><br><span class="line">with open(&apos;./zhou.html&apos;,&apos;w&apos;,encoding=&apos;utf-8&apos;) as f:</span><br><span class="line">    f.write(page_text)</span><br></pre></td></tr></table></figure>
<p>此时url里的中文参数无需手动处理(urllib需要手动处理)</p>
<h4 id="request携带参数的get请求方式二"><a href="#request携带参数的get请求方式二" class="headerlink" title="request携带参数的get请求方式二"></a>request携带参数的get请求方式二</h4><ul>
<li>params参数(字典的形势传递get参数)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line"># get请求方式二</span><br><span class="line">url = &apos;https://www.sogou.com/web&apos;</span><br><span class="line"></span><br><span class="line"># 将参数封装到字典里</span><br><span class="line">params = &#123;</span><br><span class="line">    &apos;query&apos;:&apos;周杰伦&apos;,</span><br><span class="line">    &apos;ie&apos;:&apos;utf-8&apos;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response = requests.get(url=url,params=params)</span><br><span class="line"></span><br><span class="line">page_text = response.text</span><br><span class="line"></span><br><span class="line">print(page_text)</span><br></pre></td></tr></table></figure>
<h4 id="requests之自定义请求头信息"><a href="#requests之自定义请求头信息" class="headerlink" title="requests之自定义请求头信息"></a>requests之自定义请求头信息</h4><ul>
<li>headers 请求头参数</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = &apos;https://www.sogou.com/&apos;</span><br><span class="line"></span><br><span class="line">#自定义请求头信息</span><br><span class="line">headers=&#123;</span><br><span class="line">    &apos;User-Agent&apos;: &apos;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36&apos;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 将参数封装到字典里</span><br><span class="line">params = &#123;</span><br><span class="line">    &apos;query&apos;:&apos;周杰伦&apos;,</span><br><span class="line">    &apos;ie&apos;:&apos;utf-8&apos;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response = requests.get(url=url,params=params,headers=headers)</span><br><span class="line"></span><br><span class="line">print(response.text)</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/11/29/Py007-01-04requests模块/" data-id="cklhgn2hd00ixkyfyd22uydbp" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/M07/">M07</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Py007-01-03内置urllib模块补充" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/29/Py007-01-03内置urllib模块补充/" class="article-date">
  <time datetime="2018-11-29T14:59:14.000Z" itemprop="datePublished">2018-11-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/29/Py007-01-03内置urllib模块补充/">Py007-01-03内置urllib模块补充</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="urllib补充"><a href="#urllib补充" class="headerlink" title="urllib补充"></a>urllib补充</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># 补充说明：</span><br><span class="line">urlopen函数原型：</span><br><span class="line">    urllib.request.urlopen(url, data=None, timeout=&lt;object object at 0x10af327d0&gt;, *, cafile=None, capath=None, cadefault=False, context=None)</span><br><span class="line"></span><br><span class="line">在上一节中我们只使用了该函数中的第一个参数url。在日常开发中，我们能用的只有url和data这两个参数。</span><br><span class="line"></span><br><span class="line">url参数：指定向哪个url发起请求</span><br><span class="line">data参数：可以将post请求中携带的参数封装成字典的形式传递给该参数</span><br><span class="line"></span><br><span class="line">urlopen函数返回的响应对象，相关函数调用介绍：</span><br><span class="line">response.headers()：获取响应头信息</span><br><span class="line">response.getcode()：获取响应状态码</span><br><span class="line">response.geturl()：获取请求的url</span><br><span class="line">response.read()：获取响应中的数据值（字节类型）</span><br></pre></td></tr></table></figure>
<h4 id="二进制数据的爬取"><a href="#二进制数据的爬取" class="headerlink" title="二进制数据的爬取"></a>二进制数据的爬取</h4><blockquote>
<p>爬取网络上的某张图片数据，且存储到磁盘</p>
</blockquote>
<ul>
<li>方法 1：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import urllib.request</span><br><span class="line">import urllib.parse</span><br><span class="line"></span><br><span class="line">#1.指定url</span><br><span class="line">url = &apos;https://pic.qiushibaike.com/system/pictures/12112/121121212/medium/ZOAND29U4NKNEWEF.jpg&apos;</span><br><span class="line">#2.发起请求:使用urlopen函数发起请求，该函数返回一个响应对象</span><br><span class="line">response = urllib.request.urlopen(url=url)</span><br><span class="line">#3.获取响应对象中的图片二进制类型的数据</span><br><span class="line">img_data = response.read()</span><br><span class="line">#4.持久化存储：将爬取的图片写入本地进行保存</span><br><span class="line">with open(&apos;./tupian.png&apos;,&apos;wb&apos;) as fp:</span><br><span class="line">    fp.write(img_data)</span><br></pre></td></tr></table></figure>
<ul>
<li>方法 2：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import urllib.request</span><br><span class="line">import urllib.parse</span><br><span class="line"></span><br><span class="line">url = &apos;https://pic.qiushibaike.com/system/pictures/12112/121121212/medium/ZOAND29U4NKNEWEF.jpg&apos;</span><br><span class="line"># 函数原型：urllib.request.urlretrieve(url, filename=None)</span><br><span class="line"># 作用：对url发起请求，且将响应中的数据值写入磁盘进行存储</span><br><span class="line">urllib.request.urlretrieve(url=url,filename=&apos;./img.png&apos;)</span><br></pre></td></tr></table></figure>
<h4 id="url的特性"><a href="#url的特性" class="headerlink" title="url的特性"></a>url的特性</h4><p>url必须为ASCII编码的数据值。所以我们在爬虫代码中编写url时，如果url中存在非ASCII编码的数据值，则必须对其进行ASCII编码后，该url方可被使用。</p>
<blockquote>
<p>案例：爬取使用搜狗根据指定词条搜索到的页面数据（例如爬取词条为‘周杰伦’的页面数据）</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import urllib.request</span><br><span class="line">import urllib.parse</span><br><span class="line">url = &apos;https://www.sogou.com/web?query=周杰伦&apos;</span><br><span class="line">response = urllib.request.urlopen(url=url)</span><br><span class="line">data = response.read()</span><br><span class="line">with open(&apos;./周杰伦.html&apos;,&apos;wb&apos;) as fp:</span><br><span class="line">    fp.write(data)</span><br><span class="line">print(&apos;写入文件完毕&apos;)</span><br></pre></td></tr></table></figure>
<p>【注意】上述代码中url存在非ascii编码的数据，则该url无效。如果对其发起请求，则会报如下错误：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UnicodeEncodeError: &apos;ascii&apos; codec can&apos;t encode characters in position 15-17: ordinal not in range</span><br></pre></td></tr></table></figure>
<blockquote>
<p>所以必须对url中的非ascii的数据进行ascii的编码，则该url方可被发起请求：</p>
</blockquote>
<ul>
<li>方法 1：使用quote函数</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import urllib.request</span><br><span class="line">import urllib.parse</span><br><span class="line">url = &apos;https://www.sogou.com/web?query=%s&apos;</span><br><span class="line">#对url中的非ascii进行编码.quote函数可以对非ascii的数据值进行ascii的编码</span><br><span class="line">word = urllib.parse.quote(&apos;周杰伦&apos;)</span><br><span class="line">#将编码后的数据值拼接回url中</span><br><span class="line">url = format(url%word)</span><br><span class="line">response = urllib.request.urlopen(url=url)</span><br><span class="line">data = response.read()</span><br><span class="line">with open(&apos;./周杰伦.html&apos;,&apos;wb&apos;) as fp:</span><br><span class="line">    fp.write(data)</span><br><span class="line">print(&apos;写入文件完毕&apos;)</span><br></pre></td></tr></table></figure>
<ul>
<li>方法2： 使用urlencode函数</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import urllib.request</span><br><span class="line">import urllib.parse</span><br><span class="line">url = &apos;https://www.sogou.com/web?&apos;</span><br><span class="line">#将get请求中url携带的参数封装至字典中</span><br><span class="line">param = &#123;</span><br><span class="line">    &apos;query&apos;:&apos;周杰伦&apos;</span><br><span class="line">&#125;</span><br><span class="line">#对url中的非ascii进行编码</span><br><span class="line">param = urllib.parse.urlencode(param)</span><br><span class="line">#将编码后的数据值拼接回url中</span><br><span class="line">url += param </span><br><span class="line">response = urllib.request.urlopen(url=url)</span><br><span class="line">data = response.read()</span><br><span class="line">with open(&apos;./周杰伦1.html&apos;,&apos;wb&apos;) as fp:</span><br><span class="line">    fp.write(data)</span><br><span class="line">print(&apos;写入文件完毕&apos;)</span><br></pre></td></tr></table></figure>
<h4 id="通过自定义请求对象，用于伪装爬虫程序请求的身份。"><a href="#通过自定义请求对象，用于伪装爬虫程序请求的身份。" class="headerlink" title="通过自定义请求对象，用于伪装爬虫程序请求的身份。"></a>通过自定义请求对象，用于伪装爬虫程序请求的身份。</h4><p>之前在讲解http常用请求头信息时，我们讲解过User-Agent参数，简称为UA，该参数的作用是用于表明本次请求载体的身份标识。如果我们通过浏览器发起的请求，则该请求的载体为当前浏览器，则UA参数的值表明的是当前浏览器的身份标识表示的一串数据。如果我们使用爬虫程序发起的一个请求，则该请求的载体为爬虫程序，那么该请求的UA为爬虫程序的身份标识表示的一串数据。有些网站会通过辨别请求的UA来判别该请求的载体是否为爬虫程序，如果为爬虫程序，则不会给该请求返回响应，那么我们的爬虫程序则也无法通过请求爬取到该网站中的数据值，这也是反爬虫的一种初级技术手段。那么为了防止该问题的出现，则我们可以给爬虫程序的UA进行伪装，伪装成某款浏览器的身份标识。</p>
<p>上述案例中，我们是通过request模块中的urlopen发起的请求，该请求对象为urllib中内置的默认请求对象，我们无法对其进行UA进行更改操作。urllib还为我们提供了一种自定义请求对象的方式，我们可以通过自定义请求对象的方式，给该请求对象中的UA进行伪装（更改）操作。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">import urllib.request</span><br><span class="line">import urllib.parse</span><br><span class="line">url = &apos;https://www.sogou.com/web?&apos;</span><br><span class="line">#将get请求中url携带的参数封装至字典中</span><br><span class="line">param = &#123;</span><br><span class="line">    &apos;query&apos;:&apos;周杰伦&apos;</span><br><span class="line">&#125;</span><br><span class="line">#对url中的非ascii进行编码</span><br><span class="line">param = urllib.parse.urlencode(param)</span><br><span class="line">#将编码后的数据值拼接回url中</span><br><span class="line">url += param </span><br><span class="line"></span><br><span class="line">#封装自定义的请求头信息的字典：</span><br><span class="line">#将浏览器的UA数据获取，封装到一个字典中。该UA值可以通过抓包工具或者浏览器自带的开发者工具中获取某请求，从中获取UA的值</span><br><span class="line">#注意：在headers字典中可以封装任意的请求头信息</span><br><span class="line">headers=&#123;</span><br><span class="line">    &apos;User-Agent&apos; : &apos;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36&apos;</span><br><span class="line">    &#125;</span><br><span class="line">#自定义请求对象，可以在该请求对象中添加自定义的请求头信息</span><br><span class="line">request = urllib.request.Request(url=url,headers=headers)</span><br><span class="line">#使用自定义请求对象发起请求</span><br><span class="line">response = urllib.request.urlopen(request)</span><br><span class="line">data = response.read()</span><br><span class="line">with open(&apos;./周杰伦.html&apos;,&apos;wb&apos;) as fp:</span><br><span class="line">    fp.write(data)</span><br><span class="line">print(&apos;写入文件完毕&apos;)</span><br></pre></td></tr></table></figure>
<h4 id="携带参数的post请求"><a href="#携带参数的post请求" class="headerlink" title="携带参数的post请求"></a>携带参数的post请求</h4><blockquote>
<p>案例：百度翻译发起post请求</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import urllib.request</span><br><span class="line">import urllib.parse</span><br><span class="line">#通过抓包工具抓取post请求的url</span><br><span class="line">post_url=&apos;https://fanyi.baidu.com/sug&apos;</span><br><span class="line">#封装post请求参数</span><br><span class="line">data=&#123;</span><br><span class="line">    &quot;kw&quot;:&quot;dog&quot;</span><br><span class="line">&#125;</span><br><span class="line">data=urllib.parse.urlencode(data)</span><br><span class="line">#自定义请求头信息字典</span><br><span class="line">headers=&#123;</span><br><span class="line">    &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.87 Safari/537.36&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#自定义请求对象，然后将封装好的post请求参数赋值给Requst方法的data参数。</span><br><span class="line">#data参数：用来存储post请求的参数</span><br><span class="line">request=urllib.request.Request(post_url,data=data.encode(),headers=headers)</span><br><span class="line">#自定义的请求对象中的参数（data必须为bytes类型）</span><br><span class="line">response=urllib.request.urlopen(request)</span><br><span class="line">response.read()</span><br></pre></td></tr></table></figure>
<h3 id="urllib模块的高级操作"><a href="#urllib模块的高级操作" class="headerlink" title="urllib模块的高级操作"></a>urllib模块的高级操作</h3><blockquote>
<ol>
<li>代理</li>
</ol>
</blockquote>
<ul>
<li><p>什么是代理：代理就是第三方代替本体处理相关事务。例如：生活中的代理：代购，中介，微商……</p>
</li>
<li><p>爬虫中为什么需要使用代理？</p>
<blockquote>
<p>一些网站会有相应的反爬虫措施，例如很多网站会检测某一段时间某个IP的访问次数，如果访问频率太快以至于看起来不像正常访客，它可能就会会禁止这个IP的访问。所以我们需要设置一些代理IP，每隔一段时间换一个代理IP，就算IP被禁止，依然可以换个IP继续爬取。</p>
</blockquote>
</li>
<li><p>代理的分类：</p>
</li>
</ul>
<p>正向代理：代理客户端获取数据。正向代理是为了保护客户端防止被追究责任。</p>
<p>反向代理：代理服务器提供数据。反向代理是为了保护服务器或负责负载均衡。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import urllib.request</span><br><span class="line">import urllib.parse</span><br><span class="line"></span><br><span class="line">#1.创建处理器对象，在其内部封装代理ip和端口</span><br><span class="line">handler=urllib.request.ProxyHandler(proxies=&#123;&apos;http&apos;:&apos;95.172.58.224:52608&apos;&#125;)</span><br><span class="line">#2.创建opener对象，然后使用该对象发起一个请求</span><br><span class="line">opener=urllib.request.build_opener(handler)</span><br><span class="line"></span><br><span class="line">url=&apos;http://www.baidu.com/s?ie=UTF-8&amp;wd=ip&apos;</span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    &apos;User-Agent&apos;: &apos;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.181 Safari/537.36&apos;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">request = urllib.request.Request(url, headers=headers)</span><br><span class="line"></span><br><span class="line">#使用opener对象发起请求，该请求对应的ip即为我们设置的代理ip</span><br><span class="line">response = opener.open(request)</span><br><span class="line"></span><br><span class="line">with open(&apos;./daili.html&apos;,&apos;wb&apos;) as fp:</span><br><span class="line">    fp.write(response.read())</span><br></pre></td></tr></table></figure>
<blockquote>
<p> 2.cookie</p>
</blockquote>
<p>引言：有些时候，我们在使用爬虫程序去爬取一些用户相关信息的数据（爬取张三“人人网”个人主页数据）时，如果使用之前requests模块常规操作时，往往达不到我们想要的目的，例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import urllib.request</span><br><span class="line">import urllib.parse</span><br><span class="line">#指定url</span><br><span class="line">url = &apos;http://www.renren.com/289676607/profile&apos;</span><br><span class="line">#自定义请求头信息</span><br><span class="line">headers=&#123;</span><br><span class="line">    &apos;User-Agent&apos;: &apos;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36&apos;,</span><br><span class="line">    &#125;</span><br><span class="line">#自定义请求对象</span><br><span class="line">request = urllib.request.Request(url=url,headers=headers)</span><br><span class="line">#发起请求</span><br><span class="line">response = urllib.request.urlopen(request)</span><br><span class="line"></span><br><span class="line">with open(&apos;./renren.html&apos;,&apos;w&apos;) as fp:</span><br><span class="line">    fp.write(response.read().decode())</span><br></pre></td></tr></table></figure>
<p>【注意】上述代码中，我们爬取到的是登录首页面，而不是张三的个人主页也面。why？首先我们来回顾下cookie的相关概念及作用</p>
<pre><code>- cookie概念：当用户通过浏览器首次访问一个域名时，访问的web服务器会给客户端发送数据，以保持web服务器与客户端之间的状态保持，这些数据就是cookie。

- cookie作用：我们在浏览器中，经常涉及到数据的交换，比如你登录邮箱，登录一个页面。我们经常会在此时设置30天内记住我，或者自动登录选项。那么它们是怎么记录信息的呢，答案就是今天的主角cookie了，Cookie是由HTTP服务器设置的，保存在浏览器中，但HTTP协议是一种无状态协议，在数据交换完毕后，服务器端和客户端的链接就会关闭，每次交换数据都需要建立新的链接。就像我们去超市买东西，没有积分卡的情况下，我们买完东西之后，超市没有我们的任何消费信息，但我们办了积分卡之后，超市就有了我们的消费信息。cookie就像是积分卡，可以保存积分，商品就是我们的信息，超市的系统就像服务器后台，http协议就是交易的过程。 

- 经过cookie的相关介绍，其实你已经知道了为什么上述案例中爬取到的不是张三个人信息页，而是登录页面。那应该如何抓取到张三的个人信息页呢？
</code></pre><p>　　思路：</p>
<p>　　　　1.我们需要使用爬虫程序对人人网的登录时的请求进行一次抓取，获取请求中的cookie数据</p>
<p>　　　　2.在使用个人信息页的url进行请求时，该请求需要携带 1 中的cookie，只有携带了cookie后，服务器才可识别这次请求的用户信息，方可响应回指定的用户信息页数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">cookiejar对象：</span><br><span class="line">    - 作用：自动保存请求中的cookie数据信息</span><br><span class="line">    - 注意：必须和handler和opener一起使用</span><br><span class="line">cookiejar使用流程：</span><br><span class="line">    - 创建一个cookiejar对象</span><br><span class="line">      import http.cookiejar</span><br><span class="line">      cj = http.cookiejar.CookieJar()</span><br><span class="line">    - 通过cookiejar创建一个handler</span><br><span class="line">      handler = urllib.request.HTTPCookieProcessor(cj)</span><br><span class="line">    - 根据handler创建一个opener</span><br><span class="line">      opener = urllib.request.build_opener(handler)</span><br><span class="line">    - 使用opener.open方法去发送请求，且将响应中的cookie存储到openner对象中，后续的请求如果使用openner发起，则请求中就会携带了cookie</span><br></pre></td></tr></table></figure>
<p>使用cookiejar实现爬取人人网个人主页页面数据：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">#使用cookiejar实现人人网的登陆</span><br><span class="line">import urllib.request</span><br><span class="line">import urllib.parse</span><br><span class="line">import http.cookiejar</span><br><span class="line">cj = http.cookiejar.CookieJar() #请求中的cookie会自动存储到cj对象中</span><br><span class="line">#创建处理器对象(携带cookiejar对象的)</span><br><span class="line">handler=urllib.request.HTTPCookieProcessor(cj)</span><br><span class="line">#创建opener对象 （携带cookiejar对象）</span><br><span class="line">opener=urllib.request.build_opener(handler)</span><br><span class="line"></span><br><span class="line">#要让cookiejar获取请求中的cookie数据值</span><br><span class="line">url=&apos;http://www.renren.com/ajaxLogin/login?1=1&amp;uniqueTimestamp=201873958471&apos;</span><br><span class="line">#自定义一个请求对象，让该对象作为opener的open函数中的参数</span><br><span class="line">data=&#123;</span><br><span class="line">    &quot;email&quot;:&quot;www.zhangbowudi@qq.com&quot;,</span><br><span class="line">    &quot;icode&quot;:&quot;&quot;,</span><br><span class="line">    &quot;origURL&quot;:&quot;http://www.renren.com/home&quot;,</span><br><span class="line">    &quot;domain&quot;:&quot;renren.com&quot;,</span><br><span class="line">    &quot;key_id&quot;:&quot;1&quot;,</span><br><span class="line">    &quot;captcha_type&quot;:&quot;web_login&quot;,</span><br><span class="line">    &quot;password&quot;:&quot;40dc65b82edd06d064b54a0fc6d202d8a58c4cb3d2942062f0f7dd128511fb9b&quot;,</span><br><span class="line">    &quot;rkey&quot;:&quot;41b44b0d062d3ca23119bc8b58983104&quot;,</span><br><span class="line">  </span><br><span class="line"> &apos;f&apos;:&quot;https%3A%2F%2Fwww.baidu.com%2Flink%3Furl%3DpPKf2680yRLbbZMVdntJpyPGwrSk2BtpKlEaAuKFTsW%26wd%3D%26eqid%3Deee20f380002988c000000025b7cbb80&quot;</span><br><span class="line">&#125;</span><br><span class="line">data=urllib.parse.urlencode(data).encode()</span><br><span class="line">request=urllib.request.Request(url,data=data)</span><br><span class="line">opener.open(request)</span><br><span class="line"></span><br><span class="line">#获取当前用户的二级子页面</span><br><span class="line">s_url=&apos;http://www.renren.com/289676607/profile&apos;</span><br><span class="line">#该次请求中就携带了cookie</span><br><span class="line">resonse=opener.open(s_url)</span><br><span class="line"></span><br><span class="line">with open(&apos;./renren.html&apos;,&apos;wb&apos;) as fp:</span><br><span class="line">    fp.write(resonse.read())</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/11/29/Py007-01-03内置urllib模块补充/" data-id="cklhgn2hc00ivkyfyp3xmxfpw" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/M07/">M07</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Py007-01-02内置urllib模块" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/29/Py007-01-02内置urllib模块/" class="article-date">
  <time datetime="2018-11-29T14:58:37.000Z" itemprop="datePublished">2018-11-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/29/Py007-01-02内置urllib模块/">Py007-01-02内置urllib模块</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>urllib模块非爬虫的重点，核心为后面的request以及各种框架</p>
</blockquote>
<h3 id="内置urllib"><a href="#内置urllib" class="headerlink" title="内置urllib"></a>内置urllib</h3><p>概念：urllib是Python自带的一个用于爬虫的库，其主要作用就是可以通过代码模拟浏览器发送请求。其常被用到的子模块在Python3中的为urllib.request和urllib.parse，在Python2中是urllib和urllib2。</p>
<ul>
<li>作用：可以使用代码模拟浏览器发起请求。request  parse</li>
</ul>
<blockquote>
<p>使用流程：</p>
</blockquote>
<ol>
<li>指定url</li>
<li>发请求</li>
<li>获取页面数据</li>
<li>持久化存储</li>
</ol>
<h4 id="需求1爬取搜狗首页的页面数据"><a href="#需求1爬取搜狗首页的页面数据" class="headerlink" title="需求1爬取搜狗首页的页面数据"></a>需求1爬取搜狗首页的页面数据</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">import urllib.request</span><br><span class="line"></span><br><span class="line">#1.指定url</span><br><span class="line">url = &apos;https://www.sogou.com/&apos;</span><br><span class="line"></span><br><span class="line">#2.发起请求:urlopen可以根据指定的url发起请求，切返回一个响应对象</span><br><span class="line">response = urllib.request.urlopen(url=url)</span><br><span class="line"></span><br><span class="line">#3.获取页面数据:read函数返回的就是响应对象中存储的页面数据(byte)</span><br><span class="line">page_text = response.read()</span><br><span class="line"></span><br><span class="line">#4.持久化存储</span><br><span class="line">with open(&apos;./sougou.html&apos;,&apos;wb&apos;) as fp:</span><br><span class="line">    # fp.write(page_text)</span><br><span class="line">    # print(page_text) # 字节码</span><br><span class="line">    print(page_text.decode()) # 转化为字符串</span><br><span class="line">    fp.write(page_text.decode())#使用decode将page_text转成字符串类型</span><br><span class="line">    print(&apos;写入数据成功&apos;)</span><br></pre></td></tr></table></figure>
<h4 id="需求2搜狗搜关键字"><a href="#需求2搜狗搜关键字" class="headerlink" title="需求2搜狗搜关键字"></a>需求2搜狗搜关键字</h4><blockquote>
<p>注意：</p>
</blockquote>
<ul>
<li>urllib模块的get参数如果有中文要自行转义，否则报错UnicodeEncodeError</li>
<li>使用urllib.parse.quote(“中文参数”) 转义中文</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"># 需求：爬取指定词条所对应的页面数据</span><br><span class="line"></span><br><span class="line">import urllib.request</span><br><span class="line">import urllib.parse</span><br><span class="line"></span><br><span class="line">#指定url</span><br><span class="line">url = &apos;https://www.sogou.com/web?query=&apos;</span><br><span class="line">#url特性：url不可以存在非ASCII编码的字符数据</span><br><span class="line">word = urllib.parse.quote(&quot;人民币&quot;)</span><br><span class="line">url += word #有效的url</span><br><span class="line"></span><br><span class="line">#发请求</span><br><span class="line">response = urllib.request.urlopen(url=url)</span><br><span class="line"></span><br><span class="line">#获取页面数据</span><br><span class="line">page_text = response.read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">with open(&apos;renminbi.html&apos;,&apos;wb&apos;) as fp:</span><br><span class="line">    fp.write(page_text)</span><br><span class="line">    </span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line">如果</span><br><span class="line">word=&apos;人民币&apos;</span><br><span class="line">不经过转义则直接报错</span><br><span class="line">UnicodeEncodeError: &apos;ascii&apos; codec can&apos;t encode characters in position 15-17: ordinal not in range(128)</span><br><span class="line">&apos;&apos;&apos;</span><br></pre></td></tr></table></figure>
<p>是不是很麻烦如果多个参数就要多次处理？</p>
<h4 id="使用UA来伪装"><a href="#使用UA来伪装" class="headerlink" title="使用UA来伪装"></a>使用UA来伪装</h4><ul>
<li>反爬机制：网站检查请求的UA，如果发现UA是爬虫程序，则拒绝提供网站数据。</li>
<li>User-Agent(UA)：请求载体的身份标识.</li>
<li>反反爬机制：伪装爬虫程序请求的UA</li>
</ul>
<blockquote>
<p>爬去百度首页</p>
</blockquote>
<ul>
<li>如果不用UA伪装，爬去的页面是不对的(百度已经做了反爬处理)</li>
<li>获取UA打开浏览器</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1.开发者工具</span><br><span class="line">2.检查</span><br><span class="line">3.Network</span><br><span class="line">4.访问百度</span><br><span class="line">5.找到Request Headers的请求信息里的User-Agent字符串</span><br><span class="line">形如</span><br><span class="line">Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.110 Safari/537.36</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">import urllib.request</span><br><span class="line"></span><br><span class="line">url = &apos;https://www.baidu.com/&apos;</span><br><span class="line"></span><br><span class="line">#UA伪装</span><br><span class="line">#1.自定制一个请求对象</span><br><span class="line">headers = &#123;</span><br><span class="line">    #存储任意的请求头信息</span><br><span class="line">    &apos;User-Agent&apos;: &apos;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.67 Safari/537.36&apos;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">#该请求对象的UA进行了成功的伪装</span><br><span class="line">request = urllib.request.Request(url=url,headers=headers)</span><br><span class="line"></span><br><span class="line">#2.针对自定制的请求对象发起请求</span><br><span class="line">response = urllib.request.urlopen(request)</span><br><span class="line"></span><br><span class="line">print(response.read())</span><br></pre></td></tr></table></figure>
<h4 id="使用urllib发起post请求"><a href="#使用urllib发起post请求" class="headerlink" title="使用urllib发起post请求"></a>使用urllib发起post请求</h4><blockquote>
<p>需求：爬取百度翻译的翻译结果</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import urllib.request</span><br><span class="line">import urllib.parse</span><br><span class="line"></span><br><span class="line">#1.指定url</span><br><span class="line">url = &apos;https://fanyi.baidu.com/sug&apos;</span><br><span class="line"></span><br><span class="line">#post请求携带的参数进行处理  流程：</span><br><span class="line">#1.将post请求参数封装到字典</span><br><span class="line">data = &#123;</span><br><span class="line">    &apos;kw&apos;:&apos;西瓜&apos;</span><br><span class="line">&#125;</span><br><span class="line">#2.使用parse模块中的urlencode(返回值类型为str)进行编码处理</span><br><span class="line">data = urllib.parse.urlencode(data)</span><br><span class="line">#3.将步骤2的编码结果转换成byte类型</span><br><span class="line">data = data.encode()</span><br><span class="line"></span><br><span class="line">#2.发起post请求:urlopen函数的data参数表示的就是经过处理之后的post请求携带的参数</span><br><span class="line">response = urllib.request.urlopen(url=url,data=data)</span><br><span class="line"></span><br><span class="line">response.read()</span><br><span class="line">res = response.read()</span><br><span class="line">print(res)</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/11/29/Py007-01-02内置urllib模块/" data-id="cklhgn2hb00itkyfypxzyq82r" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/M07/">M07</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Py007-01-01爬虫初识" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/29/Py007-01-01爬虫初识/" class="article-date">
  <time datetime="2018-11-29T14:57:17.000Z" itemprop="datePublished">2018-11-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/29/Py007-01-01爬虫初识/">Py007-01-01爬虫初识</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="python网络爬虫的简单介绍"><a href="#python网络爬虫的简单介绍" class="headerlink" title="python网络爬虫的简单介绍"></a>python网络爬虫的简单介绍</h3><blockquote>
<p>什么是爬虫</p>
</blockquote>
<p>爬虫就是通过编写程序模拟浏览器上网，然后让其去互联网上抓取数据的过程。</p>
<blockquote>
<p>哪些语言可以实现爬虫</p>
</blockquote>
<ol>
<li><p>php：可以实现爬虫。php被号称是全世界最优美的语言（当然是其自己号称的，就是王婆卖瓜的意思），但是php在实现爬虫中支持多线程和多进程方面做的不好。</p>
</li>
<li><p>java：可以实现爬虫。java可以非常好的处理和实现爬虫，是唯一可以与python并驾齐驱且是python的头号劲敌。但是java实现爬虫代码较为臃肿，重构成本较大。</p>
</li>
<li><p>c、c++：可以实现爬虫。但是使用这种方式实现爬虫纯粹是是某些人（大佬们）能力的体现，却不是明智和合理的选择。</p>
</li>
<li><p>python：可以实现爬虫。python实现和处理爬虫语法简单，代码优美，支持的模块繁多，学习成本低，具有非常强大的框架（scrapy等）且一句难以言表的好！没有但是！</p>
</li>
</ol>
<h4 id="爬虫的分类"><a href="#爬虫的分类" class="headerlink" title="爬虫的分类"></a>爬虫的分类</h4><blockquote>
<h4 id="1-通用爬虫：通用爬虫是搜索引擎（Baidu、Google、Yahoo等）“抓取系统”的重要组成部分。主要目的是将互联网上的网页下载到本地，形成一个互联网内容的镜像备份。-简单来讲就是尽可能的；把互联网上的所有的网页下载下来，放到本地服务器里形成备分，在对这些网页做相关处理-提取关键字、去掉广告-，最后提供一个用户检索接口。"><a href="#1-通用爬虫：通用爬虫是搜索引擎（Baidu、Google、Yahoo等）“抓取系统”的重要组成部分。主要目的是将互联网上的网页下载到本地，形成一个互联网内容的镜像备份。-简单来讲就是尽可能的；把互联网上的所有的网页下载下来，放到本地服务器里形成备分，在对这些网页做相关处理-提取关键字、去掉广告-，最后提供一个用户检索接口。" class="headerlink" title="1. 通用爬虫：通用爬虫是搜索引擎（Baidu、Google、Yahoo等）“抓取系统”的重要组成部分。主要目的是将互联网上的网页下载到本地，形成一个互联网内容的镜像备份。  简单来讲就是尽可能的；把互联网上的所有的网页下载下来，放到本地服务器里形成备分，在对这些网页做相关处理(提取关键字、去掉广告)，最后提供一个用户检索接口。"></a>1. 通用爬虫：通用爬虫是搜索引擎（Baidu、Google、Yahoo等）“抓取系统”的重要组成部分。主要目的是将互联网上的网页下载到本地，形成一个互联网内容的镜像备份。  简单来讲就是尽可能的；把互联网上的所有的网页下载下来，放到本地服务器里形成备分，在对这些网页做相关处理(提取关键字、去掉广告)，最后提供一个用户检索接口。</h4></blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">搜索引擎如何抓取互联网上的网站数据？</span><br><span class="line">门户网站主动向搜索引擎公司提供其网站的url</span><br><span class="line">搜索引擎公司与DNS服务商合作，获取网站的url</span><br><span class="line">门户网站主动挂靠在一些知名网站的友情链接中</span><br></pre></td></tr></table></figure>
<blockquote>
<h4 id="2-聚焦爬虫：聚焦爬虫是根据指定的需求抓取网络上指定的数据。例如：获取豆瓣上电影的名称和影评，而不是获取整张页面中所有的数据值。"><a href="#2-聚焦爬虫：聚焦爬虫是根据指定的需求抓取网络上指定的数据。例如：获取豆瓣上电影的名称和影评，而不是获取整张页面中所有的数据值。" class="headerlink" title="2.聚焦爬虫：聚焦爬虫是根据指定的需求抓取网络上指定的数据。例如：获取豆瓣上电影的名称和影评，而不是获取整张页面中所有的数据值。"></a>2.聚焦爬虫：聚焦爬虫是根据指定的需求抓取网络上指定的数据。例如：获取豆瓣上电影的名称和影评，而不是获取整张页面中所有的数据值。</h4></blockquote>
<h4 id="robots-txt协议"><a href="#robots-txt协议" class="headerlink" title="robots.txt协议"></a>robots.txt协议</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">如果自己的门户网站中的指定页面中的数据不想让爬虫程序爬取到的话，那么则可以通过编写一个robots.txt的协议文件来约束爬虫程序的数据爬取。robots协议的编写格式可以观察淘宝网的robots（访问www.taobao.com/robots.txt即可）。但是需要注意的是，该协议只是相当于口头的协议，并没有使用相关技术进行强制管制，所以该协议是防君子不防小人。但是我们在学习爬虫阶段编写的爬虫程序可以先忽略robots协议。</span><br></pre></td></tr></table></figure>
<h4 id="反爬虫"><a href="#反爬虫" class="headerlink" title="反爬虫"></a>反爬虫</h4><ul>
<li>门户网站通过相应的策略和技术手段，防止爬虫程序进行网站数据的爬取。</li>
</ul>
<h4 id="反反爬虫"><a href="#反反爬虫" class="headerlink" title="反反爬虫"></a>反反爬虫</h4><ul>
<li>爬虫程序通过相应的策略和技术手段，破解门户网站的反爬虫手段，从而爬取到相应的数据。</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/11/29/Py007-01-01爬虫初识/" data-id="cklhgn2ha00irkyfyfi990cxm" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/M07/">M07</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Py008-01-05选择排序和插入排序" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/27/Py008-01-05选择排序和插入排序/" class="article-date">
  <time datetime="2018-11-27T13:21:51.000Z" itemprop="datePublished">2018-11-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/27/Py008-01-05选择排序和插入排序/">Py008-01-05选择排序和插入排序</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="选择排序-体育老师一指禅法"><a href="#选择排序-体育老师一指禅法" class="headerlink" title="选择排序(体育老师一指禅法)"></a>选择排序(体育老师一指禅法)</h3><p>思路：</p>
<p>在一个列表里每次把最小的值取出来。</p>
<blockquote>
<p>简易版本(不建议用)</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">li = [3,2,4,6,5,1,8,7,9]</span><br><span class="line"></span><br><span class="line">def select_sort1(li):</span><br><span class="line">    list_new = []</span><br><span class="line">    for i in range(len(li)):</span><br><span class="line">        min_val = min(li)</span><br><span class="line">        list_new.append(min_val)</span><br><span class="line">        li.remove(min_val)</span><br><span class="line"></span><br><span class="line">    return list_new</span><br><span class="line"></span><br><span class="line">res = select_sort1(li)</span><br><span class="line">print(res)</span><br><span class="line"></span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line">我们知道  冒泡排序是交换彼此直接的位置，属于原地排序</span><br><span class="line"></span><br><span class="line">而这个版本的选择排序  </span><br><span class="line">每次都对原始数据进行删除  假如是长度10000的集合  如果满足条件的值在中间5000的位置  那么后边的要依次  索引-1</span><br><span class="line">&apos;&apos;&apos;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>优化版</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">def select_sort2(li):</span><br><span class="line">    for i in range(len(li)-1): # i是第几趟</span><br><span class="line">        min_loc = i</span><br><span class="line">        for j in range(i+1,len(li)):</span><br><span class="line">            if li[j]&lt;li[min_loc]:</span><br><span class="line">                min_loc = j</span><br><span class="line">        li[i],li[min_loc] = li[min_loc],li[i]</span><br><span class="line">        print(li)</span><br><span class="line"></span><br><span class="line">res2 = select_sort2(li)</span><br><span class="line">print(res2)</span><br></pre></td></tr></table></figure>
<ul>
<li>一趟排序记录最小的数，放到第一个</li>
<li>再一趟排序记录 列表无序区最小的数，放到第二个位置</li>
<li>。。。。</li>
<li>关键点：有序区 和 无序区，无序区最小值的位置</li>
</ul>
<blockquote>
<h4 id="时间复杂度：O-n-n"><a href="#时间复杂度：O-n-n" class="headerlink" title="时间复杂度：O(n*n)"></a>时间复杂度：O(n*n)</h4></blockquote>
<h3 id="插入排序-起扑克牌法"><a href="#插入排序-起扑克牌法" class="headerlink" title="插入排序(起扑克牌法)"></a>插入排序(起扑克牌法)</h3><p>你玩过扑克吗？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">你是如何摸牌的？</span><br><span class="line">比如 arr = [5,1,3,2,4]</span><br><span class="line"></span><br><span class="line">()内为你摸到的牌</span><br><span class="line"></span><br><span class="line">第一次摸到5 </span><br><span class="line">(5) [1,3,2,4]</span><br><span class="line">第二次摸到1   1与5比=&gt;小 交换位置</span><br><span class="line">(1,5) [3,2,4]</span><br><span class="line">第三次摸到3   3与5比=&gt;小 交换位置   3与1比=&gt;大 不交换</span><br><span class="line">(1,3,5) [2,4]</span><br><span class="line">第四次摸到2   2与5比=&gt;小 交换位置   2与3比=&gt;小 交换位置   2与1比=&gt;大 不交换</span><br><span class="line">(1,2,3,5) [4]</span><br><span class="line">第五次摸到4  4与5比=&gt;小 交换位置   4与3比=&gt;大  不交换</span><br></pre></td></tr></table></figure>
<p>插入排序代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">def insert_sort(li):</span><br><span class="line">    for i in range(1,len(li)): # 表示摸到的牌的下标</span><br><span class="line">        tmp = li[i]</span><br><span class="line">        j = i-1 # 手里牌的下标</span><br><span class="line">        while j&gt;=0 and li[j]&gt;tmp:</span><br><span class="line">            li[j+1] = li[j]</span><br><span class="line">            j -= 1</span><br><span class="line">        li[j+1] = tmp</span><br><span class="line">        print(li)</span><br><span class="line"></span><br><span class="line">li = [3,2,4,6,5,1,8,7,9]</span><br><span class="line"></span><br><span class="line">insert_sort(li)</span><br></pre></td></tr></table></figure>
<blockquote>
<h4 id="时间复杂度：-O-n-n"><a href="#时间复杂度：-O-n-n" class="headerlink" title="时间复杂度： O(n*n)"></a>时间复杂度： O(n*n)</h4></blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/11/27/Py008-01-05选择排序和插入排序/" data-id="cklhgn2hy00kfkyfykg36lyvv" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/M08/">M08</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Py008-01-04排序" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/26/Py008-01-04排序/" class="article-date">
  <time datetime="2018-11-26T14:44:28.000Z" itemprop="datePublished">2018-11-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/26/Py008-01-04排序/">Py008-01-04排序</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h3><ul>
<li>排序：将一组‘无序’的记录序列调整为‘有序’的记录列表</li>
<li><p>列表排序<br>  输入：列表<br>  输出：有序列表</p>
</li>
<li><p>生序和降序</p>
</li>
<li>内置排序函数：sort()</li>
</ul>
<h4 id="常见排序"><a href="#常见排序" class="headerlink" title="常见排序"></a>常见排序</h4><blockquote>
<p>low B 三人组</p>
</blockquote>
<ul>
<li>冒泡排序</li>
<li>选择排序</li>
<li>插入排序</li>
</ul>
<blockquote>
<p>NB 三人组</p>
</blockquote>
<ul>
<li>快速排序</li>
<li>堆排序</li>
<li>归并排序</li>
</ul>
<blockquote>
<p>其他排序</p>
</blockquote>
<ul>
<li>希尔</li>
<li>计数</li>
<li>基数</li>
</ul>
<h4 id="冒泡排序-Bubble-sort-体育委员两两比较法"><a href="#冒泡排序-Bubble-sort-体育委员两两比较法" class="headerlink" title="冒泡排序 (Bubble sort) 体育委员两两比较法"></a>冒泡排序 (Bubble sort) 体育委员两两比较法</h4><ul>
<li>列表每两个相邻的数，如果后面的比前面的大，则交换这两个数</li>
<li>一趟排序完成后，则无序区减少一个数，有序区增加一个数</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">初始列表</span><br><span class="line">5 2 3 1 4</span><br><span class="line"></span><br><span class="line">第一趟 </span><br><span class="line">    5 2 3 1 4</span><br><span class="line">    第一次</span><br><span class="line">    2 5 3 1 4</span><br><span class="line">    第二次</span><br><span class="line">    2 3 5 1 4</span><br><span class="line">    第三次</span><br><span class="line">    2 3 1 5 4</span><br><span class="line">    第四次</span><br><span class="line">    2 3 1 4 5  此时最大的数5已经站定了</span><br><span class="line"></span><br><span class="line">第二趟</span><br><span class="line">    2 3 1 4</span><br><span class="line">    第一次</span><br><span class="line">    2 3 1 4 </span><br><span class="line">    第二次</span><br><span class="line">    2 1 3 4</span><br><span class="line">    第三次</span><br><span class="line">    2 1 3 4  此时最大的数4已经站定了</span><br><span class="line"></span><br><span class="line">第三趟</span><br><span class="line">    2 1 3</span><br><span class="line">    第一次</span><br><span class="line">    1 2 3</span><br><span class="line">    第二次</span><br><span class="line">    1 2 3    此时最大的数3已经站定了</span><br><span class="line"></span><br><span class="line">第四趟</span><br><span class="line">    1 2</span><br><span class="line">    第一次</span><br><span class="line">    1 2      此时最大的数2已经站定了</span><br><span class="line"></span><br><span class="line">最后 1 2 3 4 5</span><br></pre></td></tr></table></figure>
<p>冒泡排序代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">def bubble_sort(li):</span><br><span class="line">    for i in range(len(li)-1): # 第几趟</span><br><span class="line">        for j in range(len(li) - i - 1):</span><br><span class="line">            if li[j] &gt; li[j+1]:# 大就交换</span><br><span class="line">                li[j],li[j+1] = li[j+1],li[j]</span><br><span class="line">        print(li)</span><br><span class="line"></span><br><span class="line">li = [3,2,4,6,5,1,8,7,9]</span><br><span class="line"></span><br><span class="line">bubble_sort(li)</span><br><span class="line"></span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line">结果如下</span><br><span class="line">[2, 3, 4, 5, 1, 6, 7, 8, 9]</span><br><span class="line">[2, 3, 4, 1, 5, 6, 7, 8, 9]</span><br><span class="line">[2, 3, 1, 4, 5, 6, 7, 8, 9]</span><br><span class="line">[2, 1, 3, 4, 5, 6, 7, 8, 9]</span><br><span class="line">[1, 2, 3, 4, 5, 6, 7, 8, 9]</span><br><span class="line">[1, 2, 3, 4, 5, 6, 7, 8, 9]</span><br><span class="line">[1, 2, 3, 4, 5, 6, 7, 8, 9]</span><br><span class="line">[1, 2, 3, 4, 5, 6, 7, 8, 9]</span><br><span class="line">&apos;&apos;&apos;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>时间复杂度：O(n*n)</p>
</blockquote>
<blockquote>
<h4 id="冒泡排序的优化"><a href="#冒泡排序的优化" class="headerlink" title="冒泡排序的优化"></a>冒泡排序的优化</h4></blockquote>
<p>如果一趟列表中没有发生交换则代表已经排好序了  则后面无需进行那么多次的比较了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">def bubble_sort2(li):</span><br><span class="line">    for i in range(len(li)-1): # 第几趟</span><br><span class="line">        exchange = False</span><br><span class="line">        for j in range(len(li) - i - 1):</span><br><span class="line">            if li[j] &gt; li[j+1]:# 大就交换</span><br><span class="line">                li[j],li[j+1] = li[j+1],li[j]</span><br><span class="line">                exchange = True</span><br><span class="line">        print(li)</span><br><span class="line">        if not exchange:</span><br><span class="line">            return</span><br><span class="line"></span><br><span class="line">li = [3,2,4,6,5,1,8,7,9]</span><br><span class="line"></span><br><span class="line">bubble_sort2(li)</span><br><span class="line"></span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line">[2, 3, 4, 5, 1, 6, 7, 8, 9]</span><br><span class="line">[2, 3, 4, 1, 5, 6, 7, 8, 9]</span><br><span class="line">[2, 3, 1, 4, 5, 6, 7, 8, 9]</span><br><span class="line">[2, 1, 3, 4, 5, 6, 7, 8, 9]</span><br><span class="line">[1, 2, 3, 4, 5, 6, 7, 8, 9]</span><br><span class="line">[1, 2, 3, 4, 5, 6, 7, 8, 9]</span><br><span class="line">&apos;&apos;&apos;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/11/26/Py008-01-04排序/" data-id="cklhgn2hx00kckyfyh6oir1l7" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/M08/">M08</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Py008-01-03查找算法" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/26/Py008-01-03查找算法/" class="article-date">
  <time datetime="2018-11-26T13:58:42.000Z" itemprop="datePublished">2018-11-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/26/Py008-01-03查找算法/">Py008-01-03查找算法</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="查找"><a href="#查找" class="headerlink" title="查找"></a>查找</h3><p>在一些数据里，通过一定的方法找出与给定关键字相同的数据的元素的过程</p>
<blockquote>
<h3 id="列表查找-线性表查找-：从列表中查找指定元素"><a href="#列表查找-线性表查找-：从列表中查找指定元素" class="headerlink" title="列表查找(线性表查找)：从列表中查找指定元素"></a>列表查找(线性表查找)：从列表中查找指定元素</h3></blockquote>
<ul>
<li>输入：列表/待查找元素</li>
<li>输出：元素下标（未找到元素时一般返回None或-1）</li>
</ul>
<blockquote>
<h3 id="内置列表查找函数：index"><a href="#内置列表查找函数：index" class="headerlink" title="内置列表查找函数：index()"></a>内置列表查找函数：index()</h3></blockquote>
<h3 id="顺序查找-linear-search"><a href="#顺序查找-linear-search" class="headerlink" title="顺序查找(linear search)"></a>顺序查找(linear search)</h3><p>也叫线性查找，从列表第一个元素开始，顺序进行搜索，直到找到元素或搜索到列表最后一个元素为止</p>
<blockquote>
<p>时间复杂度：O(n)</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">def linear_search(data_set,value):</span><br><span class="line">    for i,v in enumerate(data_set):</span><br><span class="line">        if v == value:</span><br><span class="line">            return i</span><br><span class="line">    return None</span><br><span class="line"></span><br><span class="line">index = linear_search([1,2,3,5,4],4) # 4</span><br></pre></td></tr></table></figure>
<h3 id="二分查找"><a href="#二分查找" class="headerlink" title="二分查找"></a>二分查找</h3><p>折半查找，从有序列表的初始候选区arr[0:n]开始，通过对待查找的值与候选区中间的值的比较，可以使候选区减少一半</p>
<blockquote>
<p>猜物品价格 0-1000 假设物品840元</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">第一次 500  低了  + (1000-500)/2 = +250</span><br><span class="line">第二次 750  低了  + (1000-750)/2 = +125</span><br><span class="line">第三次 875  高了  - (875-750)/2 = -62.5</span><br><span class="line">第四次 813  低了  + (875-813)/2 = +31</span><br><span class="line">第五次 844  高了 - (844-813)/2 = -11.5</span><br><span class="line">第六次 833  低了 + (844-833)/2 = +5.5</span><br><span class="line">第七次 838  低了 + (844-838)/2 = +3</span><br><span class="line">第七次 841  高了 - (841-838)/2 = -1.5</span><br><span class="line">第八次 840  对了</span><br></pre></td></tr></table></figure>
<p>二分查找算法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">def binary_search(li,val):</span><br><span class="line">    left = 0</span><br><span class="line">    right = len(li) - 1</span><br><span class="line">    while left &lt;= right: # 候选区有值</span><br><span class="line">        # 中间值</span><br><span class="line">        mid = (left + right) // 2</span><br><span class="line">        if li[mid] == val:</span><br><span class="line">            return mid</span><br><span class="line">        elif li[mid] &gt; val: # 待查找的值在mid左侧</span><br><span class="line">            right = mid - 1</span><br><span class="line">        else: # li[mid] &lt; val # 待查找的值在mid右侧</span><br><span class="line">            left = mid + 1</span><br><span class="line">    else:</span><br><span class="line">        return None</span><br><span class="line"></span><br><span class="line">a = binary_search([1,2,3,4,5,6,7,8,9],3) # 2</span><br></pre></td></tr></table></figure>
<blockquote>
<p>时间复杂度： O(log n)</p>
</blockquote>
<p>二分查找比线性查找速度快</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">内置函数index() 就是线性查找，因为二分查找的要求就是有序列表</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/11/26/Py008-01-03查找算法/" data-id="cklhgn2hz00kgkyfytrsqvjy9" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/M08/">M08</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Py008-01-02递归和汉诺塔" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/26/Py008-01-02递归和汉诺塔/" class="article-date">
  <time datetime="2018-11-26T13:15:59.000Z" itemprop="datePublished">2018-11-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/26/Py008-01-02递归和汉诺塔/">Py008-01-02递归和汉诺塔</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="递归"><a href="#递归" class="headerlink" title="递归"></a>递归</h3><p>特点</p>
<ul>
<li>调用自身</li>
<li>结束条件</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">def fn1(x):</span><br><span class="line">    print(x)</span><br><span class="line">    fn1(x-1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def fn2(x):</span><br><span class="line">    if x&gt;0:</span><br><span class="line">        print(x)</span><br><span class="line">        fn2(x+1)</span><br><span class="line"></span><br><span class="line"># 合法递归   fn3(3)  ==&gt;3 2 1</span><br><span class="line">def fn3(x):</span><br><span class="line">    if x&gt;0:</span><br><span class="line">        print(x)</span><br><span class="line">        fn3(x-1)</span><br><span class="line"></span><br><span class="line"># 合法递归   fn4(3)  ==&gt;1 2 3</span><br><span class="line">def fn4(x):</span><br><span class="line">    if x&gt;0:</span><br><span class="line">        fn4(x-1)</span><br><span class="line">        print(x)</span><br></pre></td></tr></table></figure>
<h4 id="汉诺塔问题"><a href="#汉诺塔问题" class="headerlink" title="汉诺塔问题"></a>汉诺塔问题</h4><ul>
<li>三个柱子 A B C</li>
<li>A上有3个盘子   大盘子在最下  小盘子在最上</li>
<li>只能在 三个柱子上移动</li>
<li>实现  把A上的盘子移动到C</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">n=2时</span><br><span class="line">1. 把小圆盘从A移动到B</span><br><span class="line">2. 把小圆盘从A移动到C</span><br><span class="line">3. 把小圆盘从B移动到C</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n=n时</span><br><span class="line">1. 把n-1个盘子从A经过C移动到B</span><br><span class="line">2. 把第n个圆盘从A移动到C</span><br><span class="line">3. 把n-1个圆盘从B经过A移动到C</span><br></pre></td></tr></table></figure>
<blockquote>
<p>代码实现</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&apos;&apos;&apos;</span><br><span class="line">a:从那个盘子</span><br><span class="line">b:经过那个盘子</span><br><span class="line">c:到那个盘子</span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line">def hanoi(n,a,b,c):</span><br><span class="line">    if n&gt;0:</span><br><span class="line">        hanoi(n-1,a,c,b)</span><br><span class="line">        print(&apos;moving from %s to %s&apos;%(a,c))</span><br><span class="line">        hanoi(n-1,b,a,c)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">hanoi(3,&apos;A&apos;,&apos;B&apos;,&apos;C&apos;)</span><br><span class="line"></span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line">moving from A to C</span><br><span class="line">moving from A to B</span><br><span class="line">moving from C to B</span><br><span class="line">moving from A to C</span><br><span class="line">moving from B to A</span><br><span class="line">moving from B to C</span><br><span class="line">moving from A to C</span><br><span class="line">&apos;&apos;&apos;</span><br></pre></td></tr></table></figure>
<p>汉诺塔移动次数的递推式：h(x)=2h(x-1)+1<br>h(64)=18446744073709551615</p>
<p>假设每秒搬一个盘子，则需要5800亿年！</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/11/26/Py008-01-02递归和汉诺塔/" data-id="cklhgn2hx00kbkyfybl01om84" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/M08/">M08</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/29/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/28/">28</a><a class="page-number" href="/page/29/">29</a><span class="page-number current">30</span><a class="page-number" href="/page/31/">31</a><a class="page-number" href="/page/32/">32</a><span class="space">&hellip;</span><a class="page-number" href="/page/55/">55</a><a class="extend next" rel="next" href="/page/31/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS/">CSS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ES6速学/">ES6速学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JS不知深浅/">JS不知深浅</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M01/">M01</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M02/">M02</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M03/">M03</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M04/">M04</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M06/">M06</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M07/">M07</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M08/">M08</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M09/">M09</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NodeWeb/">NodeWeb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Node后端/">Node后端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ReactWheels/">ReactWheels</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React入门/">React入门</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TS入门/">TS入门</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/express/">express</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fullstack/">fullstack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/http/">http</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jQuery/">jQuery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mobile/">mobile</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/">mongodb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node/">node</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node每日精进/">node每日精进</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/oak/">oak</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tools/">tools</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vim/">vim</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vue/">vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vultr/">vultr</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web性能优化/">web性能优化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web面经/">web面经</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端知识点/">前端知识点</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/CSS/" style="font-size: 13.75px;">CSS</a> <a href="/tags/ES6速学/" style="font-size: 14.17px;">ES6速学</a> <a href="/tags/JS不知深浅/" style="font-size: 11.25px;">JS不知深浅</a> <a href="/tags/M01/" style="font-size: 13.33px;">M01</a> <a href="/tags/M02/" style="font-size: 15px;">M02</a> <a href="/tags/M03/" style="font-size: 15.83px;">M03</a> <a href="/tags/M04/" style="font-size: 16.25px;">M04</a> <a href="/tags/M06/" style="font-size: 18.33px;">M06</a> <a href="/tags/M07/" style="font-size: 17.92px;">M07</a> <a href="/tags/M08/" style="font-size: 17.08px;">M08</a> <a href="/tags/M09/" style="font-size: 11.67px;">M09</a> <a href="/tags/NodeWeb/" style="font-size: 15.42px;">NodeWeb</a> <a href="/tags/Node后端/" style="font-size: 18.75px;">Node后端</a> <a href="/tags/ReactWheels/" style="font-size: 16.67px;">ReactWheels</a> <a href="/tags/React入门/" style="font-size: 15px;">React入门</a> <a href="/tags/TS入门/" style="font-size: 14.58px;">TS入门</a> <a href="/tags/express/" style="font-size: 10.42px;">express</a> <a href="/tags/fullstack/" style="font-size: 17.92px;">fullstack</a> <a href="/tags/http/" style="font-size: 12.08px;">http</a> <a href="/tags/jQuery/" style="font-size: 10px;">jQuery</a> <a href="/tags/java/" style="font-size: 19.17px;">java</a> <a href="/tags/linux/" style="font-size: 10.83px;">linux</a> <a href="/tags/mobile/" style="font-size: 11.25px;">mobile</a> <a href="/tags/mongodb/" style="font-size: 12.5px;">mongodb</a> <a href="/tags/mysql/" style="font-size: 12.5px;">mysql</a> <a href="/tags/node/" style="font-size: 10.42px;">node</a> <a href="/tags/node每日精进/" style="font-size: 10px;">node每日精进</a> <a href="/tags/oak/" style="font-size: 20px;">oak</a> <a href="/tags/python/" style="font-size: 17.5px;">python</a> <a href="/tags/tools/" style="font-size: 10px;">tools</a> <a href="/tags/vim/" style="font-size: 10px;">vim</a> <a href="/tags/vue/" style="font-size: 12.92px;">vue</a> <a href="/tags/vultr/" style="font-size: 10px;">vultr</a> <a href="/tags/web性能优化/" style="font-size: 10px;">web性能优化</a> <a href="/tags/web面经/" style="font-size: 10px;">web面经</a> <a href="/tags/前端知识点/" style="font-size: 19.58px;">前端知识点</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/02/22/Node-web05-09-02博客系统部署最新版流程/">Node-web05-09-02博客系统部署最新版流程</a>
          </li>
        
          <li>
            <a href="/2021/02/22/Node-web05-07-03服务器端构建/">Node-web05-07-03服务器端构建</a>
          </li>
        
          <li>
            <a href="/2021/02/22/Node-web05-07-02服务器相关配置及使用/">Node-web05-07-02服务器相关配置及使用</a>
          </li>
        
          <li>
            <a href="/2021/02/20/Node-web05-09-01博客统部署2/">Node-web05-09-01博客统部署优化解释</a>
          </li>
        
          <li>
            <a href="/2021/02/20/Node-web05-08博客统页面完善/">Node-web05-08博客统页面完善</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 Stevin<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>