<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  

  
  <title>Almost</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Almost">
<meta property="og:url" content="http://yoursite.com/page/24/index.html">
<meta property="og:site_name" content="Almost">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Almost">
  
    <link rel="alternate" href="/atom.xml" title="Almost" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Almost</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-React入门009之React生命周期" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/01/24/React入门009之React生命周期/" class="article-date">
  <time datetime="2019-01-24T13:20:37.000Z" itemprop="datePublished">2019-01-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/01/24/React入门009之React生命周期/">React入门009之React生命周期</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="React生命周期"><a href="#React生命周期" class="headerlink" title="React生命周期"></a>React生命周期</h3><ul>
<li><a href="https://reactjs.org/docs/state-and-lifecycle.html" target="_blank" rel="noopener">英文文档</a></li>
<li><a href="https://react.docschina.org/docs/state-and-lifecycle.html" target="_blank" rel="noopener">中文文档</a></li>
</ul>
<p><img src="https://raw.githubusercontent.com/slTrust/note/master/react/react-study009-01.png" alt></p>
<blockquote>
<p>面试必考(但是平时用的不多)</p>
</blockquote>
<blockquote>
<h4 id="VanillaJS理解一个div的生命周期"><a href="#VanillaJS理解一个div的生命周期" class="headerlink" title="VanillaJS理解一个div的生命周期"></a>VanillaJS理解一个div的生命周期</h4></blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;root&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">let app = document.getElementById(&apos;root&apos;);</span><br><span class="line"></span><br><span class="line">// create 出现在js内存里</span><br><span class="line">let div = document.createElement(&apos;div&apos;);</span><br><span class="line">div.style.border = &apos;1px solid red&apos;;</span><br><span class="line"></span><br><span class="line">// mount 之前 </span><br><span class="line">let state = 0;</span><br><span class="line">div.innerHTML = `&lt;p&gt;$&#123;state&#125;&lt;/p&gt;</span><br><span class="line">                &lt;button&gt;add&lt;/button&gt;</span><br><span class="line">                &lt;button&gt;die&lt;/button&gt;</span><br><span class="line">                `;</span><br><span class="line"></span><br><span class="line">// mount 挂载</span><br><span class="line">app.appendChild(div);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">div.querySelector(&apos;button&apos;).onclick = ()=&gt;&#123;</span><br><span class="line">    state += 1</span><br><span class="line">    // update div</span><br><span class="line">    div.querySelector(&apos;p&apos;).innerText = state;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">div.querySelectorAll(&apos;button&apos;)[1].onclick = ()=&gt;&#123;</span><br><span class="line">    // remove div 但是要移干净</span><br><span class="line">    // 移除事件，移除引用</span><br><span class="line">    div.querySelector(&apos;button&apos;).onclick = null</span><br><span class="line">    div.querySelectorAll(&apos;button&apos;)[1].onclick = null</span><br><span class="line">    div.remove()</span><br><span class="line">    div = null</span><br><span class="line">    // 此时才是真正的  destroy div</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>人有生/老/病/死<br>div有 create / mount / update / destroy (生 挂 更 死)</p>
</blockquote>
<h3 id="此时看React版的生命周期-完整版"><a href="#此时看React版的生命周期-完整版" class="headerlink" title="此时看React版的生命周期(完整版)"></a>此时看React版的生命周期(完整版)</h3><p><a href="https://codesandbox.io/s/n9lj1nplxp" target="_blank" rel="noopener">在线代码</a></p>
<ul>
<li>constructor   创建</li>
<li>componentWillMount 将要挂载</li>
<li>render 填充/更新</li>
<li>componentDidMount 挂载完毕</li>
<li>componentWillUpdate 更新之前</li>
<li>shouldComponentUpdate 要不要更新</li>
<li>componentDidUpdate 更新之后</li>
<li>componentWillUnmount 没死之前</li>
<li>componentWillReceiveProps 父组件传递props了</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line">import React from &quot;react&quot;;</span><br><span class="line">import ReactDOM from &quot;react-dom&quot;;</span><br><span class="line">import &quot;./styles.css&quot;;</span><br><span class="line"></span><br><span class="line">let div = document.createElement(&quot;div&quot;);</span><br><span class="line">document.body.appendChild(div);</span><br><span class="line">console.log = function(content) &#123;</span><br><span class="line">  div.innerHTML += `$&#123;content&#125;&lt;br&gt;`;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">class Baba extends React.Component &#123;</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    super();</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      hasChild: true</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  onClick() &#123;</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      hasChild: false</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  callSon() &#123;</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      word: &quot;你还好吧&quot;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        我是你爸爸</span><br><span class="line">        &lt;button onClick=&#123;() =&gt; this.onClick()&#125;&gt;kill son&lt;/button&gt;</span><br><span class="line">        &lt;button onClick=&#123;() =&gt; this.callSon()&#125;&gt;call son&lt;/button&gt;</span><br><span class="line">        &#123;this.state.hasChild ? &lt;App word=&#123;this.state.word&#125; /&gt; : null&#125;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class App extends React.Component &#123;</span><br><span class="line">  onClick() &#123;</span><br><span class="line">    console.log(&quot;用户点击了&quot;);</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      n: this.state.n + 1</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  updateX() &#123;</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      x: this.state.x + &quot;!&quot;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    super();</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      n: 0,</span><br><span class="line">      x: &quot;不展示&quot;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  componentWillMount() &#123;</span><br><span class="line">    console.log(&quot;将要 mount App&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    // update</span><br><span class="line">    console.log(&quot;填充/更新 App 的内容&quot;);</span><br><span class="line">    return (</span><br><span class="line">      &lt;div className=&quot;App&quot;&gt;</span><br><span class="line">        &#123;this.state.n&#125;</span><br><span class="line">        &lt;br /&gt;</span><br><span class="line">        我爸说 &#123;this.props.word&#125;</span><br><span class="line">        &lt;br /&gt;</span><br><span class="line">        &lt;button onClick=&#123;() =&gt; this.onClick()&#125;&gt;+1&lt;/button&gt;</span><br><span class="line">        &lt;button onClick=&#123;() =&gt; this.updateX()&#125;&gt;update x&lt;/button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    console.log(&quot;mount App 完毕&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  componentWillUpdate() &#123;</span><br><span class="line">    console.log(&quot;update App 之前&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  shouldComponentUpdate(nextProps, nextState) &#123;</span><br><span class="line">    console.log(&quot;要不要更新呢？&quot;);</span><br><span class="line">    if (this.state.n === nextState.n) &#123;</span><br><span class="line">      return false;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      return true;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  //update is render</span><br><span class="line">  componentDidUpdate() &#123;</span><br><span class="line">    console.log(&quot;update App 之后&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  componentWillUnmount() &#123;</span><br><span class="line">    console.log(&quot;App 快要死了，记得喂狗&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  componentWillReceiveProps() &#123;</span><br><span class="line">    console.log(&quot;我爸说话了&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const rootElement = document.getElementById(&quot;root&quot;);</span><br><span class="line">ReactDOM.render(&lt;Baba /&gt;, rootElement);</span><br></pre></td></tr></table></figure>
<h3 id="我们在页面一般做什么？"><a href="#我们在页面一般做什么？" class="headerlink" title="我们在页面一般做什么？"></a>我们在页面一般做什么？</h3><ol>
<li>ajax请求数据</li>
<li>更新数据 setState</li>
<li>事件监听 onClick</li>
<li>初始化state</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">什么时候请求数据呢？ 理论上越早越好，任何周期都可以发请求</span><br><span class="line">- 创建的时候  (推荐)</span><br><span class="line">- 用户点击事件触发的时候 (推荐)</span><br><span class="line">- 组件将要 mount 的时候</span><br><span class="line">- mount之后</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">什么时候初始化呢？</span><br><span class="line">- 可以在 constructor (推荐)</span><br><span class="line">- 可以在 componentWillMount 里 (不推荐)</span><br><span class="line">- render呢？ 可以 但是要在return之前 因为此时要用到 state 了</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">什么时候更新 state呢？</span><br><span class="line">- 在 constructor 创建state之后 setState 不可以报错 Can&apos;t call setState on a component that is not yet mounted. </span><br><span class="line">- 不能在 render 里 setState() 这样就死循环了 因为 setState会触发 render</span><br><span class="line">- 不能在 mount 之前 也不能在 render 里 setState</span><br><span class="line">- 为什么在 componentWillUpdate 不能 因为setState会触发  将要更新了 而此时 setState 死循环</span><br><span class="line">- componentWillUnmount 可以  但是在它死之前 没意义啊</span><br><span class="line">- 一般在 componentWillReceiveProps / componentWillMount / 事件监听里</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">是否决定更新的函数</span><br><span class="line">- shouldComponentUpdate 返回 return false 就不更新</span><br><span class="line">- 极其特殊的情况才用—— 一般用不到</span><br></pre></td></tr></table></figure>
<h3 id="面试"><a href="#面试" class="headerlink" title="面试"></a>面试</h3><blockquote>
<p>面试：什么情况下用 shouldComponentUpdate 允许我们</p>
</blockquote>
<p>手动地判断是否要进行组件更新，根据组件的应用场景设置函数的合理返回值能够帮我们避免不必要的更新</p>
<ul>
<li><p><a href="https://zhuanlan.zhihu.com/p/24856035" target="_blank" rel="noopener">知乎专栏</a></p>
</li>
<li><p><a href="https://juejin.im/post/5b2215f76fb9a00e8f795cd1" target="_blank" rel="noopener">掘金</a></p>
</li>
</ul>
<blockquote>
<p>1.请说出React所有生命周期函数</p>
</blockquote>
<blockquote>
<p>2.请问 shouldComponentUpdate 为什么那么重要</p>
</blockquote>
<ul>
<li>可以自定义是否更新组件</li>
<li>优化更新的效率</li>
</ul>
<blockquote>
<p>3.请问ajax在什么时候用？</p>
</blockquote>
<ul>
<li>componentDidMount 原因是 constructor 里不能用 setState</li>
<li>在 fb里 多次调用会造成不稳定 (其实很多人也不知道为什么fb会造成不稳定)</li>
</ul>
<blockquote>
<p>4.用户点击按钮修改state会触发那些周期函数</p>
</blockquote>
<ul>
<li>shouldComponentUpdate</li>
<li>componentWillUpdate</li>
<li>render</li>
<li>componentDidUpdate</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/01/24/React入门009之React生命周期/" data-id="cklcb6bna00pzwo91x0yjcw2j" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React入门/">React入门</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-React入门008之Router" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/01/23/React入门008之Router/" class="article-date">
  <time datetime="2019-01-23T12:57:45.000Z" itemprop="datePublished">2019-01-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/01/23/React入门008之Router/">React入门008之Router</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>先来一个选项卡</p>
</blockquote>
<ul>
<li>打开 <a href="https://codesandbox.io/" target="_blank" rel="noopener">https://codesandbox.io/</a> 选择react</li>
<li>注意我用的react版本是16.7  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&quot;dependencies&quot;: &#123;</span><br><span class="line">    &quot;react&quot;: &quot;16.7.0-alpha.0&quot;,</span><br><span class="line">    &quot;react-dom&quot;: &quot;16.7.0-alpha.0&quot;,</span><br><span class="line">    &quot;react-scripts&quot;: &quot;2.0.3&quot;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>style.css</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.box &#123;</span><br><span class="line">  border: 1px solid #ccc;</span><br><span class="line">  text-align: center;</span><br><span class="line">  padding: 100px 0;</span><br><span class="line">  width: 90%;</span><br><span class="line">  margin: 0 auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>index.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">import React from &quot;react&quot;;</span><br><span class="line">import ReactDOM from &quot;react-dom&quot;;</span><br><span class="line">import &#123; useState &#125; from &quot;react&quot;;</span><br><span class="line">import &quot;./styles.css&quot;;</span><br><span class="line"></span><br><span class="line">function Login() &#123;</span><br><span class="line">  return &lt;div className=&quot;box&quot;&gt;登录&lt;/div&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function Register() &#123;</span><br><span class="line">  return &lt;div className=&quot;box&quot;&gt;注册&lt;/div&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function App() &#123;</span><br><span class="line">  let [ui, setUi] = useState(&quot;登录&quot;);</span><br><span class="line">  let onClickLogin = () =&gt; setUi(&quot;登录&quot;);</span><br><span class="line">  let onClickRegister = () =&gt; setUi(&quot;注册&quot;);</span><br><span class="line">  return (</span><br><span class="line">    &lt;div className=&quot;App&quot;&gt;</span><br><span class="line">      &lt;button onClick=&#123;onClickLogin&#125;&gt;login&lt;/button&gt;</span><br><span class="line">      &lt;button onClick=&#123;onClickRegister&#125;&gt;register&lt;/button&gt;</span><br><span class="line">      &lt;div&gt;&#123;ui === &quot;登录&quot; ? &lt;Login /&gt; : &lt;Register /&gt;&#125;&lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const rootElement = document.getElementById(&quot;root&quot;);</span><br><span class="line">ReactDOM.render(&lt;App /&gt;, rootElement);</span><br></pre></td></tr></table></figure>
<ul>
<li><a href="https://codesandbox.io/s/y2y4qvl3jx" target="_blank" rel="noopener">在线代码</a></li>
</ul>
<blockquote>
<p>需求来了，我现在想把链接分享给别人，如分享注册页面，结果链接打开还是登录</p>
</blockquote>
<h3 id="使用hash做路由"><a href="#使用hash做路由" class="headerlink" title="使用hash做路由"></a>使用hash做路由</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hash 就是锚点  就是url后面有个 &apos;#&apos;+path</span><br></pre></td></tr></table></figure>
<ul>
<li>[在线代码(<a href="https://codesandbox.io/s/n41xmw192l" target="_blank" rel="noopener">https://codesandbox.io/s/n41xmw192l</a>)</li>
<li><a href="https://k3x1jy7o2o.codesandbox.io/#login" target="_blank" rel="noopener">https://k3x1jy7o2o.codesandbox.io/#login</a></li>
<li><a href="https://k3x1jy7o2o.codesandbox.io/#register" target="_blank" rel="noopener">https://k3x1jy7o2o.codesandbox.io/#register</a></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">import React from &quot;react&quot;;</span><br><span class="line">import ReactDOM from &quot;react-dom&quot;;</span><br><span class="line">import &#123; useState &#125; from &quot;react&quot;;</span><br><span class="line">import &quot;./styles.css&quot;;</span><br><span class="line"></span><br><span class="line">function Login() &#123;</span><br><span class="line">  return &lt;div class=&quot;box&quot;&gt;登录&lt;/div&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function Register() &#123;</span><br><span class="line">  return &lt;div class=&quot;box&quot;&gt;注册&lt;/div&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function App() &#123;</span><br><span class="line">  let hash = window.location.hash;</span><br><span class="line">  // hash默认是带 &apos;#&apos;号的 </span><br><span class="line">  let initUi = hash === &apos;#register&apos;?&apos;注册&apos;:&apos;登录&apos;;</span><br><span class="line"></span><br><span class="line">  let [ui, setUi] = useState(&quot;登录&quot;);</span><br><span class="line">  let onClickLogin = () =&gt; &#123;</span><br><span class="line">    setUi(&quot;登录&quot;);</span><br><span class="line">    window.location.hash = &apos;login&apos;</span><br><span class="line">  &#125;;</span><br><span class="line">  let onClickRegister = () =&gt; &#123;</span><br><span class="line">    setUi(&quot;注册&quot;);</span><br><span class="line">    window.location.hash = &apos;register&apos;</span><br><span class="line">  &#125;;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div className=&quot;App&quot;&gt;</span><br><span class="line">      &lt;button onClick=&#123;onClickLogin&#125;&gt;login&lt;/button&gt;</span><br><span class="line">      &lt;button onClick=&#123;onClickRegister&#125;&gt;register&lt;/button&gt;</span><br><span class="line">      &lt;div&gt;&#123;ui === &quot;登录&quot; ? &lt;Login /&gt; : &lt;Register /&gt;&#125;&lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const rootElement = document.getElementById(&quot;root&quot;);</span><br><span class="line">ReactDOM.render(&lt;App /&gt;, rootElement);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>以上我们完成了</p>
</blockquote>
<ul>
<li>用户根据 hash 值来进入对应页面</li>
<li>虽然url有点丑，先忍着吧！</li>
</ul>
<h3 id="除了-hash-还能用什么"><a href="#除了-hash-还能用什么" class="headerlink" title="除了 hash 还能用什么"></a>除了 hash 还能用什么</h3><ul>
<li>window.location.pathname</li>
</ul>
<blockquote>
<p>location.pathname 的问题</p>
</blockquote>
<ul>
<li>修改路径会造成页面刷新</li>
<li>如果后台不进行url重定向(单页应用url指向index.html) 就会造成 404</li>
</ul>
<h3 id="不刷新修改页面路径的API——pushstate-API"><a href="#不刷新修改页面路径的API——pushstate-API" class="headerlink" title="不刷新修改页面路径的API——pushstate API"></a>不刷新修改页面路径的API——pushstate API</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">window.history.pushState(null,&apos;&apos;,&apos;/login&apos;)</span><br><span class="line">window.history.pushState(null,&apos;&apos;,&apos;/register&apos;)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>虽然这样改不造成页面刷新</p>
</blockquote>
<p>但是</p>
<ul>
<li>如果后台不进行url重写 就会报 404 如 <a href="https://www.baidu.com/login" target="_blank" rel="noopener">https://www.baidu.com/login</a></li>
<li>codesendbox不会404是因为 服务器配置好了。</li>
</ul>
<blockquote>
<h4 id="三种方式"><a href="#三种方式" class="headerlink" title="三种方式"></a>三种方式</h4></blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">window.location.hash = // 让url变化同时不刷新页面</span><br><span class="line">✅ </span><br><span class="line"></span><br><span class="line">window.location.pathname =  // 会刷新页面 ，基本不考虑</span><br><span class="line">x 肯定不用这个</span><br><span class="line"></span><br><span class="line">window.history.pushState(null,&apos;&apos;,path) // 不刷新页面，修改路径 </span><br><span class="line">? 这个是不确定的</span><br><span class="line">    因为有两种情况</span><br><span class="line">        1. 后端会将所有路径指向首页 就可以这样做</span><br><span class="line">        2. 后端傻X 那你就放弃吧</span><br><span class="line">        3. 既然后端傻X，那你就学node自己做后端控制url 抢他饭碗</span><br></pre></td></tr></table></figure>
<blockquote>
<p>什么叫url指向首页</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">你可以在codesendbox里 创建一个react项目 然后在浏览器的路径后随便修改</span><br><span class="line">输入如下路径都进入首页</span><br><span class="line"></span><br><span class="line">https://www.xxx.com/xxx</span><br><span class="line">https://www.xxx.com/bbb</span><br><span class="line">https://www.xxx.com/ccc</span><br><span class="line">https://www.xxx.com/fuck</span><br><span class="line">https://www.xxx.com/shit</span><br></pre></td></tr></table></figure>
<blockquote>
<p>最稳妥的方式是用 hash 100%没问题<br>最不靠谱的是用 pathname 因为会刷新页面<br>有个靠谱后端的情况下 用 pushState 或者你会nodeJs自己 控制url指向 index.html</p>
</blockquote>
<h3 id="用pushState实现路由"><a href="#用pushState实现路由" class="headerlink" title="用pushState实现路由"></a>用pushState实现路由</h3><p>index.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">import React from &quot;react&quot;;</span><br><span class="line">import ReactDOM from &quot;react-dom&quot;;</span><br><span class="line">import &#123; useState &#125; from &quot;react&quot;;</span><br><span class="line">import &quot;./styles.css&quot;;</span><br><span class="line"></span><br><span class="line">function Login() &#123;</span><br><span class="line">  return &lt;div className=&quot;box&quot;&gt;登录&lt;/div&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function Register() &#123;</span><br><span class="line">  return &lt;div className=&quot;box&quot;&gt;注册&lt;/div&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function App() &#123;</span><br><span class="line">  let path = window.location.pathname;</span><br><span class="line">  // hash默认是带 &apos;#&apos;号的</span><br><span class="line">  let initUi = path === &quot;/register&quot; ? &quot;注册&quot; : &quot;登录&quot;;</span><br><span class="line">  console.log(initUi);</span><br><span class="line">  let [ui, setUi] = useState(initUi);</span><br><span class="line">  let onClickLogin = () =&gt; &#123;</span><br><span class="line">    setUi(&quot;登录&quot;);</span><br><span class="line">    history.pushState(null, &quot;&quot;, &quot;login&quot;);</span><br><span class="line">  &#125;;</span><br><span class="line">  let onClickRegister = () =&gt; &#123;</span><br><span class="line">    setUi(&quot;注册&quot;);</span><br><span class="line">    history.pushState(null, &quot;&quot;, &quot;register&quot;);</span><br><span class="line">  &#125;;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div className=&quot;App&quot;&gt;</span><br><span class="line">      &lt;button onClick=&#123;onClickLogin&#125;&gt;login&lt;/button&gt;</span><br><span class="line">      &lt;button onClick=&#123;onClickRegister&#125;&gt;register&lt;/button&gt;</span><br><span class="line">      &lt;div&gt;&#123;ui === &quot;登录&quot; ? &lt;Login /&gt; : &lt;Register /&gt;&#125;&lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const rootElement = document.getElementById(&quot;root&quot;);</span><br><span class="line">ReactDOM.render(&lt;App /&gt;, rootElement);</span><br></pre></td></tr></table></figure>
<ul>
<li><a href="https://4qqoy05wo9.codesandbox.io/register" target="_blank" rel="noopener">https://4qqoy05wo9.codesandbox.io/register</a></li>
<li><a href="https://4qqoy05wo9.codesandbox.io/login" target="_blank" rel="noopener">https://4qqoy05wo9.codesandbox.io/login</a></li>
<li><a href="https://codesandbox.io/s/kwz7j1w7or" target="_blank" rel="noopener">在线代码</a></li>
</ul>
<blockquote>
<p>分析：现在可以解决路由问题了</p>
</blockquote>
<blockquote>
<h4 id="新的问题：无穷多个路由的时候怎么办"><a href="#新的问题：无穷多个路由的时候怎么办" class="headerlink" title="新的问题：无穷多个路由的时候怎么办"></a>新的问题：无穷多个路由的时候怎么办</h4></blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">- login</span><br><span class="line">- register</span><br><span class="line">- index</span><br><span class="line">- trade</span><br><span class="line">- user   // 用户列表</span><br><span class="line">- user/1 //  用户id为1的</span><br><span class="line">- user/2 //  用户id为2的</span><br><span class="line">- ...</span><br><span class="line">- user/100  //用户id为100的</span><br><span class="line"></span><br><span class="line">此时 </span><br><span class="line"></span><br><span class="line">if else 明显不够用</span><br></pre></td></tr></table></figure>
<blockquote>
<p>使用库ReactRouter</p>
</blockquote>
<h3 id="ReactRouter"><a href="#ReactRouter" class="headerlink" title="ReactRouter"></a>ReactRouter</h3><ul>
<li>强烈建议看英文文档</li>
<li>强烈建议看英文文档</li>
<li><p>强烈建议看英文文档</p>
</li>
<li><p><a href="http://react-guide.github.io/react-router-cn/" target="_blank" rel="noopener">这个文档是中文的但是用的是老版本也就是过时的网页，各种问题</a> </p>
</li>
<li><p>你可以打开github 搜 router 选择 react的router <a href="https://github.com/ReactTraining/react-router" target="_blank" rel="noopener">https://github.com/ReactTraining/react-router</a></p>
</li>
<li><p>或者 google 搜 react router 得到一个网址<a href="https://github.com/ReactTraining/react-router" target="_blank" rel="noopener">https://github.com/ReactTraining/react-router</a></p>
</li>
<li><p><a href="https://reacttraining.com/react-router/" target="_blank" rel="noopener">点击预览链接</a></p>
</li>
<li><p><a href="https://reacttraining.com/react-router/web/guides/quick-start" target="_blank" rel="noopener">选择web</a></p>
</li>
<li><p>开始抄</p>
</li>
</ul>
<p>初始化依赖(如果你用的create-react-app命令)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">npm install -g create-react-app</span><br><span class="line">create-react-app demo-app</span><br><span class="line">cd demo-app</span><br><span class="line"></span><br><span class="line">npm install react-router-dom</span><br></pre></td></tr></table></figure>
<p>如果你用的 codesendbox.io 那就直接安装依赖 react-router-dom</p>
<p>index.js <a href="https://codesandbox.io/s/m781mqxooy" target="_blank" rel="noopener">在线代码</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">import React from &quot;react&quot;;</span><br><span class="line">import ReactDOM from &quot;react-dom&quot;;</span><br><span class="line">import &#123; BrowserRouter as Router, Route, Link &#125; from &quot;react-router-dom&quot;;</span><br><span class="line"></span><br><span class="line">const Index = () =&gt; &lt;h2&gt;Home&lt;/h2&gt;;</span><br><span class="line">const About = () =&gt; &lt;h2&gt;About&lt;/h2&gt;;</span><br><span class="line">const Users = () =&gt; &lt;h2&gt;Users&lt;/h2&gt;;</span><br><span class="line"></span><br><span class="line">function App() &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div className=&quot;App&quot;&gt;</span><br><span class="line">      &lt;Router&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          &lt;nav&gt;</span><br><span class="line">            &lt;ul&gt;</span><br><span class="line">              &lt;li&gt;</span><br><span class="line">                &lt;Link to=&quot;/&quot;&gt;Home&lt;/Link&gt;</span><br><span class="line">              &lt;/li&gt;</span><br><span class="line">              &lt;li&gt;</span><br><span class="line">                &lt;Link to=&quot;/about/&quot;&gt;About&lt;/Link&gt;</span><br><span class="line">              &lt;/li&gt;</span><br><span class="line">              &lt;li&gt;</span><br><span class="line">                &lt;Link to=&quot;/users/&quot;&gt;Users&lt;/Link&gt;</span><br><span class="line">              &lt;/li&gt;</span><br><span class="line">            &lt;/ul&gt;</span><br><span class="line">          &lt;/nav&gt;</span><br><span class="line"></span><br><span class="line">          &lt;Route path=&quot;/&quot; exact component=&#123;Index&#125; /&gt;</span><br><span class="line">          &lt;Route path=&quot;/about/&quot; component=&#123;About&#125; /&gt;</span><br><span class="line">          &lt;Route path=&quot;/users/&quot; component=&#123;Users&#125; /&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/Router&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const rootElement = document.getElementById(&quot;root&quot;);</span><br><span class="line">ReactDOM.render(&lt;App /&gt;, rootElement);</span><br></pre></td></tr></table></figure>
<p>唯一的坑在这里</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import &#123; BrowserRouter as Router, Route, Link &#125; from &quot;react-router-dom&quot;;</span><br></pre></td></tr></table></figure>
<p>如果是你？ 你搜索后会选择去中文文档还是英文的？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">中文——给你个例子——死活运行不了</span><br><span class="line"></span><br><span class="line">英文——照着抄 (少走弯路)</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/01/23/React入门008之Router/" data-id="cklcb6bn500pkwo91dz2tw2gb" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React入门/">React入门</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-React入门007之Hooks" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/01/22/React入门007之Hooks/" class="article-date">
  <time datetime="2019-01-22T13:17:32.000Z" itemprop="datePublished">2019-01-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/01/22/React入门007之Hooks/">React入门007之Hooks</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="Hooks"><a href="#Hooks" class="headerlink" title="Hooks"></a>Hooks</h3><ul>
<li><p>英文教程<a href="https://reactjs.org/docs/hooks-intro.html" target="_blank" rel="noopener">there</a> and <a href="https://reactjs.org/docs/hooks-reference.html" target="_blank" rel="noopener">there</a></p>
</li>
<li><p>中午教程<a href="https://github.com/dt-fe/weekly/blob/master/79.%E7%B2%BE%E8%AF%BB%E3%80%8AReact%20Hooks%E3%80%8B.md" target="_blank" rel="noopener">这里</a></p>
</li>
</ul>
<p>React新的API最新支持Hooks版本为16.7,需要单独安装</p>
<blockquote>
<p>那么开始</p>
</blockquote>
<ol>
<li>在 <a href="https://codesandbox.io/" target="_blank" rel="noopener">https://codesandbox.io/</a>上新建一个react项目</li>
<li>在Dependencies上能看到React的版本(hooks的支持要求16.7.0-alpha)</li>
<li><p>修改package.json</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> &quot;dependencies&quot;: &#123;</span><br><span class="line">    &quot;react&quot;: &quot;16.7.0-alpha&quot;,</span><br><span class="line">    &quot;react-dom&quot;: &quot;16.7.0-alpha&quot;,</span><br><span class="line">    &quot;react-scripts&quot;: &quot;2.0.3&quot;</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">//此时保存报错了</span><br><span class="line">// 在命令行查看react的所有版本</span><br><span class="line">npm info react versions</span><br><span class="line">// 查看最新版本</span><br><span class="line">npm info react versions</span><br><span class="line"></span><br><span class="line">//再次修改 package.json</span><br><span class="line"></span><br><span class="line">&quot;dependencies&quot;: &#123;</span><br><span class="line">    &quot;react&quot;: &quot;16.7.0-alpha.2&quot;,</span><br><span class="line">    &quot;react-dom&quot;: &quot;16.7.0-alpha.2&quot;,</span><br><span class="line">    &quot;react-scripts&quot;: &quot;2.0.3&quot;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
</li>
<li><p>开始写我们的react应用 index.js</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import React from &quot;react&quot;;</span><br><span class="line">import ReactDOM from &quot;react-dom&quot;;</span><br><span class="line"></span><br><span class="line">function App() &#123;</span><br><span class="line">    return &lt;div className=&quot;App&quot;&gt;hello&lt;/div&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const rootElement = document.getElementById(&quot;root&quot;);</span><br><span class="line">ReactDOM.render(&lt;App /&gt;, rootElement);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="useState使用"><a href="#useState使用" class="headerlink" title="useState使用"></a>useState使用</h3><blockquote>
<p>有状态的函数组件</p>
</blockquote>
<p>16.7以前只有class组件有状态，16.7开始，函数是可以有状态的</p>
<p>index.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">import React from &quot;react&quot;;</span><br><span class="line">import ReactDOM from &quot;react-dom&quot;;</span><br><span class="line"></span><br><span class="line">// step01 引入 useState</span><br><span class="line">import &#123; useState &#125; from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">function App() &#123;</span><br><span class="line">  // 这样定义肯定不行</span><br><span class="line">  // let count = 0;</span><br><span class="line">  // let add = function()&#123;&#125;</span><br><span class="line"></span><br><span class="line">  // 正确定义状态</span><br><span class="line">  const [count, setCount] = useState(0); //count 初始值是 0</span><br><span class="line">  const add = () =&gt; &#123;</span><br><span class="line">    setCount(count + 1);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  const minus = () =&gt; &#123;</span><br><span class="line">    setCount(count - 1);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;div&gt;&#123;count&#125;&lt;/div&gt;</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;button onClick=&#123;add&#125;&gt;+1&lt;/button&gt;</span><br><span class="line">        &lt;button onClick=&#123;minus&#125;&gt;-1&lt;/button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const rootElement = document.getElementById(&quot;root&quot;);</span><br><span class="line">ReactDOM.render(&lt;App /&gt;, rootElement);</span><br></pre></td></tr></table></figure>
<p><a href="https://codesandbox.io/s/86j8zn7ll" target="_blank" rel="noopener">代码</a></p>
<p>核心代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">const [ </span><br><span class="line">        count, // 值</span><br><span class="line">        setCount // 更新函数</span><br><span class="line">    ] = useState(0); </span><br><span class="line"></span><br><span class="line">// useState 函数会返回一个数组</span><br><span class="line">// 数组第一项表示 count的值</span><br><span class="line">// 数组第二项表示 count的更新函数</span><br></pre></td></tr></table></figure>
<blockquote>
<h4 id="自从有了useState之后，就不需要一个class去维护状态"><a href="#自从有了useState之后，就不需要一个class去维护状态" class="headerlink" title="自从有了useState之后，就不需要一个class去维护状态"></a>自从有了useState之后，就不需要一个class去维护状态</h4></blockquote>
<ul>
<li>直接 useState(初始值)</li>
<li>setCount(count+1)  /  setCount(count -1) 就可以改变状态</li>
</ul>
<p>而如果用之前的class组件写法是这样的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">// 用 class写组件</span><br><span class="line">class App2 extends React.Component &#123;</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    super();</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      count: 0</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  add() &#123;</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      count: this.state.count + 1</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  minus() &#123;</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      count: this.state.count - 1</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        app2</span><br><span class="line">        &lt;div&gt;&#123;this.state.count&#125;&lt;/div&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          &lt;button onClick=&#123;this.add.bind(this)&#125;&gt;+1&lt;/button&gt;</span><br><span class="line">          &lt;button onClick=&#123;this.minus.bind(this)&#125;&gt;-1&lt;/button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>结论就是：</p>
</blockquote>
<ul>
<li>用了hooks 之后语法简介了很多</li>
<li>再也不用class的方式写组件了</li>
<li>注意要将react升级到16.7.0</li>
<li>同时这里可以很爽的给数据赋值，不用setState了</li>
</ul>
<h4 id="useState的更多例子"><a href="#useState的更多例子" class="headerlink" title="useState的更多例子"></a>useState的更多例子</h4><p>复杂对象如何修改值？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">import React from &quot;react&quot;;</span><br><span class="line">import ReactDOM from &quot;react-dom&quot;;</span><br><span class="line"></span><br><span class="line">// step01 引入 useState</span><br><span class="line">import &#123; useState &#125; from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">function App() &#123;</span><br><span class="line">  const [count, setCount] = useState(0); //count 初始值是 0</span><br><span class="line">  const [user, setUser] = useState(&#123; name: &quot;hjx&quot;, age: 18 &#125;);</span><br><span class="line"></span><br><span class="line">  const add = () =&gt; &#123;</span><br><span class="line">    setCount(count + 1);</span><br><span class="line">  &#125;;</span><br><span class="line">  const minus = () =&gt; &#123;</span><br><span class="line">    setCount(count - 1);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  const addAge = () =&gt; &#123;</span><br><span class="line">    setUser(&#123;</span><br><span class="line">      ...user,</span><br><span class="line">      age: user.age + 1</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;div&gt;&#123;count&#125;&lt;/div&gt;</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;button onClick=&#123;add&#125;&gt;+1&lt;/button&gt;</span><br><span class="line">        &lt;button onClick=&#123;minus&#125;&gt;-1&lt;/button&gt;</span><br><span class="line">        &lt;hr /&gt;</span><br><span class="line">        userInfo:姓名 &#123;user.name&#125; 年纪&#123;user.age&#125;</span><br><span class="line">        &lt;button onClick=&#123;addAge&#125;&gt;age++&lt;/button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const rootElement = document.getElementById(&quot;root&quot;);</span><br><span class="line">ReactDOM.render(&lt;App /&gt;, rootElement);</span><br></pre></td></tr></table></figure>
<ul>
<li><a href="https://codesandbox.io/s/km4n666z2r" target="_blank" rel="noopener">线上代码</a></li>
</ul>
<blockquote>
<p>user添加爱好 hobbies</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">import React from &quot;react&quot;;</span><br><span class="line">import ReactDOM from &quot;react-dom&quot;;</span><br><span class="line"></span><br><span class="line">// step01 引入 useState</span><br><span class="line">import &#123; useState &#125; from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">function App() &#123;</span><br><span class="line">  const [count, setCount] = useState(0); //count 初始值是 0</span><br><span class="line">  const [user, setUser] = useState(&#123;</span><br><span class="line">    name: &quot;hjx&quot;,</span><br><span class="line">    age: 18,</span><br><span class="line">    hobbies: [&quot;火影&quot;, &quot;编程&quot;, &quot;王者&quot;]</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  const add = () =&gt; &#123;</span><br><span class="line">    setCount(count + 1);</span><br><span class="line">  &#125;;</span><br><span class="line">  const minus = () =&gt; &#123;</span><br><span class="line">    setCount(count - 1);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  const addAge = () =&gt; &#123;</span><br><span class="line">    setUser(&#123;</span><br><span class="line">      ...user,</span><br><span class="line">      age: user.age + 1</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  const addHobbie = () =&gt; &#123;</span><br><span class="line">    let num = parseInt(Math.random() * 100);</span><br><span class="line">    setUser(&#123;</span><br><span class="line">      ...user,</span><br><span class="line">      hobbies: [...user.hobbies, num]</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;div&gt;&#123;count&#125;&lt;/div&gt;</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;button onClick=&#123;add&#125;&gt;+1&lt;/button&gt;</span><br><span class="line">        &lt;button onClick=&#123;minus&#125;&gt;-1&lt;/button&gt;</span><br><span class="line">        &lt;hr /&gt;</span><br><span class="line">        userInfo:姓名 &#123;user.name&#125; 年纪&#123;user.age&#125;</span><br><span class="line">        &lt;button onClick=&#123;addAge&#125;&gt;age++&lt;/button&gt;</span><br><span class="line">        &lt;hr /&gt;</span><br><span class="line">        爱好：&#123;user.hobbies.join(&quot;,&quot;)&#125;</span><br><span class="line">        &lt;button onClick=&#123;addHobbie&#125;&gt;Hobbie++&lt;/button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const rootElement = document.getElementById(&quot;root&quot;);</span><br><span class="line">ReactDOM.render(&lt;App /&gt;, rootElement);</span><br></pre></td></tr></table></figure>
<ul>
<li><a href="https://codesandbox.io/s/jn8rmnvo35" target="_blank" rel="noopener">在线代码</a></li>
</ul>
<blockquote>
<p>删除 hobbies第二项怎么处理</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">import React from &quot;react&quot;;</span><br><span class="line">import ReactDOM from &quot;react-dom&quot;;</span><br><span class="line"></span><br><span class="line">// step01 引入 useState</span><br><span class="line">import &#123; useState &#125; from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">function App() &#123;</span><br><span class="line">  const [count, setCount] = useState(0); //count 初始值是 0</span><br><span class="line">  const [user, setUser] = useState(&#123;</span><br><span class="line">    name: &quot;hjx&quot;,</span><br><span class="line">    age: 18,</span><br><span class="line">    hobbies: [&quot;火影&quot;, &quot;编程&quot;, &quot;王者&quot;]</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  const add = () =&gt; &#123;</span><br><span class="line">    setCount(count + 1);</span><br><span class="line">  &#125;;</span><br><span class="line">  const minus = () =&gt; &#123;</span><br><span class="line">    setCount(count - 1);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  const addAge = () =&gt; &#123;</span><br><span class="line">    setUser(&#123;</span><br><span class="line">      ...user,</span><br><span class="line">      age: user.age + 1</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  const addHobbie = () =&gt; &#123;</span><br><span class="line">    let num = parseInt(Math.random() * 100);</span><br><span class="line">    setUser(&#123;</span><br><span class="line">      ...user,</span><br><span class="line">      hobbies: [...user.hobbies, num]</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  const removeHobbie = () =&gt; &#123;</span><br><span class="line">    user.hobbies.splice(1, 1);</span><br><span class="line">    setUser(&#123;</span><br><span class="line">      ...user,</span><br><span class="line">      hobbies: [...user.hobbies]</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;div&gt;&#123;count&#125;&lt;/div&gt;</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;button onClick=&#123;add&#125;&gt;+1&lt;/button&gt;</span><br><span class="line">        &lt;button onClick=&#123;minus&#125;&gt;-1&lt;/button&gt;</span><br><span class="line">        &lt;hr /&gt;</span><br><span class="line">        userInfo:姓名 &#123;user.name&#125; 年纪&#123;user.age&#125;</span><br><span class="line">        &lt;button onClick=&#123;addAge&#125;&gt;age++&lt;/button&gt;</span><br><span class="line">        &lt;hr /&gt;</span><br><span class="line">        爱好：&#123;user.hobbies.join(&quot;,&quot;)&#125;</span><br><span class="line">        &lt;button onClick=&#123;addHobbie&#125;&gt;Hobbie++&lt;/button&gt;</span><br><span class="line">        &lt;button onClick=&#123;removeHobbie&#125;&gt;删除第二个Hobbie&lt;/button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const rootElement = document.getElementById(&quot;root&quot;);</span><br><span class="line">ReactDOM.render(&lt;App /&gt;, rootElement);</span><br></pre></td></tr></table></figure>
<ul>
<li><a href="https://codesandbox.io/s/rjzzpypmko" target="_blank" rel="noopener">在线代码</a></li>
</ul>
<blockquote>
<p>以上就是hooks的基本使用</p>
</blockquote>
<blockquote>
<h4 id="疑问？能不能将-const-count-setCount-useState-0-放在函数组件外"><a href="#疑问？能不能将-const-count-setCount-useState-0-放在函数组件外" class="headerlink" title="疑问？能不能将 const [count, setCount] = useState(0) 放在函数组件外"></a>疑问？能不能将 const [count, setCount] = useState(0) 放在函数组件外</h4></blockquote>
<ul>
<li>这是API没有告诉我们的，会报错</li>
<li>没有为什么，就是不准</li>
</ul>
<blockquote>
<h4 id="疑问2-能不能修改-const-count-setCount-useState-0-名字"><a href="#疑问2-能不能修改-const-count-setCount-useState-0-名字" class="headerlink" title="疑问2 能不能修改  const [count, setCount] = useState(0) 名字"></a>疑问2 能不能修改  const [count, setCount] = useState(0) 名字</h4></blockquote>
<ul>
<li>可以</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">const [x, y] = useState(0)</span><br><span class="line">const add = () =&gt; &#123;</span><br><span class="line">    y(x + 1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="useEffect使用"><a href="#useEffect使用" class="headerlink" title="useEffect使用"></a>useEffect使用</h3><ul>
<li><a href="https://reactjs.org/docs/hooks-effect.html" target="_blank" rel="noopener">文档</a></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//没有作用的函数</span><br><span class="line">function fn()&#123;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// 有作用的函数</span><br><span class="line">function fn2()&#123; console.log(1) &#125;</span><br><span class="line"></span><br><span class="line">// 有作用的函数</span><br><span class="line">function fn3(a,b)&#123; return a + b &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// fn2 和 fn3 的区别</span><br><span class="line">// fn2会让人有疑问 哪里来的 console</span><br><span class="line">// fn3 不会让人有  a,b是哪里来的感觉</span><br></pre></td></tr></table></figure>
<blockquote>
<p>如果你在函数里看到了 不知道从哪里来的东西  这个函数就是有副作用的函数</p>
</blockquote>
<ul>
<li>因为它依赖了<a href="比如你把家里收拾的很干净，此时突然从窗户里飘来个塑料袋，你就会觉得这东西不好">不知道从哪里来的东西</a></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// 来看什么是副作用</span><br><span class="line">function fn2()&#123; console.log(1) &#125;</span><br><span class="line"></span><br><span class="line">fn2() //打印 1</span><br><span class="line"></span><br><span class="line">fn2() //打印 1</span><br><span class="line"></span><br><span class="line">console.log = function()&#123; &#125;</span><br><span class="line"></span><br><span class="line">fn2() //什么都不打印</span><br><span class="line"></span><br><span class="line">// 如果你依赖的东西不知道从哪里来的</span><br><span class="line">// 如果这个东西突然有一天被人改了，你也不知道</span><br><span class="line">// 这就是 有副作用的函数的问题</span><br><span class="line"></span><br><span class="line">// 再看 fn3 无论你怎么修改 都是返回 a+b的结果 </span><br><span class="line">// fn3就叫做——纯函数 (不依赖外部不知道哪里来的东西的函数)</span><br></pre></td></tr></table></figure>
<blockquote>
<h4 id="什么情况下用-effect"><a href="#什么情况下用-effect" class="headerlink" title="什么情况下用 effect"></a>什么情况下用 effect</h4></blockquote>
<p>在 index.html 里添加一个节点元素 id=box1</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;box1&quot; style=&quot;border:1px solid red;&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;div id=&quot;root&quot;&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<p>index.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">import React from &quot;react&quot;;</span><br><span class="line">import ReactDOM from &quot;react-dom&quot;;</span><br><span class="line"></span><br><span class="line">// step01 引入 useState</span><br><span class="line">import &#123; useState, useEffect &#125; from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">function App() &#123;</span><br><span class="line">  const [count, setCount] = useState(0); //count 初始值是 0</span><br><span class="line"></span><br><span class="line">  const add = () =&gt; &#123;</span><br><span class="line">    setCount(count + 1);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  useEffect(() =&gt; &#123;</span><br><span class="line">    // 你不知道 box1是从哪里来的</span><br><span class="line">    document.querySelector(&quot;#box1&quot;).innerText = count;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;div&gt;&#123;count&#125;&lt;/div&gt;</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;button onClick=&#123;add&#125;&gt;+1&lt;/button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const rootElement = document.getElementById(&quot;root&quot;);</span><br><span class="line">ReactDOM.render(&lt;App /&gt;, rootElement);</span><br></pre></td></tr></table></figure>
<ul>
<li><a href="https://codesandbox.io/s/njy6zq7n0" target="_blank" rel="noopener">线上代码</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/01/22/React入门007之Hooks/" data-id="cklcb6bn700pqwo917jx74fvp" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React入门/">React入门</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-React入门006之ContextApi03换肤功能" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/01/17/React入门006之ContextApi03换肤功能/" class="article-date">
  <time datetime="2019-01-17T14:08:43.000Z" itemprop="datePublished">2019-01-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/01/17/React入门006之ContextApi03换肤功能/">React入门006之ContextApi03换肤功能</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="换肤功能"><a href="#换肤功能" class="headerlink" title="换肤功能"></a>换肤功能</h3><ul>
<li><a href="https://codesandbox.io/s/l7k39r562q" target="_blank" rel="noopener">在线代码</a></li>
</ul>
<p>index.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">import React from &quot;react&quot;;</span><br><span class="line">import ReactDOM from &quot;react-dom&quot;;</span><br><span class="line"></span><br><span class="line">import &quot;./styles.css&quot;;</span><br><span class="line"></span><br><span class="line">const themeContext = React.createContext();</span><br><span class="line"></span><br><span class="line">function Button() &#123;</span><br><span class="line">  return &lt;button&gt;button&lt;/button&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function Input() &#123;</span><br><span class="line">  return &lt;input /&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function Box(props) &#123;</span><br><span class="line">  return &lt;div className=&#123;`box $&#123;props.theme&#125;`&#125;&gt;&#123;props.children&#125;&lt;/div&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class App extends React.Component &#123;</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    super();</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      theme: &quot;light&quot;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  change() &#123;</span><br><span class="line">    let res = this.state.theme === &quot;green&quot; ? &quot;red&quot; : &quot;green&quot;;</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      theme: res</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;themeContext.Provider value=&#123;this.state.theme&#125;&gt;</span><br><span class="line">        &lt;div className=&quot;App&quot;&gt;</span><br><span class="line">          &lt;button onClick=&#123;this.change.bind(this)&#125;&gt;换肤&lt;/button&gt;</span><br><span class="line">          &lt;themeContext.Consumer&gt;</span><br><span class="line">            &#123;theme =&gt; &#123;</span><br><span class="line">              return (</span><br><span class="line">                &lt;div&gt;</span><br><span class="line">                  &lt;Box theme=&#123;theme&#125;&gt;</span><br><span class="line">                    &lt;Button /&gt;</span><br><span class="line">                  &lt;/Box&gt;</span><br><span class="line">                  &lt;Box theme=&#123;theme&#125;&gt;</span><br><span class="line">                    &lt;Input /&gt;</span><br><span class="line">                  &lt;/Box&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">              );</span><br><span class="line">            &#125;&#125;</span><br><span class="line">          &lt;/themeContext.Consumer&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/themeContext.Provider&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const rootElement = document.getElementById(&quot;root&quot;);</span><br><span class="line">ReactDOM.render(&lt;App /&gt;, rootElement);</span><br></pre></td></tr></table></figure>
<p>style.css</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">.App &#123;</span><br><span class="line">  font-family: sans-serif;</span><br><span class="line">  text-align: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.box.green &#123;</span><br><span class="line">  border: 1px solid green;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.box.red &#123;</span><br><span class="line">  border: 1px solid red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/01/17/React入门006之ContextApi03换肤功能/" data-id="cklcb6bn600pmwo91s6zau1w3" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React入门/">React入门</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-React入门006之ContextApi02" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/01/17/React入门006之ContextApi02/" class="article-date">
  <time datetime="2019-01-17T13:41:14.000Z" itemprop="datePublished">2019-01-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/01/17/React入门006之ContextApi02/">React入门006之ContextApi02</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p> 继续上一篇内容 </p>
</blockquote>
<h3 id="ContextApi"><a href="#ContextApi" class="headerlink" title="ContextApi"></a>ContextApi</h3><blockquote>
<h4 id="如果我想修改传递的n呢？"><a href="#如果我想修改传递的n呢？" class="headerlink" title="如果我想修改传递的n呢？"></a>如果我想修改传递的n呢？</h4></blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">import React from &quot;react&quot;;</span><br><span class="line">import ReactDOM from &quot;react-dom&quot;;</span><br><span class="line"></span><br><span class="line">import &quot;./styles.css&quot;;</span><br><span class="line"></span><br><span class="line">function F1() &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div className=&quot;box&quot;&gt;</span><br><span class="line">      1111</span><br><span class="line">      &lt;F2 /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line">function F2() &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div className=&quot;box&quot;&gt;</span><br><span class="line">      2222</span><br><span class="line">      &lt;F3 /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line">function F3() &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div className=&quot;box&quot;&gt;</span><br><span class="line">      3333</span><br><span class="line">      &lt;nContext.Consumer&gt;</span><br><span class="line">        &#123;xxx =&gt; &lt;F4 n4=&#123;xxx.n&#125; setN=&#123;xxx.setN&#125; /&gt;&#125;</span><br><span class="line">      &lt;/nContext.Consumer&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line">function F4(props) &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div className=&quot;box&quot;&gt;</span><br><span class="line">      4444,&#123;props.n4&#125;</span><br><span class="line">      &lt;button onClick=&#123;props.setN&#125;&gt;Click ME&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const nContext = React.createContext();</span><br><span class="line"></span><br><span class="line">class App extends React.Component &#123;</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    super();</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      x: &#123;</span><br><span class="line">        n: 100,</span><br><span class="line">        setN: () =&gt; &#123;</span><br><span class="line">          this.setState(&#123;</span><br><span class="line">            x: &#123;</span><br><span class="line">              ...this.state.x,</span><br><span class="line">              n: this.state.x.n + 1</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;nContext.Provider value=&#123;this.state.x&#125;&gt;</span><br><span class="line">          &lt;F1 /&gt;</span><br><span class="line">        &lt;/nContext.Provider&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const rootElement = document.getElementById(&quot;root&quot;);</span><br><span class="line">ReactDOM.render(&lt;App /&gt;, rootElement);</span><br></pre></td></tr></table></figure>
<ul>
<li><a href="https://codesandbox.io/s/o7opop6m5q" target="_blank" rel="noopener">代码链接</a></li>
</ul>
<blockquote>
<p>以前我们传递值</p>
</blockquote>
<ul>
<li>需要一层一层的传递</li>
</ul>
<blockquote>
<p>现在有了 ContextAPI</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">//在根节点包裹一个 nContext</span><br><span class="line">return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">    &lt;nContext.Provider value=&#123;obj&#125;&gt;</span><br><span class="line">        &lt;F1 /&gt;</span><br><span class="line">    &lt;/nContext.Provider&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">obj&#123;</span><br><span class="line">    store,</span><br><span class="line">    setStore()</span><br><span class="line">&#125;</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">// 后代任意层级想要使用  只需要包裹一个 </span><br><span class="line">&lt;nContext.Consumer&gt;</span><br><span class="line">    &#123;(obj)=&gt;&#123;return &lt;div&gt;&#123;obj&#125;&lt;/div&gt;&#125;&#125;</span><br><span class="line">&lt;/nContext.Consumer&gt;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/01/17/React入门006之ContextApi02/" data-id="cklcb6bn300pgwo91mw98pvy5" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React入门/">React入门</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-React入门006之ContextApi" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/01/16/React入门006之ContextApi/" class="article-date">
  <time datetime="2019-01-16T14:43:56.000Z" itemprop="datePublished">2019-01-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/01/16/React入门006之ContextApi/">React入门006之ContextApi</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="预习内容"><a href="#预习内容" class="headerlink" title="预习内容"></a>预习内容</h3><ul>
<li><a href="https://reactjs.org/docs/context.html" target="_blank" rel="noopener">Context</a></li>
<li><a href="https://react.docschina.org/docs/context.html#when-to-use-context" target="_blank" rel="noopener">Context中文版</a></li>
</ul>
<blockquote>
<p>在线IDE</p>
</blockquote>
<ul>
<li><a href="https://codesandbox.io/" target="_blank" rel="noopener">CodeSandBox</a></li>
</ul>
<blockquote>
<h4 id="先看代码"><a href="#先看代码" class="headerlink" title="先看代码"></a>先看代码</h4></blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">function f1() &#123;</span><br><span class="line">  console.log(1);</span><br><span class="line">  f2();</span><br><span class="line">&#125;</span><br><span class="line">function f2() &#123;</span><br><span class="line">  console.log(2);</span><br><span class="line">  f3();</span><br><span class="line">&#125;</span><br><span class="line">function f3() &#123;</span><br><span class="line">  console.log(3);</span><br><span class="line">  f4();</span><br><span class="line">&#125;</span><br><span class="line">function f4() &#123;</span><br><span class="line">  console.log(4);</span><br><span class="line">&#125;</span><br><span class="line">f1();</span><br><span class="line">console.log(&quot;done&quot;);</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">done</span><br><span class="line">*/</span><br></pre></td></tr></table></figure>
<p>再看</p>
<blockquote>
<p>f1多了一个 参数 n1<br> 我想要后面的每一个函数都能获取这个 n1<br> 咋办？</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">function f1(n1) &#123;</span><br><span class="line">  console.log(1,n1);</span><br><span class="line">  f2(n1);</span><br><span class="line">&#125;</span><br><span class="line">function f2(n2) &#123;</span><br><span class="line">  //这里的 n2就是 f1里的 n1</span><br><span class="line">  console.log(2,n2);</span><br><span class="line">  f3(n2);</span><br><span class="line">&#125;</span><br><span class="line">function f3(n3) &#123;</span><br><span class="line">  console.log(3,n3);</span><br><span class="line">  f4(n3);</span><br><span class="line">&#125;</span><br><span class="line">function f4(n4) &#123;</span><br><span class="line">  console.log(4,n4);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    let n = 100;</span><br><span class="line">    f1( n );</span><br><span class="line">    console.log(&quot;done&quot;);</span><br><span class="line">&#125;</span><br><span class="line">/*</span><br><span class="line">函数里的函数 得到n</span><br><span class="line">现在则需要 层层传递</span><br><span class="line">*/</span><br></pre></td></tr></table></figure>
<ul>
<li><a href="https://codesandbox.io/s/l9rrqj8zyz" target="_blank" rel="noopener">VanillaJS版本</a></li>
</ul>
<blockquote>
<p>react 4层组件里实现上面的逻辑</p>
</blockquote>
<ul>
<li><a href="https://codesandbox.io/s/jp647nl355" target="_blank" rel="noopener">React版本</a></li>
</ul>
<p>index.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">import React from &quot;react&quot;;</span><br><span class="line">import ReactDOM from &quot;react-dom&quot;;</span><br><span class="line"></span><br><span class="line">import &quot;./styles.css&quot;;</span><br><span class="line"></span><br><span class="line">function F1(props) &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;1111,&#123;props.n1&#125;</span><br><span class="line">      &lt;F2 n2=&#123;props.n1&#125;&gt;&lt;/F2&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line">function F2(props) &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;2222,&#123;props.n2&#125;</span><br><span class="line">      &lt;F3 n3=&#123;props.n2&#125;&gt;&lt;/F3&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line">function F3(props) &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;3333,&#123;props.n3&#125;</span><br><span class="line">      &lt;F4 n4=&#123;props.n3&#125;&gt;&lt;/F4&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line">function F4(props) &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;4444,&#123;props.n4&#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;    </span><br><span class="line">class App extends React.Component &#123;</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    super();</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      n: 99</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;F1 n1=&#123;this.state.n&#125;/&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const rootElement = document.getElementById(&quot;root&quot;);</span><br><span class="line">ReactDOM.render(&lt;App /&gt;, rootElement);</span><br></pre></td></tr></table></figure>
<p>这样很麻烦需要层层传递</p>
<blockquote>
<p>如果 F4想单独拿到 n呢？</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">// 唯一的办法将 n提取到外部</span><br><span class="line">function f1() &#123;</span><br><span class="line">  console.log(1);</span><br><span class="line">  f2();</span><br><span class="line">&#125;</span><br><span class="line">function f2() &#123;</span><br><span class="line">  //这里的 n2就是 f1里的 n1</span><br><span class="line">  console.log(2);</span><br><span class="line">  f3();</span><br><span class="line">&#125;</span><br><span class="line">function f3() &#123;</span><br><span class="line">  console.log(3);</span><br><span class="line">  f4();</span><br><span class="line">&#125;</span><br><span class="line">function f4() &#123;</span><br><span class="line">  console.log(4,n);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let n = 100;</span><br><span class="line">&#123;</span><br><span class="line">    f1( n );</span><br><span class="line">    console.log(&quot;done&quot;);</span><br><span class="line">&#125;</span><br><span class="line">/*</span><br><span class="line">f4单独 得到n 不想层层传递</span><br><span class="line">现在则需要 将 n放在全局</span><br><span class="line">*/</span><br></pre></td></tr></table></figure>
<p>如果将 n 放在全局就回导致容易被篡改</p>
<ul>
<li>全局变量慎用</li>
</ul>
<blockquote>
<h4 id="改良：-局部的全局变量"><a href="#改良：-局部的全局变量" class="headerlink" title="改良： 局部的全局变量"></a>改良： 局部的全局变量</h4></blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    let x = &#123;&#125;;</span><br><span class="line">    window.setX = function(key,value)&#123;</span><br><span class="line">        x[key] = value</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    window.f1 = function f1() &#123;</span><br><span class="line">        console.log(1);</span><br><span class="line">        f2();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    window.f2 = function f2() &#123;</span><br><span class="line">    //这里的 n2就是 f1里的 n1</span><br><span class="line">        console.log(2);</span><br><span class="line">        f3();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    window.f3 = function f3() &#123;</span><br><span class="line">        console.log(3);</span><br><span class="line">        f4();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    window.f4 = function f4() &#123;</span><br><span class="line">        console.log(4,x[&apos;n&apos;]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;   </span><br><span class="line">    window.setX(&apos;n&apos;,100)</span><br><span class="line">    setTimeout(() =&gt; &#123;</span><br><span class="line">        window.f1();        </span><br><span class="line">    &#125;, 1000);</span><br><span class="line">    console.log(&quot;done&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>这个 x 就叫 context</li>
<li>setX 就是 setContext</li>
<li>他就是对于组件来使用的——局部的全局变量</li>
<li>避免了 层层传递props</li>
</ul>
<blockquote>
<h4 id="用Context-改写-React例子"><a href="#用Context-改写-React例子" class="headerlink" title="用Context 改写 React例子"></a>用Context 改写 React例子</h4></blockquote>
<p>style.css</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.box &#123;</span><br><span class="line">  border: 1px solid red;</span><br><span class="line">  padding: 10px;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>index.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">import React from &quot;react&quot;;</span><br><span class="line">import ReactDOM from &quot;react-dom&quot;;</span><br><span class="line"></span><br><span class="line">import &quot;./styles.css&quot;;</span><br><span class="line"></span><br><span class="line">function F1() &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div className=&quot;box&quot;&gt;</span><br><span class="line">      1111</span><br><span class="line">      &lt;F2 /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line">function F2() &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div className=&quot;box&quot;&gt;</span><br><span class="line">      2222</span><br><span class="line">      &lt;F3 /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line">function F3() &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div className=&quot;box&quot;&gt;</span><br><span class="line">      3333</span><br><span class="line">      &lt;nContext.Consumer&gt;&#123;xxx =&gt; &lt;F4 n4=&#123;xxx&#125; /&gt;&#125;&lt;/nContext.Consumer&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line">function F4(props) &#123;</span><br><span class="line">  return &lt;div className=&quot;box&quot;&gt;4444,&#123;props.n4&#125;&lt;/div&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const nContext = React.createContext();</span><br><span class="line"></span><br><span class="line">class App extends React.Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;nContext.Provider value=&quot;999&quot;&gt;</span><br><span class="line">          &lt;F1 /&gt;</span><br><span class="line">        &lt;/nContext.Provider&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const rootElement = document.getElementById(&quot;root&quot;);</span><br><span class="line">ReactDOM.render(&lt;App /&gt;, rootElement);</span><br></pre></td></tr></table></figure>
<ul>
<li><a href="https://codesandbox.io/s/jny7mn8415" target="_blank" rel="noopener">React版本</a></li>
</ul>
<blockquote>
<p>理解代码</p>
</blockquote>
<p>JSX</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;&lt;/div&gt; </span><br><span class="line">//翻译成</span><br><span class="line">React.createElement(&apos;div&apos;,null)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// ------------------------------------</span><br><span class="line">&lt;div className=&quot;x&quot; title=&quot;hi&quot;&gt;&lt;/div&gt; </span><br><span class="line">//翻译成</span><br><span class="line">React.createElement(&apos;div&apos;,&#123;className:&apos;x&apos;,title:&apos;hi&apos;&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// ------------------------------------</span><br><span class="line">&lt;div className=&quot;x&quot; title=&quot;hi&quot;&gt;aaaa&lt;/div&gt; </span><br><span class="line">//翻译成</span><br><span class="line">React.createElement(&apos;div&apos;,&#123;className:&apos;x&apos;,title:&apos;hi&apos;&#125;,&apos;aaaa&apos;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// ------------------------------------</span><br><span class="line">function F1()&#123;</span><br><span class="line">    return &apos;1111&apos;</span><br><span class="line">&#125;</span><br><span class="line">&lt;div className=&quot;x&quot; title=&quot;hi&quot;&gt;</span><br><span class="line">    &lt;F1&gt;&lt;/F1&gt;</span><br><span class="line">&lt;/div&gt; </span><br><span class="line"></span><br><span class="line">//翻译成 当你用标签写的时候 永远会在 前面加上一个React.createElement</span><br><span class="line">React.createElement(</span><br><span class="line">    &apos;div&apos;,&#123;className:&apos;x&apos;,title:&apos;hi&apos;&#125;,</span><br><span class="line">    React.createElement(F1,null)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">// ------------------------------------</span><br><span class="line">function F1()&#123;</span><br><span class="line">    return &apos;1111&apos;</span><br><span class="line">&#125;</span><br><span class="line">&lt;div className=&quot;x&quot; title=&quot;hi&quot;&gt;</span><br><span class="line">    F1</span><br><span class="line">    &#123;F1&#125;</span><br><span class="line">    &lt;F1/&gt;</span><br><span class="line">&lt;/div&gt; </span><br><span class="line">//翻译成 </span><br><span class="line">//当你写F1就是 字符串 &quot;F1&quot; </span><br><span class="line">//当你用标签写的时候 永远会在 前面加上一个React.createElement</span><br><span class="line">React.createElement(</span><br><span class="line">    &apos;div&apos;,&#123;className:&apos;x&apos;,title:&apos;hi&apos;&#125;,</span><br><span class="line">    &apos;F1&apos;,</span><br><span class="line">    F1, //这是个函数 但是React并不知道怎么用</span><br><span class="line">    React.createElement(F1,null)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<blockquote>
<h4 id="实现一个接受函数的组件——-Consumer原理"><a href="#实现一个接受函数的组件——-Consumer原理" class="headerlink" title="实现一个接受函数的组件——(Consumer原理)"></a>实现一个接受函数的组件——(Consumer原理)</h4></blockquote>
<p>index.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">import React from &quot;react&quot;;</span><br><span class="line">import ReactDOM from &quot;react-dom&quot;;</span><br><span class="line"></span><br><span class="line">// Ccc就是 Consumer</span><br><span class="line">function Ccc(props) &#123;</span><br><span class="line"></span><br><span class="line">  /* </span><br><span class="line">  props.children 可以获取 Ccc里得内容 &lt;Ccc&gt;&#123;fn&#125;&lt;Ccc/&gt;</span><br><span class="line">  如果 传递一个函数</span><br><span class="line">  props.children 就是那个函数 fn</span><br><span class="line">  传递 &lt;Ccc&gt;&#123;fn&#125;&#123;fn2&#125;&lt;Ccc/&gt;</span><br><span class="line">  那么 props.children 就是 [fn,fn2]</span><br><span class="line">  */</span><br><span class="line">  </span><br><span class="line">  let info = 100;</span><br><span class="line">  let result = props.children(info);</span><br><span class="line">  return &lt;div&gt;&#123;result&#125;&lt;/div&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function App() &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;Ccc c1=&quot;c1&quot;&gt;</span><br><span class="line">        &#123;msg =&gt; &#123;</span><br><span class="line">          console.log(`我得到的信息是$&#123;msg&#125;`);</span><br><span class="line">          return &lt;div&gt;我得到的数据是：&#123;msg&#125;&lt;/div&gt;;</span><br><span class="line">        &#125;&#125;</span><br><span class="line">      &lt;/Ccc&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const rootElement = document.getElementById(&quot;root&quot;);</span><br><span class="line">ReactDOM.render(&lt;App /&gt;, rootElement);</span><br></pre></td></tr></table></figure>
<ul>
<li><a href="https://codesandbox.io/s/wwp6kkxno5" target="_blank" rel="noopener">代码地址</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/01/16/React入门006之ContextApi/" data-id="cklcb6bn200pewo91giun1qsv" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React入门/">React入门</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-React入门005之Redux是什么03" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/01/16/React入门005之Redux是什么03/" class="article-date">
  <time datetime="2019-01-16T13:21:50.000Z" itemprop="datePublished">2019-01-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/01/16/React入门005之Redux是什么03/">React入门005之Redux是什么03</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="React-Redux"><a href="#React-Redux" class="headerlink" title="React-Redux"></a>React-Redux</h3><ul>
<li><a href="https://react-redux.js.org/" target="_blank" rel="noopener">https://react-redux.js.org/</a></li>
<li>它就是让你不用每曾都传递 store,随时都可以使用store，避免混乱问题</li>
</ul>
<p>核心就几个东西</p>
<ul>
<li>Provider</li>
<li>connect</li>
<li>connectAdvanced</li>
</ul>
<p>我直接拿上一篇的例子复制了一份目录在</p>
<ul>
<li>demo-react-redux-2</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 安装 react-redux</span><br><span class="line">yarn add react-redux</span><br></pre></td></tr></table></figure>
<p>index.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">// step1 引入Provider</span><br><span class="line">// step2 用 Provider 包裹App 并传递 store</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import React from &apos;react&apos;;</span><br><span class="line">import ReactDOM from &apos;react-dom&apos;;</span><br><span class="line">import &apos;./index.css&apos;;</span><br><span class="line">import App from &apos;./App&apos;;</span><br><span class="line">import * as serviceWorker from &apos;./serviceWorker&apos;;</span><br><span class="line"></span><br><span class="line">import &#123; Provider &#125; from &apos;react-redux&apos;</span><br><span class="line"></span><br><span class="line">import &#123;createStore&#125; from &apos;redux&apos;;</span><br><span class="line">const stateChanger = (state,action)=&gt;&#123;</span><br><span class="line">  if (state === undefined)&#123;</span><br><span class="line">    return 0;</span><br><span class="line">  &#125;else&#123;</span><br><span class="line">    if(action.type === &apos;add&apos;)&#123;</span><br><span class="line">      var newState =state + action.payload;</span><br><span class="line">      return newState;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">      return state;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return newState;</span><br><span class="line">&#125;</span><br><span class="line">const store = createStore(stateChanger)</span><br><span class="line"></span><br><span class="line">render();</span><br><span class="line"></span><br><span class="line">//render不传递参数</span><br><span class="line">store.subscribe(render)</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">//render传递参数</span><br><span class="line">store.subscribe(()=&gt;&#123;</span><br><span class="line">  render(参数)</span><br><span class="line">&#125;)</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">function add3()&#123;</span><br><span class="line">  if(store.getState()%2 === 1)&#123;</span><br><span class="line">    store.dispatch(&#123;type:&apos;add&apos;,payload: 1&#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function add4()&#123;</span><br><span class="line">  setTimeout(() =&gt; &#123;</span><br><span class="line">    store.dispatch(&#123;type:&apos;add&apos;,payload: 1&#125;)</span><br><span class="line">  &#125;, 2000);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function render()&#123;</span><br><span class="line">  ReactDOM.render(</span><br><span class="line">    &lt;Provider store=&#123;store&#125;&gt;</span><br><span class="line">      &lt;App/&gt;</span><br><span class="line">    &lt;/Provider&gt;</span><br><span class="line">    , document.getElementById(&apos;root&apos;));</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">serviceWorker.unregister();</span><br></pre></td></tr></table></figure>
<blockquote>
<p>普及基础知识</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// 这是啥意思？  一个函数返回值是函数</span><br><span class="line">function xx(a)&#123;</span><br><span class="line">    console.log(a)</span><br><span class="line">    return function(b)&#123;</span><br><span class="line">        console.log(a + b)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">xx(1)(2);</span><br><span class="line">// xx()叫做 偏函数 (参数不全)</span><br></pre></td></tr></table></figure>
<p>App.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">// step1 引入 connect</span><br><span class="line">// step2 connect()(App) 传递App给 connect</span><br><span class="line">import React, &#123; Component &#125; from &apos;react&apos;;</span><br><span class="line"></span><br><span class="line">import &#123; connect &#125; from &apos;react-redux&apos;</span><br><span class="line">class App extends Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    console.log(this.props);</span><br><span class="line">    return (</span><br><span class="line">        &lt;div className=&quot;App&quot;&gt;</span><br><span class="line">          &lt;div&gt;</span><br><span class="line">            你点击了&lt;span id=&quot;value&quot;&gt;&#123;this.props.n&#125;&lt;/span&gt;次</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;button id=&quot;add1&quot; onClick=&#123;()=&gt;this.props.add1()&#125;&gt;+1&lt;/button&gt;</span><br><span class="line">                &lt;button id=&quot;add2&quot;&gt;+2&lt;/button&gt;</span><br><span class="line">                &lt;button id=&quot;add1IfOdd&quot;&gt;如果单数就+1&lt;/button&gt;</span><br><span class="line">                &lt;button id=&quot;addAfter2Ses&quot;&gt;2秒后+1&lt;/button&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> 这个 x 就是 把 store里的东西拿出来 放到 this.props上</span><br><span class="line"> 所以如果 store = &#123;n:0&#125;传递到这里</span><br><span class="line"> 就变成了 this.props.n = 0</span><br><span class="line"> function x(state)&#123;</span><br><span class="line">  return&#123;</span><br><span class="line">    n:state.n</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">*/</span><br><span class="line">// 映射 state===&gt;props</span><br><span class="line">/*</span><br><span class="line">// mapStateToProps 必须是一个函数</span><br><span class="line">接受一个参数 state 还有一个不常用的参数</span><br><span class="line">*/</span><br><span class="line">function mapStateToProps(state)&#123;</span><br><span class="line">  return&#123;</span><br><span class="line">    n:state.n</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 如何 add 呢？ 产生一个action 通过这个connect你就不用 store.dispatch</span><br><span class="line">// 把dispatch映射到 Props</span><br><span class="line">/*</span><br><span class="line">mapDispatchToProps</span><br><span class="line">可以是个函数也可以是个对象</span><br><span class="line">function mapDispatchToProps(dispatch)&#123;</span><br><span class="line">  return &#123;</span><br><span class="line">    add1:()=&gt;dispatch(&#123;type:&apos;add&apos;,payload:1&#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">const mapDispatchToProps = &#123;</span><br><span class="line">  add1:()=&gt;&#123;</span><br><span class="line">    return &#123;type:&apos;add&apos;,payload:1&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default connect(mapStateToProps,mapDispatchToProps)(App);</span><br></pre></td></tr></table></figure>
<p>index.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">import React from &apos;react&apos;;</span><br><span class="line">import ReactDOM from &apos;react-dom&apos;;</span><br><span class="line">import App from &apos;./App&apos;;</span><br><span class="line">import * as serviceWorker from &apos;./serviceWorker&apos;;</span><br><span class="line"></span><br><span class="line">import &#123; Provider &#125; from &apos;react-redux&apos;</span><br><span class="line"></span><br><span class="line">import &#123;createStore&#125; from &apos;redux&apos;;</span><br><span class="line">const stateChanger = (state,action)=&gt;&#123;</span><br><span class="line">  if (state === undefined)&#123;</span><br><span class="line">    return &#123;n:0&#125;</span><br><span class="line">  &#125;else&#123;</span><br><span class="line">    if(action.type === &apos;add&apos;)&#123;</span><br><span class="line">      var newState =&#123;n:state.n + action.payload&#125;</span><br><span class="line">      return newState;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">      return state;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">const store = createStore(stateChanger)</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">    &lt;Provider store=&#123;store&#125;&gt;</span><br><span class="line">      &lt;App/&gt;</span><br><span class="line">    &lt;/Provider&gt;</span><br><span class="line">    , document.getElementById(&apos;root&apos;));</span><br><span class="line"></span><br><span class="line">serviceWorker.unregister();</span><br></pre></td></tr></table></figure>
<p><a href="https://github.com/slTrust/React-study" target="_blank" rel="noopener">代码仓库</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/01/16/React入门005之Redux是什么03/" data-id="cklcb6bn400piwo91gltu34v5" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React入门/">React入门</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-React入门005之Redux是什么02" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/01/15/React入门005之Redux是什么02/" class="article-date">
  <time datetime="2019-01-15T14:16:17.000Z" itemprop="datePublished">2019-01-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/01/15/React入门005之Redux是什么02/">React入门005之Redux是什么02</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="Redux-React"><a href="#Redux-React" class="headerlink" title="Redux+React"></a>Redux+React</h3><blockquote>
<p>安装 react脚手架工具</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">npm i -g create-react-app@2.1.1</span><br><span class="line"></span><br><span class="line"># 新建目录</span><br><span class="line">mkdir demo-react-redux-1</span><br><span class="line"># 切换目录下</span><br><span class="line">cd demo-react-redux-1</span><br><span class="line"># 当前目录新建一个 生成一个react项目</span><br><span class="line">create-react-app .</span><br><span class="line"># 安装成功</span><br><span class="line">yarn start</span><br></pre></td></tr></table></figure>
<blockquote>
<p>编辑 app.js</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &apos;react&apos;;</span><br><span class="line"></span><br><span class="line">class App extends Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div className=&quot;App&quot;&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          你点击了&lt;span id=&quot;value&quot;&gt;0&lt;/span&gt;次</span><br><span class="line">          &lt;div&gt;</span><br><span class="line">              &lt;button id=&quot;add1&quot;&gt;+1&lt;/button&gt;</span><br><span class="line">              &lt;button id=&quot;add2&quot;&gt;+2&lt;/button&gt;</span><br><span class="line">              &lt;button id=&quot;add1IfOdd&quot;&gt;如果单数就+1&lt;/button&gt;</span><br><span class="line">              &lt;button id=&quot;addAfter2Ses&quot;&gt;2秒后+1&lt;/button&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default App;</span><br></pre></td></tr></table></figure>
<p>实现我们上一篇的雏形</p>
<blockquote>
<p>引入 redux</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 踩坑了</span><br><span class="line">npm i redux</span><br><span class="line"># 因为我们默认使用 yarn install的</span><br><span class="line"></span><br><span class="line"># 如果你混着用 就会导致重新 安装所有依赖</span><br><span class="line"></span><br><span class="line"># 所以 还是 用yarn</span><br><span class="line">yarn add redux</span><br></pre></td></tr></table></figure>
<blockquote>
<h3 id="渲染-store"><a href="#渲染-store" class="headerlink" title="渲染 store "></a>渲染 store </h3></blockquote>
<p>index.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">import React from &apos;react&apos;;</span><br><span class="line">import ReactDOM from &apos;react-dom&apos;;</span><br><span class="line">import &apos;./index.css&apos;;</span><br><span class="line">import App from &apos;./App&apos;;</span><br><span class="line">import * as serviceWorker from &apos;./serviceWorker&apos;;</span><br><span class="line"></span><br><span class="line">import &#123;createStore&#125; from &apos;redux&apos;;</span><br><span class="line">const stateChanger = (state,action)=&gt;&#123;</span><br><span class="line">  if (state === undefined)&#123;</span><br><span class="line">    return 0;</span><br><span class="line">  &#125;else&#123;</span><br><span class="line">    if(action.type === &apos;add&apos;)&#123;</span><br><span class="line">      var newState =state + action.payload;</span><br><span class="line">      return newState;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">      return state;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return newState;</span><br><span class="line">&#125;</span><br><span class="line">const store = createStore(stateChanger)</span><br><span class="line"></span><br><span class="line">// 根节点传递 store</span><br><span class="line">ReactDOM.render(&lt;App value=&#123;store.getState()&#125;/&gt;, document.getElementById(&apos;root&apos;));</span><br><span class="line"></span><br><span class="line">serviceWorker.unregister();</span><br></pre></td></tr></table></figure>
<p>App.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">// props使用 根结点传递的store</span><br><span class="line">import React, &#123; Component &#125; from &apos;react&apos;;</span><br><span class="line"></span><br><span class="line">class App extends Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div className=&quot;App&quot;&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          你点击了&lt;span id=&quot;value&quot;&gt;&#123;this.props.value&#125;&lt;/span&gt;次</span><br><span class="line">          &lt;div&gt;</span><br><span class="line">              &lt;button id=&quot;add1&quot;&gt;+1&lt;/button&gt;</span><br><span class="line">              &lt;button id=&quot;add2&quot;&gt;+2&lt;/button&gt;</span><br><span class="line">              &lt;button id=&quot;add1IfOdd&quot;&gt;如果单数就+1&lt;/button&gt;</span><br><span class="line">              &lt;button id=&quot;addAfter2Ses&quot;&gt;2秒后+1&lt;/button&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">export default App;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>新问题 点击 add的问题</p>
</blockquote>
<ul>
<li>store是从props里取的 在App.js里根本拿不到</li>
<li>只能继续从 index.js里 传递相应的 事件处理函数</li>
</ul>
<p>App.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &apos;react&apos;;</span><br><span class="line"></span><br><span class="line">class App extends Component &#123;</span><br><span class="line">  add1()&#123;</span><br><span class="line">    this.props.onAdd1();</span><br><span class="line">  &#125;</span><br><span class="line">  add2()&#123;</span><br><span class="line">    this.props.onAdd2();</span><br><span class="line">  &#125;</span><br><span class="line">  add3()&#123;</span><br><span class="line">    this.props.onAdd3();</span><br><span class="line">  &#125;</span><br><span class="line">  add4()&#123;</span><br><span class="line">    this.props.onAdd4();</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div className=&quot;App&quot;&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          你点击了&lt;span id=&quot;value&quot;&gt;&#123;this.props.value&#125;&lt;/span&gt;次</span><br><span class="line">          &lt;div&gt;</span><br><span class="line">              &lt;button id=&quot;add1&quot; onClick=&#123;()=&gt;this.add1()&#125;&gt;+1&lt;/button&gt;</span><br><span class="line">              &lt;button id=&quot;add2&quot; onClick=&#123;()=&gt;this.add2()&#125;&gt;+2&lt;/button&gt;</span><br><span class="line">              &lt;button id=&quot;add1IfOdd&quot; onClick=&#123;()=&gt;this.add3()&#125;&gt;如果单数就+1&lt;/button&gt;</span><br><span class="line">              &lt;button id=&quot;addAfter2Ses&quot; onClick=&#123;()=&gt;this.add4()&#125;&gt;2秒后+1&lt;/button&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default App;</span><br></pre></td></tr></table></figure>
<p>index.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">import React from &apos;react&apos;;</span><br><span class="line">import ReactDOM from &apos;react-dom&apos;;</span><br><span class="line">import &apos;./index.css&apos;;</span><br><span class="line">import App from &apos;./App&apos;;</span><br><span class="line">import * as serviceWorker from &apos;./serviceWorker&apos;;</span><br><span class="line"></span><br><span class="line">import &#123;createStore&#125; from &apos;redux&apos;;</span><br><span class="line">const stateChanger = (state,action)=&gt;&#123;</span><br><span class="line">  if (state === undefined)&#123;</span><br><span class="line">    return 0;</span><br><span class="line">  &#125;else&#123;</span><br><span class="line">    if(action.type === &apos;add&apos;)&#123;</span><br><span class="line">      var newState =state + action.payload;</span><br><span class="line">      return newState;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">      return state;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return newState;</span><br><span class="line">&#125;</span><br><span class="line">const store = createStore(stateChanger)</span><br><span class="line"></span><br><span class="line">render();</span><br><span class="line"></span><br><span class="line">//render不传递参数</span><br><span class="line">store.subscribe(render)</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">//render传递参数</span><br><span class="line">store.subscribe(()=&gt;&#123;</span><br><span class="line">  render(参数)</span><br><span class="line">&#125;)</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">function add3()&#123;</span><br><span class="line">  if(store.getState()%2 === 1)&#123;</span><br><span class="line">    store.dispatch(&#123;type:&apos;add&apos;,payload: 1&#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function add4()&#123;</span><br><span class="line">  setTimeout(() =&gt; &#123;</span><br><span class="line">    store.dispatch(&#123;type:&apos;add&apos;,payload: 1&#125;)</span><br><span class="line">  &#125;, 2000);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 传递每个修改store的处理函数,因为App.js里 没法获取操作 store</span><br><span class="line">function render()&#123;</span><br><span class="line">  ReactDOM.render(</span><br><span class="line">    &lt;App value=&#123;store.getState()&#125;</span><br><span class="line">      onAdd1=&#123;()=&gt;&#123;store.dispatch(&#123;type:&apos;add&apos;,payload: 1&#125;)&#125;&#125;</span><br><span class="line">      onAdd2=&#123;()=&gt;&#123;store.dispatch(&#123;type:&apos;add&apos;,payload: 2&#125;)&#125;&#125;</span><br><span class="line">      onAdd3=&#123;add3&#125;</span><br><span class="line">      onAdd4=&#123;add4&#125;</span><br><span class="line">    /&gt;, document.getElementById(&apos;root&apos;));</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">serviceWorker.unregister();</span><br></pre></td></tr></table></figure>
<blockquote>
<h4 id="对比-Redux-VanillaJS-和-Redux-React"><a href="#对比-Redux-VanillaJS-和-Redux-React" class="headerlink" title="对比 Redux+VanillaJS 和 Redux+React"></a>对比 Redux+VanillaJS 和 Redux+React</h4></blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Redux + VanillaJS 每次点击按钮 整体 render</span><br><span class="line"></span><br><span class="line">Redux + React 每次点击按钮 只更新包含数字的span</span><br></pre></td></tr></table></figure>
<ul>
<li>这就是React的好处 让你每次不需要整体更新div,它通过dom diff 找该更新的地方</li>
</ul>
<h4 id="尽管如此-Redux-React的写法依然很恶心"><a href="#尽管如此-Redux-React的写法依然很恶心" class="headerlink" title="尽管如此 Redux+React的写法依然很恶心"></a>尽管如此 Redux+React的写法依然很恶心</h4><ul>
<li>需要根节点把action的函数传递下去</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// index.js里</span><br><span class="line">&lt;App value=&#123;store.getState()&#125;</span><br><span class="line">      onAdd1=&#123;()=&gt;&#123;store.dispatch(&#123;type:&apos;add&apos;,payload: 1&#125;)&#125;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// App.js里</span><br><span class="line">class App extends Component &#123;</span><br><span class="line">  add1()&#123;</span><br><span class="line">    this.props.onAdd1();</span><br><span class="line">    //为什么不能直接在这里  派发action呢？</span><br><span class="line">    // store.dispatch()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>有一个办法就是在根节点传递 store</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;App value=&#123;store.getState()&#125;</span><br><span class="line">     store=&#123;store&#125;</span><br><span class="line">/&gt;</span><br><span class="line"></span><br><span class="line">//这样 App.js里就可以</span><br><span class="line">store.dispatch()</span><br></pre></td></tr></table></figure>
<blockquote>
<h4 id="但是"><a href="#但是" class="headerlink" title="但是"></a>但是</h4><h4 id="但是-1"><a href="#但是-1" class="headerlink" title="但是"></a>但是</h4><h4 id="但是-2"><a href="#但是-2" class="headerlink" title="但是"></a>但是</h4></blockquote>
<p>虽然不用一层一层的往上调用，但是需要一层一层的往下传递store</p>
<p>假设 App内还有组件  就要每次都往子元素里传递</p>
<blockquote>
<p>解决方案 React-Redux</p>
</blockquote>
<p>注意是 React-Redux 跟 Redux是不同的</p>
<p>详情见下一篇</p>
<p><a href="https://github.com/slTrust/React-study" target="_blank" rel="noopener">代码仓库</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/01/15/React入门005之Redux是什么02/" data-id="cklcb6bn200pcwo91d78xtq2x" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React入门/">React入门</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-React入门005之Redux是什么01" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/01/15/React入门005之Redux是什么01/" class="article-date">
  <time datetime="2019-01-15T13:01:00.000Z" itemprop="datePublished">2019-01-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/01/15/React入门005之Redux是什么01/">React入门005之Redux是什么01</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="Redux"><a href="#Redux" class="headerlink" title="Redux"></a>Redux</h3><h3 id="一个不错的Redux中文文档"><a href="#一个不错的Redux中文文档" class="headerlink" title="一个不错的Redux中文文档"></a><a href="https://cn.redux.js.org/docs/basics/Reducers.html" target="_blank" rel="noopener">一个不错的Redux中文文档</a></h3><p>- 建议直接看</p>
<p><a href="https://cn.redux.js.org/docs/introduction/Examples.html" target="_blank" rel="noopener">示例</a></p>
<blockquote>
<h3 id="里面有个-Counter-Vanilla示例"><a href="#里面有个-Counter-Vanilla示例" class="headerlink" title="里面有个 Counter Vanilla示例"></a>里面有个 Counter Vanilla示例</h3></blockquote>
<ul>
<li>Vanilla是什么 (英文意思香草)</li>
</ul>
<p>what</p>
<blockquote>
<h4 id="VanillaJS就代表-原生JS"><a href="#VanillaJS就代表-原生JS" class="headerlink" title="VanillaJS就代表 原生JS"></a>VanillaJS就代表 原生JS</h4></blockquote>
<p>因为有很多前端程序员上来就学框架，根本不懂底层原理只会用库或框架，于是很多人上手就学vue,此时让它用 原生他不会，于是有人为了嘲讽这些不会原生JS的人 发明了一个新的框架就叫 VanillaJS</p>
<ul>
<li><p><a href="http://vanilla-js.com/" target="_blank" rel="noopener">VanillaJS官网</a> 需要翻墙 (而且你点击download里任何一个，下载大小都是0 bytes)</p>
</li>
<li><p><a href="https://segmentfault.com/a/1190000000355277?utm_source=tag-newest" target="_blank" rel="noopener">sf解释</a></p>
</li>
</ul>
<blockquote>
<p>Counter Vanilla就是 没有用任何的库(用redux结合原生JS)</p>
</blockquote>
<ul>
<li><a href="https://github.com/reduxjs/redux/blob/master/examples/counter-vanilla/index.html" target="_blank" rel="noopener">示例地址</a></li>
</ul>
<blockquote>
<h4 id="我们的需求-实现几个按钮点击触发-1-1的功能"><a href="#我们的需求-实现几个按钮点击触发-1-1的功能" class="headerlink" title="我们的需求 实现几个按钮点击触发+1/-1的功能"></a>我们的需求 实现几个按钮点击触发+1/-1的功能</h4></blockquote>
<p>初始化如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;script src=&quot;https://cdn.bootcss.com/redux/4.0.1/redux.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;div id=&quot;app&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">function render()&#123;</span><br><span class="line">    var app = document.querySelector(&apos;#app&apos;);</span><br><span class="line">    app.innerHTML = `</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        你点击了&lt;span id=&quot;value&quot;&gt;0&lt;/span&gt;次</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;button id=&quot;add1&quot;&gt;+1&lt;/button&gt;</span><br><span class="line">            &lt;button id=&quot;add2&quot;&gt;+2&lt;/button&gt;</span><br><span class="line">            &lt;button id=&quot;add1IfOdd&quot;&gt;如果单数就+1&lt;/button&gt;</span><br><span class="line">            &lt;button id=&quot;addAfter2Ses&quot;&gt;2秒后+1&lt;/button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    `;</span><br><span class="line">&#125;</span><br><span class="line">render();</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>用redux怎么做呢？</p>
</blockquote>
<p>根据<a href="https://github.com/reduxjs/redux/blob/master/examples/counter-vanilla/index.html" target="_blank" rel="noopener">示例</a></p>
<ol>
<li>我们第一步要创建一个store 存这个0 </li>
<li>这个store需要接受一个参数(更新store的函数)。</li>
<li><p>这个参数是一个函数</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(接受两个参数)</span><br><span class="line">第一个是上一次 store的状态</span><br><span class="line">第二个是 具体的操作</span><br><span class="line"></span><br><span class="line">var store = Redux.createStroe(函数xx)</span><br><span class="line">function 函数xx(之前的状态,操作)&#123;</span><br><span class="line">    return 新的状态</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>这个函数是用来更新store的</p>
</li>
</ol>
<ul>
<li>step1 dispatch 派发一个action</li>
<li>step2 根据操作生成新的 state 触发一个事件</li>
<li>step3 接受 事件重新 render</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;script src=&quot;https://cdn.bootcss.com/redux/4.0.1/redux.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;div id=&quot;app&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">function add1()&#123;</span><br><span class="line">    // step1 dispatch 派发一个action</span><br><span class="line">    // 触发一个事件</span><br><span class="line">    // 派发一个动作</span><br><span class="line">    store.dispatch(&#123;type:&apos;add&apos;&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function render(store)&#123;</span><br><span class="line">    var app = document.querySelector(&apos;#app&apos;);</span><br><span class="line">    app.innerHTML = `</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        你点击了&lt;span id=&quot;value&quot;&gt;$&#123;store.getState()&#125;&lt;/span&gt;次</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;button id=&quot;add1&quot; onclick=&quot;add1()&quot;&gt;+1&lt;/button&gt;</span><br><span class="line">            &lt;button id=&quot;add2&quot;&gt;+2&lt;/button&gt;</span><br><span class="line">            &lt;button id=&quot;add1IfOdd&quot;&gt;如果单数就+1&lt;/button&gt;</span><br><span class="line">            &lt;button id=&quot;addAfter2Ses&quot;&gt;2秒后+1&lt;/button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    `;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function stateChanger(state,action)&#123; </span><br><span class="line">    if(state === undefined)&#123;</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        if(action.type === &apos;add&apos;)&#123;</span><br><span class="line">            var newState = state + 1;</span><br><span class="line">            return newState;</span><br><span class="line">            // step2 根据操作生成新的 state 触发一个事件</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            return state;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">//初始化 store</span><br><span class="line">var store = Redux.createStore(stateChanger)</span><br><span class="line"></span><br><span class="line">render(store);</span><br><span class="line"></span><br><span class="line">//监听 store的变化 然后触发render</span><br><span class="line">store.subscribe(()=&gt;&#123;</span><br><span class="line"></span><br><span class="line">    // step3 接受 事件重新 render</span><br><span class="line">    render(store) </span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>store 和 state的关系</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">state    ------&gt; store存储了 state</span><br><span class="line">获取 state ------&gt; store.getState()</span><br><span class="line"></span><br><span class="line">store    ------&gt; Redux.create(函数)</span><br><span class="line">更新 state -----&gt; 触发 action 也就是 dispatch(&#123;type:&apos;操作&apos;&#125;)</span><br></pre></td></tr></table></figure>
<blockquote>
<h4 id="完善其他按钮的功能"><a href="#完善其他按钮的功能" class="headerlink" title="完善其他按钮的功能"></a>完善其他按钮的功能</h4></blockquote>
<ul>
<li>新增payload使用</li>
<li>异步调用 action</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;script src=&quot;https://cdn.bootcss.com/redux/4.0.1/redux.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;div id=&quot;app&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">function add1()&#123;</span><br><span class="line">    store.dispatch(&#123;type:&apos;add&apos;,payload:1&#125;)</span><br><span class="line">&#125;</span><br><span class="line">function add2()&#123;</span><br><span class="line">    store.dispatch(&#123;type:&apos;add&apos;,payload:2&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function add1IfOdd()&#123;</span><br><span class="line">    var oldState = store.getState()</span><br><span class="line">    if(oldState % 2 ===1)&#123;</span><br><span class="line">        store.dispatch(&#123;type:&apos;add&apos;,payload:1&#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function addAfter2Ses()&#123;</span><br><span class="line">    setTimeout(() =&gt; &#123;</span><br><span class="line">        store.dispatch(&#123;type:&apos;add&apos;,payload:1&#125;)</span><br><span class="line">    &#125;, 2000);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function render(store)&#123;</span><br><span class="line">    var app = document.querySelector(&apos;#app&apos;);</span><br><span class="line">    app.innerHTML = `</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        你点击了&lt;span id=&quot;value&quot;&gt;$&#123;store.getState()&#125;&lt;/span&gt;次</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;button id=&quot;add1&quot; onclick=&quot;add1()&quot;&gt;+1&lt;/button&gt;</span><br><span class="line">            &lt;button id=&quot;add2&quot; onclick=&quot;add2()&quot;&gt;+2&lt;/button&gt;</span><br><span class="line">            &lt;button id=&quot;add1IfOdd&quot; onclick=&quot;add1IfOdd()&quot;&gt;如果单数就+1&lt;/button&gt;</span><br><span class="line">            &lt;button id=&quot;addAfter2Ses&quot; onclick=&quot;addAfter2Ses()&quot;&gt;2秒后+1&lt;/button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    `;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function stateChanger(state,action)&#123; </span><br><span class="line">    if(state === undefined)&#123;</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        console.log(&apos;add&apos;)</span><br><span class="line">        if(action.type === &apos;add&apos;)&#123;</span><br><span class="line">            var newState = state + action.payload;</span><br><span class="line">            return newState;</span><br><span class="line">            // step2 根据操作生成新的 state 触发一个事件</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            return state;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">//初始化 store</span><br><span class="line">var store = Redux.createStore(stateChanger)</span><br><span class="line"></span><br><span class="line">render(store);</span><br><span class="line"></span><br><span class="line">//监听 store的变化 然后触发render</span><br><span class="line">store.subscribe(()=&gt;&#123;</span><br><span class="line">    // step3 接受 事件重新 render</span><br><span class="line">    render(store) </span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li><h3 id="一个坑，就是异步更新-store的问题"><a href="#一个坑，就是异步更新-store的问题" class="headerlink" title="一个坑，就是异步更新 store的问题"></a>一个坑，就是异步更新 store的问题</h3></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">// 新手经常犯的错误 ,把异步逻辑写在 </span><br><span class="line">function asyncAdd2()&#123;</span><br><span class="line">    store.dispatch(&#123;type:&apos;add2&apos;,payload:2&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function stateChanger(state,action)&#123; </span><br><span class="line">    if(state === undefined)&#123;</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        if(action.type === &apos;add&apos;)&#123;</span><br><span class="line">            var newState = state + action.payload;</span><br><span class="line">            return newState;</span><br><span class="line">            // step2 根据操作生成新的 state 触发一个事件</span><br><span class="line">        &#125;else if(action.type ===&apos;add2&apos;)&#123;</span><br><span class="line">             setTimeout(() =&gt; &#123;</span><br><span class="line">                var newState = state + action.payload;</span><br><span class="line">                return newState;</span><br><span class="line">            &#125;, 2000);</span><br><span class="line"></span><br><span class="line">            // 此时 setTimeout里函数的return是 箭头函数的返回值</span><br><span class="line">            /*</span><br><span class="line">            而这个 </span><br><span class="line">            else if(action.type ===&apos;add2&apos;)&#123;</span><br><span class="line">                //没写 return</span><br><span class="line">                // 相当于 return undefined</span><br><span class="line">            &#125;</span><br><span class="line">            */</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            return state;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a href="https://github.com/slTrust/React-study" target="_blank" rel="noopener">代码仓库</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/01/15/React入门005之Redux是什么01/" data-id="cklcb6bn000p8wo91alyilvhj" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React入门/">React入门</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-React入门004之React通信Redux代替eventHub" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/01/14/React入门004之React通信Redux代替eventHub/" class="article-date">
  <time datetime="2019-01-14T14:36:38.000Z" itemprop="datePublished">2019-01-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/01/14/React入门004之React通信Redux代替eventHub/">React入门004之React通信Redux代替eventHub.html</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="eventHub模式的理解"><a href="#eventHub模式的理解" class="headerlink" title="eventHub模式的理解"></a>eventHub模式的理解</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">var money = &#123;</span><br><span class="line">    amount : 100000</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var eventMap = &#123;&#125;;</span><br><span class="line">var eventHub = &#123;</span><br><span class="line">    trigger(eventName,data)&#123;</span><br><span class="line">        let fnList = eventMap[eventName];</span><br><span class="line">        if(!fnList) return </span><br><span class="line">        for(var i=0;i&lt;fnList.length;i++)&#123;</span><br><span class="line">            fnList[i](data)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    on(eventName,fn)&#123;</span><br><span class="line">        if(!eventMap[eventName])&#123;</span><br><span class="line">            eventMap[eventName] = []</span><br><span class="line">        &#125;</span><br><span class="line">        eventMap[eventName].push(fn)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var 管家 = &#123;</span><br><span class="line">    init()&#123;</span><br><span class="line">        eventHub.on(&apos;我想花钱&apos;,(data)=&gt;&#123;</span><br><span class="line">            money.amount -= data</span><br><span class="line">            // 此时要调用render才能实现 数据的同步</span><br><span class="line">            render();</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">管家.init()</span><br></pre></td></tr></table></figure>
<blockquote>
<p>特点</p>
</blockquote>
<ol>
<li>所有的数据放在顶层 上一篇我们的money放在了 app中 Redux 推荐把所有数据放归置在一个地方，然后把数据传递给最顶层组件(App)</li>
</ol>
<blockquote>
<p>此时有一个问题发生了,假如我有多个数据呢？ 你就要一个一个属性的传下去</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">var money = &#123;</span><br><span class="line">    amount : 100000</span><br><span class="line">&#125;</span><br><span class="line">var user = &#123;</span><br><span class="line">    id:321312,</span><br><span class="line">    nickName:&apos;土豪&apos;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 此时需要在app里</span><br><span class="line">class App extends React.Component&#123;</span><br><span class="line">    constructor()&#123;</span><br><span class="line">        super()</span><br><span class="line">        this.state = &#123;</span><br><span class="line">            money:money,</span><br><span class="line">            user:user</span><br><span class="line">        &#125;</span><br><span class="line">       </span><br><span class="line">    &#125;</span><br><span class="line">    render()&#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div className=&quot;root&quot;&gt;</span><br><span class="line">                &lt;div&gt;app&lt;/div&gt;</span><br><span class="line">                &lt;FirstFather money=&#123;this.state.money&#125;</span><br><span class="line">                user=&#123;this.state.user&#125;</span><br><span class="line">                /&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="eventHub-深入"><a href="#eventHub-深入" class="headerlink" title="eventHub 深入"></a>eventHub 深入</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot;&gt;</span><br><span class="line">    &lt;title&gt;Document&lt;/title&gt;</span><br><span class="line">    &lt;script src=&quot;https://cdn.bootcss.com/react/16.7.0-alpha.2/umd/react.development.js&quot;&gt;&lt;/script&gt;  </span><br><span class="line">    &lt;script src=&quot;https://cdn.bootcss.com/react-dom/16.7.0-alpha.2/umd/react-dom.production.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">        .root&#123;</span><br><span class="line">            display: flex;</span><br><span class="line">            justify-content: center;</span><br><span class="line">            align-items: center;</span><br><span class="line">            padding:10px;</span><br><span class="line">            border:1px solid black;</span><br><span class="line">        &#125;</span><br><span class="line">        .papa&#123;</span><br><span class="line">            border:1px solid grey;</span><br><span class="line">            padding:10px;</span><br><span class="line">        &#125;</span><br><span class="line">        .son&#123;</span><br><span class="line">            border:1px solid grey;</span><br><span class="line">            padding:10px;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div id=&quot;root&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">var user = &#123;</span><br><span class="line">    id:3213123,</span><br><span class="line">    nickName:&apos;土豪&apos;</span><br><span class="line">&#125;</span><br><span class="line">var money = &#123;</span><br><span class="line">    amount : 100000</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var store = &#123;</span><br><span class="line">    money:money,</span><br><span class="line">    user:user</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var eventMap = &#123;&#125;;</span><br><span class="line">var eventHub = &#123;</span><br><span class="line">    trigger(eventName,data)&#123;</span><br><span class="line">        let fnList = eventMap[eventName];</span><br><span class="line">        if(!fnList) return </span><br><span class="line">        for(var i=0;i&lt;fnList.length;i++)&#123;</span><br><span class="line">            fnList[i](data)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    on(eventName,fn)&#123;</span><br><span class="line">        if(!eventMap[eventName])&#123;</span><br><span class="line">            eventMap[eventName] = []</span><br><span class="line">        &#125;</span><br><span class="line">        eventMap[eventName].push(fn)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var 管家 = &#123;</span><br><span class="line">    init()&#123;</span><br><span class="line">        eventHub.on(&apos;我想花钱&apos;,(data)=&gt;&#123;  //订阅 subscribe</span><br><span class="line">            store.money.amount -= data // reducer 对数据的变动</span><br><span class="line">            // 此时要调用render才能实现 数据的同步</span><br><span class="line">            render();</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">管家.init()</span><br><span class="line"></span><br><span class="line">class App extends React.Component&#123;</span><br><span class="line">    constructor()&#123;</span><br><span class="line">        super()</span><br><span class="line">        this.state = &#123;</span><br><span class="line">            store:store</span><br><span class="line">        &#125;</span><br><span class="line">       </span><br><span class="line">    &#125;</span><br><span class="line">    render()&#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div className=&quot;root&quot;&gt;</span><br><span class="line">                &lt;div&gt;app&lt;/div&gt;</span><br><span class="line">                &lt;FirstFather money=&#123;this.state.store.money&#125;/&gt;</span><br><span class="line">                &lt;SecondFather money=&#123;this.state.store.money&#125;/&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class FirstFather extends React.Component&#123;</span><br><span class="line">    constructor()&#123;</span><br><span class="line">        super()</span><br><span class="line">    &#125;</span><br><span class="line">    render()&#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div className=&quot;papa&quot;&gt;</span><br><span class="line">                &lt;div&gt;大爸 &#123;this.props.money.amount&#125;&lt;/div&gt;</span><br><span class="line">                &lt;Son1 money=&#123;this.props.money&#125;/&gt;</span><br><span class="line">                &lt;Son2 money=&#123;this.props.money&#125;/&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class SecondFather extends React.Component&#123;</span><br><span class="line">    constructor()&#123;</span><br><span class="line">        super()</span><br><span class="line">    &#125;</span><br><span class="line">    render()&#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div className=&quot;papa&quot;&gt;</span><br><span class="line">                &lt;div&gt;二爸 &#123;this.props.money.amount&#125;&lt;/div&gt;</span><br><span class="line">                &lt;Son3 money=&#123;this.props.money&#125;/&gt;</span><br><span class="line">                &lt;Son4 money=&#123;this.props.money&#125;/&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Son1 extends React.Component&#123;</span><br><span class="line">    constructor()&#123;</span><br><span class="line">        super()</span><br><span class="line">    &#125;</span><br><span class="line">    render()&#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div className=&quot;son&quot;&gt;</span><br><span class="line">                儿子1 &#123;this.props.money.amount&#125;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Son2 extends React.Component&#123;</span><br><span class="line">    constructor()&#123;</span><br><span class="line">        super()</span><br><span class="line">    &#125;</span><br><span class="line">    x()&#123;</span><br><span class="line">        // active       </span><br><span class="line">        eventHub.trigger(&apos;我想花钱&apos; /* action type */,100) //100叫做 payload</span><br><span class="line">    &#125;</span><br><span class="line">    render()&#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div className=&quot;son&quot;&gt;</span><br><span class="line">                儿子2 &#123;this.props.money.amount&#125;</span><br><span class="line">                &lt;button onClick=&#123;()=&gt;this.x()&#125;&gt;消费&lt;/button&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Son3 extends React.Component&#123;</span><br><span class="line">    constructor()&#123;</span><br><span class="line">        super()</span><br><span class="line">        eventHub.on(&apos;我要花钱&apos;,(data)=&gt;&#123;</span><br><span class="line">            this.setState(&#123;</span><br><span class="line">                money:money</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    render()&#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div className=&quot;son&quot;&gt;</span><br><span class="line">                儿子3 &#123;this.props.money.amount&#125;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Son4 extends React.Component&#123;</span><br><span class="line">    constructor()&#123;</span><br><span class="line">        super()</span><br><span class="line">    &#125;</span><br><span class="line">    render()&#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div className=&quot;son&quot;&gt;</span><br><span class="line">                儿子4 &#123;this.props.money.amount&#125;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function render()&#123;</span><br><span class="line">    ReactDOM.render(</span><br><span class="line">        &lt;App/&gt;,</span><br><span class="line">        document.querySelector(&apos;#root&apos;)</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">render();</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>store 就是 集中管理数据的地方</li>
<li>action 就是事件 </li>
<li>我要花钱就是  action type</li>
<li>100金额 就是 payload 载荷</li>
<li>reducer 对数据的变动</li>
<li>subscribe 订阅</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">var user = &#123;</span><br><span class="line">    id:3213123,</span><br><span class="line">    nickName:&apos;土豪&apos;</span><br><span class="line">&#125;</span><br><span class="line">var money = &#123;</span><br><span class="line">    amount : 100000</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var store = &#123;</span><br><span class="line">    money:money,</span><br><span class="line">    user:user</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">eventHub.trigger(&apos;我想花钱&apos; /* action type */,100) //100叫做 payload</span><br><span class="line"></span><br><span class="line">eventHub.on(&apos;我想花钱&apos;,(data)=&gt;&#123;  //订阅 subscribe</span><br><span class="line">    store.money.amount -= data // reducer 对数据的变动</span><br><span class="line">    render();</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="用-Redux代替-eventHub"><a href="#用-Redux代替-eventHub" class="headerlink" title="用 Redux代替 eventHub"></a>用 Redux代替 eventHub</h3><ul>
<li>bootcdn  里 搜索 redux 并引入</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=&quot;https://cdn.bootcss.com/redux/4.0.0/redux.min.js&quot;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>由于我们是 JS引入 和 webpack或许有差异</li>
<li>此时我们不知道咋用，咋办？ crm</li>
</ul>
<ol>
<li>谷歌搜 Redux  科学上网的重要性</li>
<li><a href="https://cn.redux.js.org/" target="_blank" rel="noopener">https://cn.redux.js.org/</a> (翻墙可看)</li>
<li>找到 例子   示例 –&gt; <a href="https://cn.redux.js.org/docs/introduction/Examples.html" target="_blank" rel="noopener">https://cn.redux.js.org/docs/introduction/Examples.html</a></li>
<li>Counter 例子 <a href="https://github.com/reduxjs/redux/tree/master/examples/counter" target="_blank" rel="noopener">https://github.com/reduxjs/redux/tree/master/examples/counter</a></li>
<li>crm</li>
<li><p>抄它怎么调的redux <a href="https://github.com/reduxjs/redux/blob/master/examples/counter/src/index.js" target="_blank" rel="noopener">https://github.com/reduxjs/redux/blob/master/examples/counter/src/index.js</a></p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import React from &apos;react&apos;</span><br><span class="line">import ReactDOM from &apos;react-dom&apos;</span><br><span class="line">import &#123; createStore &#125; from &apos;redux&apos;</span><br><span class="line">import Counter from &apos;./components/Counter&apos;</span><br><span class="line">import counter from &apos;./reducers&apos;</span><br><span class="line"></span><br><span class="line">const store = createStore(counter)</span><br><span class="line">const rootEl = document.getElementById(&apos;root&apos;)</span><br><span class="line"></span><br><span class="line">const render = () =&gt; ReactDOM.render(</span><br><span class="line">&lt;Counter</span><br><span class="line">    value=&#123;store.getState()&#125;</span><br><span class="line">    onIncrement=&#123;() =&gt; store.dispatch(&#123; type: &apos;INCREMENT&apos; &#125;)&#125;</span><br><span class="line">    onDecrement=&#123;() =&gt; store.dispatch(&#123; type: &apos;DECREMENT&apos; &#125;)&#125;</span><br><span class="line">/&gt;,</span><br><span class="line">rootEl</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">render()</span><br><span class="line">store.subscribe(render)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">//别忘记引入redux.js</span><br><span class="line">// 通过抄别人的  我们造出了 自己的store</span><br><span class="line">let createStore = Redux.createStore;</span><br><span class="line">let reducers = (state = 0 ,action)=&gt;&#123;</span><br><span class="line">    state = state ||&#123;</span><br><span class="line">        money:&#123; amoune:100000 &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    switch(action.type)&#123;</span><br><span class="line">        case &apos;a&apos;:</span><br><span class="line">            return state + 1</span><br><span class="line">        case &apos;b&apos;:</span><br><span class="line">            return state - 1</span><br><span class="line">        default:</span><br><span class="line">            return state</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const store = createStore(reducers);</span><br><span class="line">console.log(store.getState())</span><br></pre></td></tr></table></figure>
<blockquote>
<p>此时之前的 eventHub 和 管家都不需要了</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot;&gt;</span><br><span class="line">    &lt;title&gt;Document&lt;/title&gt;</span><br><span class="line">    &lt;script src=&quot;https://cdn.bootcss.com/react/16.7.0-alpha.2/umd/react.development.js&quot;&gt;&lt;/script&gt;  </span><br><span class="line">    &lt;script src=&quot;https://cdn.bootcss.com/react-dom/16.7.0-alpha.2/umd/react-dom.production.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script src=&quot;https://cdn.bootcss.com/redux/4.0.0/redux.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">        .root&#123;</span><br><span class="line">            display: flex;</span><br><span class="line">            justify-content: center;</span><br><span class="line">            align-items: center;</span><br><span class="line">            padding:10px;</span><br><span class="line">            border:1px solid black;</span><br><span class="line">        &#125;</span><br><span class="line">        .papa&#123;</span><br><span class="line">            border:1px solid grey;</span><br><span class="line">            padding:10px;</span><br><span class="line">        &#125;</span><br><span class="line">        .son&#123;</span><br><span class="line">            border:1px solid grey;</span><br><span class="line">            padding:10px;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div id=&quot;root&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">let createStore = Redux.createStore;</span><br><span class="line"></span><br><span class="line">//管家 ——一个函数 他会得到（之前的state，花钱的动作）</span><br><span class="line">let reducers = (state = 0 ,action)=&gt;&#123;</span><br><span class="line">    //初始化</span><br><span class="line">    state = state ||&#123;</span><br><span class="line">        money:&#123; amount:100000 &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    switch(action.type)&#123;</span><br><span class="line">        case &apos;我想花钱&apos;:</span><br><span class="line">            return &#123;</span><br><span class="line">                money:&#123;</span><br><span class="line">                    amount:state.money.amount - action.payload</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        default:</span><br><span class="line">            return state</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const store = createStore(reducers);</span><br><span class="line">console.log(store.getState())</span><br><span class="line"></span><br><span class="line">class App extends React.Component&#123;</span><br><span class="line">    constructor()&#123;</span><br><span class="line">        super()</span><br><span class="line">    &#125;</span><br><span class="line">    render()&#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div className=&quot;root&quot;&gt;</span><br><span class="line">                &lt;div&gt;app&lt;/div&gt;</span><br><span class="line">                &lt;FirstFather money=&#123;this.props.store.money&#125;/&gt;</span><br><span class="line">                &lt;SecondFather money=&#123;this.props.store.money&#125;/&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class FirstFather extends React.Component&#123;</span><br><span class="line">    constructor()&#123;</span><br><span class="line">        super()</span><br><span class="line">    &#125;</span><br><span class="line">    render()&#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div className=&quot;papa&quot;&gt;</span><br><span class="line">                &lt;div&gt;大爸 &#123;this.props.money.amount&#125;&lt;/div&gt;</span><br><span class="line">                &lt;Son1 money=&#123;this.props.money&#125;/&gt;</span><br><span class="line">                &lt;Son2 money=&#123;this.props.money&#125;/&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class SecondFather extends React.Component&#123;</span><br><span class="line">    constructor()&#123;</span><br><span class="line">        super()</span><br><span class="line">    &#125;</span><br><span class="line">    render()&#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div className=&quot;papa&quot;&gt;</span><br><span class="line">                &lt;div&gt;二爸 &#123;this.props.money.amount&#125;&lt;/div&gt;</span><br><span class="line">                &lt;Son3 money=&#123;this.props.money&#125;/&gt;</span><br><span class="line">                &lt;Son4 money=&#123;this.props.money&#125;/&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Son1 extends React.Component&#123;</span><br><span class="line">    constructor()&#123;</span><br><span class="line">        super()</span><br><span class="line">    &#125;</span><br><span class="line">    render()&#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div className=&quot;son&quot;&gt;</span><br><span class="line">                儿子1 &#123;this.props.money.amount&#125;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Son2 extends React.Component&#123;</span><br><span class="line">    constructor()&#123;</span><br><span class="line">        super()</span><br><span class="line">    &#125;</span><br><span class="line">    x()&#123;</span><br><span class="line">        // active       </span><br><span class="line">        // eventHub.trigger(&apos;我想花钱&apos; /* action type */,100) //100叫做 payload</span><br><span class="line">        store.dispatch(&#123;type:&apos;我想花钱&apos;,payload:100&#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    render()&#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div className=&quot;son&quot;&gt;</span><br><span class="line">                儿子2 &#123;this.props.money.amount&#125;</span><br><span class="line">                &lt;button onClick=&#123;()=&gt;this.x()&#125;&gt;消费&lt;/button&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Son3 extends React.Component&#123;</span><br><span class="line">    constructor()&#123;</span><br><span class="line">        super()</span><br><span class="line">    &#125;</span><br><span class="line">    render()&#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div className=&quot;son&quot;&gt;</span><br><span class="line">                儿子3 &#123;this.props.money.amount&#125;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Son4 extends React.Component&#123;</span><br><span class="line">    constructor()&#123;</span><br><span class="line">        super()</span><br><span class="line">    &#125;</span><br><span class="line">    render()&#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div className=&quot;son&quot;&gt;</span><br><span class="line">                儿子4 &#123;this.props.money.amount&#125;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function render()&#123;</span><br><span class="line">    ReactDOM.render(</span><br><span class="line">        &lt;App store=&#123;store.getState()&#125;/&gt;,</span><br><span class="line">        document.querySelector(&apos;#root&apos;)</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">render()</span><br><span class="line">// 订阅数据的改变同步更新</span><br><span class="line">store.subscribe(render)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>是不是觉得Redux很啰嗦</p>
</blockquote>
<ul>
<li>eventHub能看懂</li>
<li>用 redux反而很恶心</li>
</ul>
<blockquote>
<h4 id="Redux为啥这样做"><a href="#Redux为啥这样做" class="headerlink" title="Redux为啥这样做"></a>Redux为啥这样做</h4></blockquote>
<ul>
<li>所有的框架都有一个使命——防呆(怕你的队友是个猪队友)</li>
<li>所以Redux最大的功能就是防呆</li>
</ul>
<blockquote>
<p>eventHub的问题</p>
</blockquote>
<ul>
<li><p>事件名可能任意的，分散在各处，而你用redux强制要求你集中的在 switch里</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">let reducers = (state = 0 ,action)=&gt;&#123;</span><br><span class="line">    //初始化</span><br><span class="line">    state = state ||&#123;</span><br><span class="line">        money:&#123; amount:100000 &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    switch(action.type)&#123;</span><br><span class="line">        case &apos;我想花钱&apos;:</span><br><span class="line">            return &#123;</span><br><span class="line">                money:&#123;</span><br><span class="line">                    amount:state.money.amount - action.payload</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        default:</span><br><span class="line">            return state</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>redux的约束 你必须每个事件给我一个事件名和 payload 并且列在一起</p>
</li>
<li><p>你只能用 props的方式 使用 store={store.getState()}</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//getState()只读的方式告诉你  不要修改</span><br><span class="line">//因为通过 props能防猪队友 </span><br><span class="line"></span><br><span class="line">// 猪队友</span><br><span class="line">// 通过引用修改数据</span><br><span class="line">this.props.money.amount -= 200</span><br><span class="line">// 即使用redux 依然也是可以通过引用改的</span><br><span class="line">这是 JS的 bug</span><br></pre></td></tr></table></figure>
</li>
<li><p>redux可以让不懂英语的前端 走远一点</p>
</li>
<li>比如 payload 实际就是个 data </li>
</ul>
<p><a href="https://github.com/slTrust/React-study" target="_blank" rel="noopener">代码仓库</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/01/14/React入门004之React通信Redux代替eventHub/" data-id="cklcb6bmx00p1wo91c2wp7w82" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React入门/">React入门</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/23/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/22/">22</a><a class="page-number" href="/page/23/">23</a><span class="page-number current">24</span><a class="page-number" href="/page/25/">25</a><a class="page-number" href="/page/26/">26</a><span class="space">&hellip;</span><a class="page-number" href="/page/54/">54</a><a class="extend next" rel="next" href="/page/25/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS/">CSS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ES6速学/">ES6速学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JS不知深浅/">JS不知深浅</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M01/">M01</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M02/">M02</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M03/">M03</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M04/">M04</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M06/">M06</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M07/">M07</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M08/">M08</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M09/">M09</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NodeWeb/">NodeWeb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Node后端/">Node后端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ReactWheels/">ReactWheels</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React入门/">React入门</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TS入门/">TS入门</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/express/">express</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fullstack/">fullstack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/http/">http</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jQuery/">jQuery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mobile/">mobile</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/">mongodb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node/">node</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node每日精进/">node每日精进</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/oak/">oak</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tools/">tools</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vim/">vim</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vue/">vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vultr/">vultr</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web性能优化/">web性能优化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web面经/">web面经</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端知识点/">前端知识点</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/CSS/" style="font-size: 13.75px;">CSS</a> <a href="/tags/ES6速学/" style="font-size: 14.17px;">ES6速学</a> <a href="/tags/JS不知深浅/" style="font-size: 11.25px;">JS不知深浅</a> <a href="/tags/M01/" style="font-size: 13.33px;">M01</a> <a href="/tags/M02/" style="font-size: 15.42px;">M02</a> <a href="/tags/M03/" style="font-size: 15.83px;">M03</a> <a href="/tags/M04/" style="font-size: 16.25px;">M04</a> <a href="/tags/M06/" style="font-size: 18.33px;">M06</a> <a href="/tags/M07/" style="font-size: 17.92px;">M07</a> <a href="/tags/M08/" style="font-size: 17.08px;">M08</a> <a href="/tags/M09/" style="font-size: 11.67px;">M09</a> <a href="/tags/NodeWeb/" style="font-size: 14.58px;">NodeWeb</a> <a href="/tags/Node后端/" style="font-size: 18.75px;">Node后端</a> <a href="/tags/ReactWheels/" style="font-size: 16.67px;">ReactWheels</a> <a href="/tags/React入门/" style="font-size: 15.42px;">React入门</a> <a href="/tags/TS入门/" style="font-size: 15px;">TS入门</a> <a href="/tags/express/" style="font-size: 10.42px;">express</a> <a href="/tags/fullstack/" style="font-size: 17.92px;">fullstack</a> <a href="/tags/http/" style="font-size: 12.08px;">http</a> <a href="/tags/jQuery/" style="font-size: 10px;">jQuery</a> <a href="/tags/java/" style="font-size: 19.17px;">java</a> <a href="/tags/linux/" style="font-size: 10.83px;">linux</a> <a href="/tags/mobile/" style="font-size: 11.25px;">mobile</a> <a href="/tags/mongodb/" style="font-size: 12.5px;">mongodb</a> <a href="/tags/mysql/" style="font-size: 12.5px;">mysql</a> <a href="/tags/node/" style="font-size: 10.42px;">node</a> <a href="/tags/node每日精进/" style="font-size: 10px;">node每日精进</a> <a href="/tags/oak/" style="font-size: 20px;">oak</a> <a href="/tags/python/" style="font-size: 17.5px;">python</a> <a href="/tags/tools/" style="font-size: 10px;">tools</a> <a href="/tags/vim/" style="font-size: 10px;">vim</a> <a href="/tags/vue/" style="font-size: 12.92px;">vue</a> <a href="/tags/vultr/" style="font-size: 10px;">vultr</a> <a href="/tags/web性能优化/" style="font-size: 10px;">web性能优化</a> <a href="/tags/web面经/" style="font-size: 10px;">web面经</a> <a href="/tags/前端知识点/" style="font-size: 19.58px;">前端知识点</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/02/18/Node-web05-07博客系统部署/">Node-web05-07博客系统部署</a>
          </li>
        
          <li>
            <a href="/2021/02/18/Node-web05-06博客系统后端分页/">Node-web05-06博客系统后端分页</a>
          </li>
        
          <li>
            <a href="/2021/02/18/Node-web05-05博客系统创建博客/">Node-web05-05博客系统创建博客</a>
          </li>
        
          <li>
            <a href="/2021/02/18/Node-web05-04博客系统登录/">Node-web05-04博客系统登录</a>
          </li>
        
          <li>
            <a href="/2021/02/18/Node-web05-03博客系统注册/">Node-web05-03博客系统注册</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 Stevin<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>