<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  

  
  <title>Almost</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Almost">
<meta property="og:url" content="http://yoursite.com/page/15/index.html">
<meta property="og:site_name" content="Almost">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Almost">
  
    <link rel="alternate" href="/atom.xml" title="Almost" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Almost</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-TS入门014ts高级类型下" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/08/12/TS入门014ts高级类型下/" class="article-date">
  <time datetime="2019-08-12T15:30:47.000Z" itemprop="datePublished">2019-08-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/08/12/TS入门014ts高级类型下/">TS入门014ts高级类型下</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="可识别联合"><a href="#可识别联合" class="headerlink" title="可识别联合"></a>可识别联合</h3><ul>
<li>a</li>
<li>TS可以通过一个特征值来区分类型<ul>
<li>在 Redux 的 Action 中经常用到</li>
</ul>
</li>
</ul>
<blockquote>
<p>我们需要 N 选一</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">interface Props &#123;</span><br><span class="line">    action:&apos;create&apos;|&apos;update&apos;;</span><br><span class="line">    id?:number;</span><br><span class="line">    name:string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 创建的时候 </span><br><span class="line">&#123;</span><br><span class="line">    action:&apos;create&apos;,</span><br><span class="line">    // 创建时没id</span><br><span class="line">    name:&apos;aaa&apos;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 更新的时候 </span><br><span class="line">&#123;</span><br><span class="line">    action:&apos;update&apos;,</span><br><span class="line">    // 更新时必须有id</span><br><span class="line">    id:1,</span><br><span class="line">    name:&apos;bbb&apos;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 此时你可以这样</span><br><span class="line"></span><br><span class="line">type Props2 = &#123;</span><br><span class="line">    action:&apos;create&apos;;</span><br><span class="line">    name:string;</span><br><span class="line">&#125; | &#123;</span><br><span class="line">    action:&apos;update&apos;;</span><br><span class="line">    id:number;</span><br><span class="line">    name:string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function fn(a:Props2)&#123;</span><br><span class="line">    if(a.action === &apos;create&apos;)&#123;</span><br><span class="line">        console.log(a.name)</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        console.log(a.id)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>可识别联合的前置条件</p>
</blockquote>
<ul>
<li>必须有一个或多个共有字段 <code>如上面的 action</code></li>
<li>共有类型必须是可以穷举的</li>
</ul>
<blockquote>
<p>Redux 的 Actoin</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">type Action = &#123;</span><br><span class="line">    type:&apos;add&apos;,payload:number;</span><br><span class="line">&#125; | &#123;</span><br><span class="line">    type:&apos;delete&apos;,payload:string;</span><br><span class="line">&#125; | &#123;</span><br><span class="line">    type:&apos;update&apos;,payload:Date;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function reducer(state:any,actoin:Action)&#123;</span><br><span class="line">    switch(actoin.type)&#123;</span><br><span class="line">        case &apos;add&apos;:</span><br><span class="line">            console.log(actoin.payload) // number</span><br><span class="line">            break</span><br><span class="line">        case &apos;delete&apos;:</span><br><span class="line">            console.log(actoin.payload) // string</span><br><span class="line">            break</span><br><span class="line">        case &apos;update&apos;:</span><br><span class="line">            console.log(actoin.payload) // Date</span><br><span class="line">            break</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="参考代码-ts014"><a href="#参考代码-ts014" class="headerlink" title="参考代码 ts014"></a>参考代码 ts014</h4><ul>
<li>代码库<a href="https://github.com/slTrust/ts-study" target="_blank" rel="noopener">https://github.com/slTrust/ts-study</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/08/12/TS入门014ts高级类型下/" data-id="ckovg9eu500z38yjktvd6dmcm" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/TS入门/">TS入门</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-TS入门013ts高级类型上" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/08/12/TS入门013ts高级类型上/" class="article-date">
  <time datetime="2019-08-12T14:03:49.000Z" itemprop="datePublished">2019-08-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/08/12/TS入门013ts高级类型上/">TS入门013ts高级类型上</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="类型的且运算"><a href="#类型的且运算" class="headerlink" title="类型的且运算"></a>类型的且运算</h3><ul>
<li>你的新类型 c 必须同时满足 A 和 B接口的约束，否则报错</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">interface A &#123;</span><br><span class="line">    name:string;</span><br><span class="line">    age:number</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">interface B &#123;</span><br><span class="line">    name:string;</span><br><span class="line">    grade:number</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const c: A &amp; B = &#123;</span><br><span class="line">    name:&apos;aaa&apos;,</span><br><span class="line">    age:11,</span><br><span class="line">    grade:100</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<h4 id="React-里使用这个-且运算"><a href="#React-里使用这个-且运算" class="headerlink" title="React 里使用这个 且运算"></a>React 里使用这个 且运算</h4></blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import React from &apos;react&apos;;</span><br><span class="line"></span><br><span class="line">const Layout : React.FunctionComponent &amp; &#123; Header :React.FunctionComponent &#125; = ()=&gt;&#123;</span><br><span class="line">    return (</span><br><span class="line">        React.createElement(&apos;div&apos;,null,&apos;hi&apos;)</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Layout.Header = ()=&gt;&#123;</span><br><span class="line">    return (</span><br><span class="line">        React.createElement(&apos;div&apos;,null,&apos;hi&apos;)</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>垂直写法</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">interface Layout2 extends React.FunctionComponent&#123;</span><br><span class="line">    Header:React.FunctionComponent</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const Layout2:Layout2 = ()=&gt;&#123;</span><br><span class="line">    return (</span><br><span class="line">        React.createElement(&apos;div&apos;,null,&apos;hi&apos;)</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line">Layout2.Header = ()=&gt;&#123;</span><br><span class="line">    return (</span><br><span class="line">        React.createElement(&apos;div&apos;,null,&apos;hi&apos;)</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>小知识点:接口名和变量能一样吗？ </p>
</blockquote>
<ul>
<li>可以 ts 自己就能识别</li>
</ul>
<h3 id="类型的或运算"><a href="#类型的或运算" class="headerlink" title="类型的或运算"></a>类型的或运算</h3><ul>
<li>都满足</li>
<li>满足其中一个</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    interface A &#123;</span><br><span class="line">        name:string;</span><br><span class="line">        age:number</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    interface B &#123;</span><br><span class="line">        name:string;</span><br><span class="line">        grade:number</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // 都满足</span><br><span class="line">    const c: A | B = &#123;</span><br><span class="line">        name:&apos;aaa&apos;,</span><br><span class="line">        age:11,</span><br><span class="line">        grade:100</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 满足单个</span><br><span class="line">    const c1: A | B = &#123;</span><br><span class="line">        name:&apos;aaa&apos;,</span><br><span class="line">        age:11</span><br><span class="line">    &#125;</span><br><span class="line">    // 满足单个</span><br><span class="line">    const c2: A | B = &#123;</span><br><span class="line">        name:&apos;aaa&apos;,</span><br><span class="line">        grade:11</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>或运算的歧义</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">function add(a : number|string,b : number|string)&#123;</span><br><span class="line">    // 标红</span><br><span class="line">    // 运算符“+”不能应用于类型“string | number”和“string | number”。</span><br><span class="line">    return a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">add(1,2)</span><br><span class="line">add(&apos;1&apos;,&apos;2&apos;)</span><br><span class="line">add(1,&apos;2&apos;)</span><br></pre></td></tr></table></figure>
<p>你想到的解决办法 <strong>泛型</strong> 其实也不行，因为你怎么保证 这俩类型可以”+”呢？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function add&lt;T&gt;(a : T,b : T )&#123;</span><br><span class="line">    //运算符“+”不能应用于类型“T”和“T”</span><br><span class="line">    return a + b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<h4 id="答案是使用-重载"><a href="#答案是使用-重载" class="headerlink" title="答案是使用 重载"></a>答案是使用 重载</h4></blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function add(a:string,b : string ):string;</span><br><span class="line">function add(a:number,b : number ):number;</span><br><span class="line">function add(a:any,b : any ):any&#123;</span><br><span class="line">    return a + b;</span><br><span class="line">&#125;</span><br><span class="line">add(1,2)</span><br><span class="line">add(&apos;1&apos;,&apos;2&apos;)</span><br></pre></td></tr></table></figure>
<h3 id="类型别名-type"><a href="#类型别名-type" class="headerlink" title="类型别名 type"></a>类型别名 type</h3><ul>
<li>给一个已知的类型取一个别名</li>
</ul>
<blockquote>
<p>别名 type 和 interface的区别</p>
</blockquote>
<ul>
<li>interface 是声明了一个新的类型</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">import React from &apos;react&apos;;</span><br><span class="line"></span><br><span class="line">const Layout : React.FunctionComponent &amp; &#123; Header :React.FunctionComponent &#125; = ()=&gt;&#123;</span><br><span class="line">    return (</span><br><span class="line">        React.createElement(&apos;div&apos;,null,&apos;hi&apos;)</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Layout.Header = ()=&gt;&#123;</span><br><span class="line">    return (</span><br><span class="line">        React.createElement(&apos;div&apos;,null,&apos;hi&apos;)</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 上面的 &amp; 运算之后 类型会显得很长</span><br><span class="line">// 别名的使用：给已知类型一个名字</span><br><span class="line">type MyLayout = React.FunctionComponent &amp; &#123; Header :React.FunctionComponent &#125; </span><br><span class="line">const Layout2 : MyLayout = ()=&gt;&#123;</span><br><span class="line">    return (</span><br><span class="line">        React.createElement(&apos;div&apos;,null,&apos;hi&apos;)</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Layout2.Header = ()=&gt;&#123;</span><br><span class="line">    return (</span><br><span class="line">        React.createElement(&apos;div&apos;,null,&apos;hi&apos;)</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="字面量类型"><a href="#字面量类型" class="headerlink" title="字面量类型"></a>字面量类型</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">interface People &#123;</span><br><span class="line">    gender :  &apos;男&apos; | &apos;女&apos;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const a:People = &#123;</span><br><span class="line">    // 报错 ，限定了 gender 必须是 &apos;男&apos; or &apos;女&apos;</span><br><span class="line">    // gender :&apos;人妖&apos;</span><br><span class="line">    gender:&apos;男&apos;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 方向</span><br><span class="line">type Dir = &apos;上&apos; | &apos;下&apos; | &apos;左&apos; | &apos;右&apos;</span><br><span class="line">// const dir: Dir = &apos;e&apos;; // 直接报错</span><br><span class="line">const dir : Dir = &apos;上&apos;</span><br><span class="line"></span><br><span class="line">// 字面量类型 还能包含多个类型取值</span><br><span class="line">type Aa= 1 | 2 | 3 | 4 | 5 | 6</span><br><span class="line">type Bb = true | false | 6 | &apos;上&apos;</span><br><span class="line"></span><br><span class="line">// 丰富的类型搭配</span><br><span class="line">interface People &#123;</span><br><span class="line">    gender :  &apos;男&apos; | &apos;女&apos;,</span><br><span class="line">    name? : string;</span><br><span class="line">    name2: string | undefined;</span><br><span class="line">    name3: string | undefined | null;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="this-也有类型"><a href="#this-也有类型" class="headerlink" title="this 也有类型"></a>this 也有类型</h3><ul>
<li>链式操作</li>
<li>this多态</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    class Calc &#123;</span><br><span class="line">        public value: number</span><br><span class="line">        constructor(n:number)&#123;</span><br><span class="line">            this.value = n</span><br><span class="line">        &#125;</span><br><span class="line">        add(n:number)&#123;</span><br><span class="line">            this.value += n;</span><br><span class="line">            return this;</span><br><span class="line">        &#125;</span><br><span class="line">        multiple(n:number)&#123;</span><br><span class="line">            this.value *= n;</span><br><span class="line">            return this;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 多态</span><br><span class="line">    class BiggerCalc extends Calc &#123;</span><br><span class="line">        sin()&#123;</span><br><span class="line">            this.value = Math.sin(this.value);</span><br><span class="line">            return this;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    const c = new Calc(1);</span><br><span class="line">    c.add(1).multiple(2);</span><br><span class="line"></span><br><span class="line">    const bc = new BiggerCalc(1);</span><br><span class="line">    bc.add(1).multiple(2).sin(3).add(1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>this的类型</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    function fn(n:number)&#123;</span><br><span class="line">        console.log(n)</span><br><span class="line">    &#125;</span><br><span class="line">    fn(1);</span><br><span class="line">    fn.call(&apos;string&apos;,1);</span><br><span class="line"></span><br><span class="line">    // this 也可以是参数，我怎么指定this的类型</span><br><span class="line">    function fn2(this:string,n:number)&#123;</span><br><span class="line">        console.log(n)</span><br><span class="line">    &#125;</span><br><span class="line">    // 报错了</span><br><span class="line">    // fn2(1); this is undefined</span><br><span class="line">    fn2.call(&apos;string&apos;,1);</span><br><span class="line"></span><br><span class="line">    // 如何解决这个 不指定this的报错呢？ void</span><br><span class="line">    function fn3(this: string | void,n:number)&#123;</span><br><span class="line">        console.log(n)</span><br><span class="line">    &#125;</span><br><span class="line">    fn3(1);</span><br><span class="line">    fn3.call(&apos;string&apos;,1);</span><br><span class="line">    fn3.call(true,1) // 居然也成功了 ！！！ </span><br><span class="line">    // 因为 ts 对 call 不做类型检查</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>这个一般只有写底层库的时候可能用到</li>
</ul>
<h3 id="索引类型-keyof-和-T-K"><a href="#索引类型-keyof-和-T-K" class="headerlink" title="索引类型 keyof 和 T[K]"></a>索引类型 keyof 和 T[K]</h3><blockquote>
<p>索引类型</p>
</blockquote>
<p>假如你有个函数,它的参数是对象 <code>opt = {name:xxx,bbb:xxx,ccc:xxx ...}</code> 可无限扩展的参数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    const fn = (options)=&gt;&#123;&#125;</span><br><span class="line"></span><br><span class="line">    var options = &#123;</span><br><span class="line">        time: new Date,</span><br><span class="line">        isEdit: true,</span><br><span class="line">        size : 20,</span><br><span class="line">        name :  &apos;xxx&apos;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fn(options)</span><br><span class="line"></span><br><span class="line">    // 如何声明 options 的类型呢?</span><br><span class="line">    interface fnOptions &#123;</span><br><span class="line">        // 我的 key 必须是 string ，value 是任意值</span><br><span class="line">        [K:string]:any</span><br><span class="line">    &#125;</span><br><span class="line">    // 以前你要这样</span><br><span class="line">    interface fnOptions2&#123;</span><br><span class="line">        size:number</span><br><span class="line">        name:string</span><br><span class="line">    &#125;</span><br><span class="line">    const fn2 = (options:fnOptions)=&gt;&#123;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    // T[K] 是啥</span><br><span class="line">    // 只能传递 前面有的 key</span><br><span class="line">    function pluck&lt;T, K extends keyof T&gt;(objext:T,keys:Array&lt;K&gt;) &#123;</span><br><span class="line">        // T - &#123;name:string,age:number,grade:number&#125;</span><br><span class="line">        // keyof T - &apos;name&apos;|&apos;age&apos;|&apos;grade&apos;</span><br><span class="line">        // K extends keyof T - &apos;name&apos;|&apos;age&apos;|&apos;grade&apos;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    // 第二个参数数组 必须是  第一个参数里的 key 否则报错</span><br><span class="line">    pluck(&#123;name:&apos;hjx&apos;,age:18,grade:100&#125;,[&apos;name&apos;,&apos;age&apos;])</span><br><span class="line"></span><br><span class="line">    interface Person&#123;</span><br><span class="line">        name:string;</span><br><span class="line">        age:number;</span><br><span class="line">        grade:number;</span><br><span class="line">    &#125;</span><br><span class="line">    type X = keyof Person; // X 只能是 Person里的属性</span><br><span class="line"></span><br><span class="line">    // T[K]返回值啥意思</span><br><span class="line">    function pluck2&lt;T, K extends keyof T&gt;(objext:T,keys:Array&lt;K&gt;): T[K][] &#123;</span><br><span class="line">        // 报错，因为 T[K] 里面是对应每个 key的类型 是动态的</span><br><span class="line">        // return &apos;string&apos;;</span><br><span class="line">        return keys.map(key =&gt; objext[key])        </span><br><span class="line">    &#125;</span><br><span class="line">    pluck2(&#123;name:&apos;hjx&apos;,age:18,grade:100&#125;,[&apos;name&apos;,&apos;age&apos;])</span><br><span class="line">    /* </span><br><span class="line">        [&apos;hjx&apos;,18] </span><br><span class="line">        =&gt; </span><br><span class="line">        Array&lt;Person[name]|Person[age]&gt; </span><br><span class="line">        =&gt;</span><br><span class="line">        Array&lt;T[K]&gt; </span><br><span class="line">        =&gt; </span><br><span class="line">        T[K][]</span><br><span class="line">    */</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Readonly-Partial"><a href="#Readonly-Partial" class="headerlink" title="Readonly / Partial"></a>Readonly / Partial</h3><blockquote>
<p>Readonly</p>
</blockquote>
<ul>
<li><code>Readonly&lt;T&gt;</code></li>
<li><code>readonly field</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    interface Person &#123;</span><br><span class="line">        name:string;</span><br><span class="line">        age:number;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    const p :Person = &#123;</span><br><span class="line">        name:&apos;aa&apos;,</span><br><span class="line">        age:12</span><br><span class="line">    &#125;</span><br><span class="line">    p.name = &apos;bb&apos;;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    // Readonly&lt;T&gt; 全部只读</span><br><span class="line">    const p2 :Readonly&lt;Person&gt; = &#123;</span><br><span class="line">        name:&apos;hjx&apos;,</span><br><span class="line">        age:18</span><br><span class="line">    &#125;</span><br><span class="line">    // p2.name = 1; // 报错</span><br><span class="line"></span><br><span class="line">    interface ReadonlyPerson &#123;</span><br><span class="line">        readonly name:string,</span><br><span class="line">        age:number;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    const p3 :ReadonlyPerson = &#123;</span><br><span class="line">        name:&apos;hjx&apos;,</span><br><span class="line">        age:18</span><br><span class="line">    &#125;</span><br><span class="line">    // p3.name = 1; // 报错</span><br><span class="line">    p3.age = 22</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Partial</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    interface Person &#123;</span><br><span class="line">        name:string;</span><br><span class="line">        age:number;</span><br><span class="line">        grade:number;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    interface Person2 &#123;</span><br><span class="line">        name?:string;</span><br><span class="line">        age?:number;</span><br><span class="line">        grade?:number;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    type Person3 = Partial&lt;Person&gt;;</span><br><span class="line">    // 等价于 Person2 </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    type P4 = Required&lt;Person3&gt;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="参考代码-ts013"><a href="#参考代码-ts013" class="headerlink" title="参考代码 ts013"></a>参考代码 ts013</h4><ul>
<li>代码库<a href="https://github.com/slTrust/ts-study" target="_blank" rel="noopener">https://github.com/slTrust/ts-study</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/08/12/TS入门013ts高级类型上/" data-id="ckovg9eu300yx8yjke6hokcen" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/TS入门/">TS入门</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-TS入门012ts和React之Class组件" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/08/12/TS入门012ts和React之Class组件/" class="article-date">
  <time datetime="2019-08-12T12:35:34.000Z" itemprop="datePublished">2019-08-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/08/12/TS入门012ts和React之Class组件/">TS入门012ts和React之Class组件</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="生成-ts-react-项目"><a href="#生成-ts-react-项目" class="headerlink" title="生成 ts-react 项目"></a>生成 ts-react 项目</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mkdir ts-react-demo</span><br><span class="line"></span><br><span class="line">cd ts-react-demo</span><br><span class="line"></span><br><span class="line"># 创建项目</span><br><span class="line">yarn create react-app . --typescript</span><br><span class="line"></span><br><span class="line"># 初始化成功，启动项目</span><br><span class="line">yarn start</span><br></pre></td></tr></table></figure>
<ul>
<li>移除无用文件</li>
<li><p>修改 src/index.tsx</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import React from &apos;react&apos;;</span><br><span class="line">import ReactDOM from &apos;react-dom&apos;;</span><br><span class="line">import App from &apos;./App&apos;;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(&lt;App /&gt;, document.getElementById(&apos;root&apos;));</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改 src/App.tsx</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import React from &apos;react&apos;;</span><br><span class="line">import Button from &apos;./components/button&apos;</span><br><span class="line"></span><br><span class="line">class App extends React.Component&#123;</span><br><span class="line">    render()&#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div className=&quot;App&quot;&gt;</span><br><span class="line">            &lt;Button&gt;你好&lt;/Button&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default App;</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改 src/components/button.tsx</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import React from &apos;react&apos;;</span><br><span class="line">import &apos;./button.css&apos;;</span><br><span class="line"></span><br><span class="line">class Button extends React.Component&#123;</span><br><span class="line">    render()&#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div className=&quot;button&quot;&gt;&#123;this.props.children&#125;&lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default Button;</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改 src/components/button.css</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">.button&#123;</span><br><span class="line">    border:1px solid grey;</span><br><span class="line">    display: inline-block;</span><br><span class="line">    justify-content: center;</span><br><span class="line">    align-items: center;</span><br><span class="line">    padding: 2px;</span><br><span class="line">    border-radius: 4px;</span><br><span class="line">    box-shadow: 0 0 3px black;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>此时初步代码完成了</p>
</li>
</ul>
<h4 id="如何控制-Button-的大小？-传递-size"><a href="#如何控制-Button-的大小？-传递-size" class="headerlink" title="如何控制 Button 的大小？ 传递 size"></a>如何控制 Button 的大小？ 传递 size</h4><ul>
<li>直接传递报错！  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">妄图直接传递 size 属性</span><br><span class="line"></span><br><span class="line">&lt;Button size=&quot;big&quot;&gt;你好&lt;/Button&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">不能将类型“&#123; children: string; size: string; &#125;”分配给类型“IntrinsicAttributes &amp; IntrinsicClassAttributes&lt;Button&gt; &amp; Readonly&lt;&#123;&#125;&gt; &amp; Readonly&lt;&#123; children?: ReactNode; &#125;&gt;”。</span><br><span class="line">类型“IntrinsicAttributes &amp; IntrinsicClassAttributes&lt;Button&gt; &amp; Readonly&lt;&#123;&#125;&gt; &amp; Readonly&lt;&#123; children?: ReactNode; &#125;&gt;”上不存在属性“size”。ts(2322)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<h4 id="泛型的使用"><a href="#泛型的使用" class="headerlink" title="泛型的使用"></a>泛型的使用</h4></blockquote>
<ul>
<li>给 Button 通过泛型传递参数列表<code>&lt; size: string &gt;</code></li>
<li>此时不报错了！！！</li>
<li>如果你想要给 Button 传递参数 就要把属性写到 泛型<code>&lt;&gt;</code>里</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">class Button extends React.Component&lt;&#123; size: string &#125;&gt;&#123;</span><br><span class="line">    render()&#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div className=&quot;button&quot;&gt;&#123;this.props.children&#125;&lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<h4 id="假如我有10个属性怎么办？"><a href="#假如我有10个属性怎么办？" class="headerlink" title="假如我有10个属性怎么办？"></a>假如我有10个属性怎么办？</h4></blockquote>
<p>泛型里的内容太多了 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">class Button extends React.Component&lt;</span><br><span class="line">    &#123; size: string ,</span><br><span class="line">      xxx1: string ,</span><br><span class="line">      xxx2: string ,</span><br><span class="line">      ...</span><br><span class="line">    &#125;&gt;&#123;...&#125;</span><br></pre></td></tr></table></figure>
<p><strong>你可以这样</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">type Props = &#123;</span><br><span class="line">    size: string,</span><br><span class="line">    xxx:string,</span><br><span class="line">    xxx2:string,</span><br><span class="line">    onClick:()=&gt;void</span><br><span class="line">&#125;</span><br><span class="line">class Button extends React.Component&lt;Props&gt;&#123;</span><br><span class="line">    render()&#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div className=&quot;button&quot;&gt;&#123;this.props.children&#125;&lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>你还可以使用接口 interface</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">interface IProps &#123;</span><br><span class="line">    size: string,</span><br><span class="line">    xxx:string,</span><br><span class="line">    xxx2:string,</span><br><span class="line">    onClick:()=&gt;void</span><br><span class="line">&#125;</span><br><span class="line">class Button extends React.Component&lt;IProps&gt;&#123;</span><br><span class="line">    render()&#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div className=&quot;button&quot;&gt;&#123;this.props.children&#125;&lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="如果我有-state-怎么办？"><a href="#如果我有-state-怎么办？" class="headerlink" title="如果我有 state 怎么办？"></a>如果我有 state 怎么办？</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">// ? 代表 可选参数 反之必填</span><br><span class="line">interface IProps &#123;</span><br><span class="line">    size: string,</span><br><span class="line">    xxx?:string,</span><br><span class="line">    xxx2?:string,</span><br><span class="line">    onClick?:()=&gt;void</span><br><span class="line">&#125;</span><br><span class="line">interface IState &#123;</span><br><span class="line">    n : number</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Button extends React.Component&lt;IProps,IState&gt;&#123;</span><br><span class="line">    // 这里 必须给 props 指定类型 否则报错</span><br><span class="line">    constructor(props:IProps)&#123;</span><br><span class="line">        super(props)</span><br><span class="line">        this.state = &#123;</span><br><span class="line">            n:1</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    render()&#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div className=&quot;button&quot;&gt;</span><br><span class="line">                &#123;this.props.children&#125;</span><br><span class="line"></span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="displayName-是什么"><a href="#displayName-是什么" class="headerlink" title="displayName 是什么"></a>displayName 是什么</h4><ul>
<li>给你组件起的名字，如果你的google 里安装了 react devtools 你的组件就会显示你设置的名字</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">class Button extends React.Component&#123;</span><br><span class="line">    // 开发者工具里显示的名字</span><br><span class="line">    static displayName = &quot;HjxButton&quot;</span><br><span class="line">    render()&#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="默认-props-值"><a href="#默认-props-值" class="headerlink" title="默认 props 值"></a>默认 props 值</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">interface IProps &#123;</span><br><span class="line">    size: string,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Button extends React.Component&lt;IProps&gt;&#123;</span><br><span class="line">    // 这里给 size 设置默认值 当你不传递的时候</span><br><span class="line">    static defaultProps = &#123;</span><br><span class="line">        size : &apos;normal&apos;</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="TS-帮你做分析"><a href="#TS-帮你做分析" class="headerlink" title="TS 帮你做分析"></a>TS 帮你做分析</h4><ul>
<li>断言</li>
<li>if 判断</li>
<li>规避 js <code>undefined + 1 = NaN</code> 的bug</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">interface IProps &#123;</span><br><span class="line">    size: string,</span><br><span class="line">    xxx?:string,</span><br><span class="line">    xxx2?:string,</span><br><span class="line">    onClick?:()=&gt;void</span><br><span class="line">&#125;</span><br><span class="line">interface IState &#123;</span><br><span class="line">    n : number </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Button extends React.Component&lt;IProps&gt;&#123;</span><br><span class="line">    // 这里给 size 设置默认值 当你不传递的时候</span><br><span class="line">    static defaultProps = &#123;</span><br><span class="line">        size : &apos;normal&apos;,</span><br><span class="line">        xxx: &apos;aaa&apos;</span><br><span class="line">    &#125;</span><br><span class="line">    constructor(props:IProps)&#123;</span><br><span class="line">        super(props)</span><br><span class="line">        // 这句话报错 因为 xxx 可能是 undefined </span><br><span class="line">        // undefined 不能直接和数字 + 操作</span><br><span class="line">        // console.log(this.props.xxx + 1)</span><br><span class="line">        // 解决办法就是 加一个 “!”</span><br><span class="line">        // 就是断言 保证它不会为空 ，出问题自己负责</span><br><span class="line">        console.log(this.props.xxx! + 1)</span><br><span class="line">        // 或者这样</span><br><span class="line">        console.log(this.props.xxx as string + 1)</span><br><span class="line">        // 或者还可以这样</span><br><span class="line">        if(this.props.xxx === undefined)&#123;</span><br><span class="line"></span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            console.log(this.props.xxx + 1)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    render()&#123;</span><br><span class="line">          ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="onClick-事件如何写"><a href="#onClick-事件如何写" class="headerlink" title="onClick 事件如何写"></a>onClick 事件如何写</h4><p>src/App.tsx</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">class App extends React.Component&#123;</span><br><span class="line">    // 参数也要声明类型</span><br><span class="line">    onClick(e:React.MouseEvent)&#123;</span><br><span class="line">      console.log(e)</span><br><span class="line">    &#125;</span><br><span class="line">    render()&#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div className=&quot;App&quot;&gt;</span><br><span class="line">              &lt;Button onClick=&#123;this.onClick&#125;&gt;你好&lt;/Button&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>src/components/button.tsx</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">interface IProps &#123;</span><br><span class="line">    // 声明它的类型</span><br><span class="line">    onClick?: React.MouseEventHandler</span><br><span class="line">&#125;</span><br><span class="line">class Button extends React.Component&lt;IProps&gt;&#123;</span><br><span class="line">    render()&#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div className=&quot;button&quot; onClick=&#123;this.props.onClick&#125;&gt;</span><br><span class="line">                &#123;this.props.children&#125;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="我想打印-click-事件源的一些东西"><a href="#我想打印-click-事件源的一些东西" class="headerlink" title="我想打印 click 事件源的一些东西"></a>我想打印 click 事件源的一些东西</h4><p>src/App.tsx 里</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"> /*</span><br><span class="line">onClick(e:React.MouseEvent)&#123;</span><br><span class="line">    console.log(e)</span><br><span class="line">    // style 竟然标红了 </span><br><span class="line">    // 提示 类型“EventTarget”上不存在属性“style”。</span><br><span class="line">    //console.log(e.target.style.width)</span><br><span class="line">    // 你只能断言</span><br><span class="line">    // const div = e.target as HTMLDivElement;</span><br><span class="line">    // console.log(div.style.width)</span><br><span class="line"></span><br><span class="line">    // 断言还是有风险，因为 如果 Button 里传递的是 &lt;span&gt;hi&lt;/span&gt;你好</span><br><span class="line">    // 断言就有问题了 它不是 div 有可能是 span</span><br><span class="line">&#125;</span><br><span class="line">*/</span><br><span class="line">// 泛型参数 指定触发事件的元素一定是个 div</span><br><span class="line">onClick(e:React.MouseEvent&lt;HTMLDivElement&gt;)&#123;</span><br><span class="line">    console.log(e.currentTarget)</span><br><span class="line">    const div = e.currentTarget;</span><br><span class="line">    console.log(div.style.width)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="state-的一些问题"><a href="#state-的一些问题" class="headerlink" title="state 的一些问题"></a>state 的一些问题</h4><ul>
<li>新建 src/components/button2.tsx</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">import React from &apos;react&apos;;</span><br><span class="line">import &apos;./button.css&apos;;</span><br><span class="line"></span><br><span class="line">interface IProps &#123;</span><br><span class="line">    size?: string,</span><br><span class="line">&#125;</span><br><span class="line">interface IState &#123;</span><br><span class="line">    n : number </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Button2 extends React.Component&lt;IProps,IState&gt;&#123;</span><br><span class="line">    constructor(props:IProps)&#123;</span><br><span class="line">        super(props)</span><br><span class="line">        this.state = &#123;</span><br><span class="line">            n:1</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    onClick()&#123;</span><br><span class="line">        this.x();</span><br><span class="line">    &#125;</span><br><span class="line">    x()&#123;</span><br><span class="line">        console.log(&apos;x&apos;);</span><br><span class="line">    &#125;</span><br><span class="line">    render()&#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div className=&quot;button&quot; onClick=&#123;this.onClick&#125;&gt;</span><br><span class="line">                &#123;this.props.children&#125;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default Button2;</span><br></pre></td></tr></table></figure>
<p><strong>点击后直接报错</strong> 因为 <code>this 是 undefined</code></p>
<blockquote>
<p>解决办法：onClick写成箭头函数</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">class Button2 extends React.Component&lt;IProps,IState&gt;&#123;</span><br><span class="line">    ...</span><br><span class="line">    onClick = () =&gt; &#123;</span><br><span class="line">        this.x();</span><br><span class="line">    &#125;</span><br><span class="line">    x()&#123;</span><br><span class="line">        console.log(&apos;x&apos;);</span><br><span class="line">    &#125;</span><br><span class="line">    render()&#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div className=&quot;button&quot; onClick=&#123;this.onClick&#125;&gt;</span><br><span class="line">                &#123;this.props.children&#125;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>还有一种不推荐的方式： bind(this)</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">class Button2 extends React.Component&lt;IProps,IState&gt;&#123;</span><br><span class="line">    ...</span><br><span class="line">    onClick()&#123;</span><br><span class="line">        this.x();</span><br><span class="line">    &#125;</span><br><span class="line">    x()&#123;</span><br><span class="line">        console.log(&apos;x&apos;);</span><br><span class="line">    &#125;</span><br><span class="line">    render()&#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div className=&quot;button&quot; onClick=&#123;this.onClick.bind(this)&#125;&gt;</span><br><span class="line">                &#123;this.props.children&#125;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="补充：事件有那些种类"><a href="#补充：事件有那些种类" class="headerlink" title="补充：事件有那些种类"></a>补充：事件有那些种类</h4><ul>
<li>React.MouseEventHandler</li>
<li>React.KeyboardEventHandler</li>
<li>React.TouchEventHandler</li>
<li>React.WheelEventHandler</li>
</ul>
<blockquote>
<p>如果你的 props 是 加”?”</p>
</blockquote>
<ul>
<li>使用时候加断言</li>
</ul>
<blockquote>
<p>onClick 的 this问题</p>
</blockquote>
<ul>
<li>箭头函数<code>onClick = () =&gt; { ... }</code></li>
<li>加 <code>bind(this)</code></li>
</ul>
<h4 id="参考代码-ts012"><a href="#参考代码-ts012" class="headerlink" title="参考代码 ts012"></a>参考代码 ts012</h4><ul>
<li>代码库<a href="https://github.com/slTrust/ts-study" target="_blank" rel="noopener">https://github.com/slTrust/ts-study</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/08/12/TS入门012ts和React之Class组件/" data-id="ckovg9eu000yt8yjklvzrea0p" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/TS入门/">TS入门</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-TS入门011ts和react应用" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/08/11/TS入门011ts和react应用/" class="article-date">
  <time datetime="2019-08-11T14:39:01.000Z" itemprop="datePublished">2019-08-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/08/11/TS入门011ts和react应用/">TS入门011ts和react应用</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="TS和React"><a href="#TS和React" class="headerlink" title="TS和React"></a>TS和React</h3><ul>
<li><p><a href="https://facebook.github.io/create-react-app/docs/adding-typescript" target="_blank" rel="noopener">typescript react</a></p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">npm i create-react-app@2.1.3 -g</span><br><span class="line"></span><br><span class="line">// 创建工程</span><br><span class="line">npx create-react-app my-app --typescript</span><br><span class="line"></span><br><span class="line"># or</span><br><span class="line"></span><br><span class="line">yarn create react-app my-app --typescript</span><br></pre></td></tr></table></figure>
</li>
<li><p>进入目录 <code>cd my-app</code></p>
</li>
<li>运行项目 <code>yarn start</code></li>
<li>成功</li>
</ul>
<h3 id="Button组件"><a href="#Button组件" class="headerlink" title="Button组件"></a>Button组件</h3><ul>
<li><p>修改 src/index.tsx</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import React from &apos;react&apos;;</span><br><span class="line">import ReactDOM from &apos;react-dom&apos;;</span><br><span class="line">import Button from &apos;./Button&apos;;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(&lt;div&gt;</span><br><span class="line">    HelloWorld</span><br><span class="line">    &lt;Button /&gt;</span><br><span class="line">&lt;/div&gt;, document.getElementById(&apos;root&apos;));</span><br></pre></td></tr></table></figure>
</li>
<li><p>src/Button.tsx</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import React from &apos;react&apos;;</span><br><span class="line">export default function Button()&#123;</span><br><span class="line">    return &lt;div className=&quot;button&quot;&gt;button&lt;/div&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>此时一个最简单的 Button  组件完成了</p>
</li>
</ul>
<blockquote>
<p>让 Button 接收 size ,为 Button 添加样式</p>
</blockquote>
<ul>
<li>src/Button.tsx 里引入 样式 <code>import &#39;./Button.css&#39;;</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import React from &apos;react&apos;;</span><br><span class="line">import &apos;./Button.css&apos;;</span><br><span class="line"></span><br><span class="line">interface iProps &#123;</span><br><span class="line">    // ？代表 size 可有可无</span><br><span class="line">    size?: string</span><br><span class="line">&#125;</span><br><span class="line">export default function Button(props: iProps) &#123;</span><br><span class="line">    return &lt;div className=&#123;`button $&#123;props.size&#125;`&#125;&gt;button&lt;/div&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>src/Button.css</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">.button&#123;</span><br><span class="line">    border:1px solid grey;</span><br><span class="line">    display: inline-block;</span><br><span class="line">    border-radius: 4px;</span><br><span class="line">    padding: 4px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.button:hover&#123;</span><br><span class="line">    background: black;</span><br><span class="line">    box-shadow: 0 0 2px black;</span><br><span class="line">    color:white;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.button.small&#123;</span><br><span class="line">    font-size: 12px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.button.big&#123;</span><br><span class="line">    font-size: 30px;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>src/index.tsx</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import React from &apos;react&apos;;</span><br><span class="line">import ReactDOM from &apos;react-dom&apos;;</span><br><span class="line">import Button from &apos;./Button&apos;;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(&lt;div&gt;</span><br><span class="line">    HelloWorld</span><br><span class="line">    &lt;Button size=&quot;small&quot;/&gt;</span><br><span class="line">    &lt;Button/&gt;</span><br><span class="line">    &lt;Button size=&quot;big&quot;/&gt;</span><br><span class="line">&lt;/div&gt;, document.getElementById(&apos;root&apos;));</span><br></pre></td></tr></table></figure>
<blockquote>
<h4 id="button-的文案显示如何控制？"><a href="#button-的文案显示如何控制？" class="headerlink" title="button 的文案显示如何控制？"></a>button 的文案显示如何控制？</h4></blockquote>
<ul>
<li>传递是字符串</li>
<li>传递是 <code>span</code></li>
<li>传递多个 <code>span</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ReactDOM.render(&lt;div&gt;</span><br><span class="line">    &lt;Button&gt;</span><br><span class="line">        &lt;span&gt;Click ME&lt;/span&gt;</span><br><span class="line">    &lt;/Button&gt;</span><br><span class="line">    &lt;Button&gt;</span><br><span class="line">        &lt;span&gt;Click ME&lt;/span&gt;</span><br><span class="line">        &lt;span&gt;Click ME&lt;/span&gt;</span><br><span class="line">    &lt;/Button&gt;</span><br><span class="line">    &lt;Button&gt;Click Me&lt;/Button&gt;</span><br><span class="line">&lt;/div&gt;, document.getElementById(&apos;root&apos;));</span><br></pre></td></tr></table></figure>
<p>通过props</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">interface iProps &#123;</span><br><span class="line">    // ？代表 size 可有可无</span><br><span class="line">    size?: string;</span><br><span class="line">    // 字符串 | 节点 | 节点数组</span><br><span class="line">    children?:string | JSX.Element | JSX.Element[];</span><br><span class="line">&#125;</span><br><span class="line">export default function Button(props: iProps) &#123;</span><br><span class="line">    return &lt;div className=&#123;`button $&#123;props.size&#125;`&#125;&gt;</span><br><span class="line">        &#123;props.children&#125;</span><br><span class="line">    &lt;/div&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="以后我定义组件，难道每次都要写一个-children-属性？"><a href="#以后我定义组件，难道每次都要写一个-children-属性？" class="headerlink" title="以后我定义组件，难道每次都要写一个 children 属性？"></a>以后我定义组件，难道每次都要写一个 <code>children</code> 属性？</h3><ul>
<li><p>react 给你提供了便利，你需要这样</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">interface iProps &#123;</span><br><span class="line">    // ？代表 size 可有可无</span><br><span class="line">    size?: string</span><br><span class="line">&#125;</span><br><span class="line">const Button:React.FunctionComponent = function (props) &#123;</span><br><span class="line">    return &lt;div className=&#123;`button $&#123;props.size&#125;`&#125;&gt;</span><br><span class="line">        &#123;props.children&#125;</span><br><span class="line">    &lt;/div&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default Button;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>FunctionComponent</strong> 是什么 vscode 点进去看看</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">interface FunctionComponent&lt;P = &#123;&#125;&gt; &#123;</span><br><span class="line">    (props: PropsWithChildren&lt;P&gt;, context?: any): ReactElement | null;</span><br><span class="line">    propTypes?: WeakValidationMap&lt;P&gt;;</span><br><span class="line">    contextTypes?: ValidationMap&lt;any&gt;;</span><br><span class="line">    defaultProps?: Partial&lt;P&gt;;</span><br><span class="line">    displayName?: string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// interface 代表接口 ，那么这个接口满足什么条件呢？</span><br><span class="line">// 有括号  (props: PropsWithChildren&lt;P&gt;, context?: any) 代表这是一个函数</span><br><span class="line">  interface FunctionComponent&lt;P = &#123;&#125;&gt; &#123;</span><br><span class="line">    (props: PropsWithChildren&lt;P&gt;, context?: any): ReactElement | null;</span><br><span class="line">    ... 后四个代表可选属性</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 这个函数的特征 接收两个参数 必填的 props 和 可选的 context</span><br><span class="line">// 同时 props 需要 满足 P 这个东西</span><br><span class="line"></span><br><span class="line">// P 是啥？</span><br><span class="line"></span><br><span class="line">意思就是 TS 类型可以接收参数 用 尖括号“&lt;P = &#123;&#125;&gt;”来写这个参数</span><br><span class="line">如果你不传递 P 那么这个值的参数就是 空的 =&gt; &quot;&#123;&#125;&quot;</span><br><span class="line"></span><br><span class="line">// 同时这个函数的返回值是 “ReactElement” 类型否则报错</span><br></pre></td></tr></table></figure>
</li>
<li><p>改写我们的 Button.tsx 给它传递参数 <strong>P 为 iProps</strong> 这样我们就可以不写 <strong>children</strong></p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">interface iProps &#123;</span><br><span class="line">    // ？代表 size 可有可无</span><br><span class="line">    size?: string</span><br><span class="line">&#125;</span><br><span class="line">const Button:React.FunctionComponent&lt;iProps&gt; = function (props) &#123;</span><br><span class="line">    return &lt;div className=&#123;`button $&#123;props.size&#125;`&#125;&gt;</span><br><span class="line">        &#123;props.children&#125;</span><br><span class="line">    &lt;/div&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>这就是用react提供的函数组件直接声明一个函数组件</strong></p>
<h3 id="添加点击事件"><a href="#添加点击事件" class="headerlink" title="添加点击事件"></a>添加点击事件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">interface iProps &#123;</span><br><span class="line">    size?: string;</span><br><span class="line">    // 可有可无 ，而且你要的类型 React帮你做了</span><br><span class="line">    onClick?:React.MouseEventHandler</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// React.MouseEventHandler 是什么 点进去看看</span><br><span class="line">// 一脸懵逼！！！ 建议是没用三个月就别点进去看</span><br><span class="line">type MouseEventHandler&lt;T = Element&gt; = EventHandler&lt;MouseEvent&lt;T&gt;&gt;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>修改 button.tsx</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Children &#125; from &apos;react&apos;;</span><br><span class="line">import &apos;./Button.css&apos;;</span><br><span class="line"></span><br><span class="line">// 第二种方式</span><br><span class="line">interface iProps &#123;</span><br><span class="line">    // ？代表 size 可有可无</span><br><span class="line">    size?: string;</span><br><span class="line">    onClick?:React.MouseEventHandler</span><br><span class="line">&#125;</span><br><span class="line">const Button:React.FunctionComponent&lt;iProps&gt; = function (props) &#123;</span><br><span class="line">    return (</span><br><span class="line">        &lt;div className=&#123;`button $&#123;props.size&#125;`&#125; onClick=&#123;props.onClick&#125;</span><br><span class="line">        &gt;   </span><br><span class="line">        &#123;props.children&#125;</span><br><span class="line">        &lt;/div&gt;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default Button;</span><br></pre></td></tr></table></figure>
<p>src/index.tsx</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import React from &apos;react&apos;;</span><br><span class="line">import ReactDOM from &apos;react-dom&apos;;</span><br><span class="line">import Button from &apos;./Button&apos;;</span><br><span class="line"></span><br><span class="line">const fn:React.MouseEventHandler = function(e)&#123;</span><br><span class="line">    console.log(e);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(&lt;div&gt;</span><br><span class="line">    &lt;Button onClick=&#123;fn&#125;&gt;Click Me&lt;/Button&gt;</span><br><span class="line">&lt;/div&gt;, document.getElementById(&apos;root&apos;));</span><br></pre></td></tr></table></figure>
<p>参考代码 ts011</p>
<ul>
<li>代码库<a href="https://github.com/slTrust/ts-study" target="_blank" rel="noopener">https://github.com/slTrust/ts-study</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/08/11/TS入门011ts和react应用/" data-id="ckovg9etz00yp8yjkvobbuadk" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/TS入门/">TS入门</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-TS入门010ts和vue应用" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/08/11/TS入门010ts和vue应用/" class="article-date">
  <time datetime="2019-08-11T13:01:15.000Z" itemprop="datePublished">2019-08-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/08/11/TS入门010ts和vue应用/">TS入门010ts和vue应用</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="vue-ts组件写法参考"><a href="#vue-ts组件写法参考" class="headerlink" title="vue ts组件写法参考"></a>vue ts组件写法参考</h3><ul>
<li><a href="https://github.com/vuejs/vue-class-component" target="_blank" rel="noopener">vue-class-component</a></li>
<li>example</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;input v-model=&quot;msg&quot;&gt;</span><br><span class="line">    &lt;p&gt;prop: &#123;&#123;propMessage&#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;msg: &#123;&#123;msg&#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;helloMsg: &#123;&#123;helloMsg&#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;computed msg: &#123;&#123;computedMsg&#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;button @click=&quot;greet&quot;&gt;Greet&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import Vue from &apos;vue&apos;</span><br><span class="line">import Component from &apos;vue-class-component&apos;</span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">  props: &#123;</span><br><span class="line">    propMessage: String</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">export default class App extends Vue &#123;</span><br><span class="line">  // initial data</span><br><span class="line">  msg = 123</span><br><span class="line"></span><br><span class="line">  // use prop values for initial data</span><br><span class="line">  helloMsg = &apos;Hello, &apos; + this.propMessage</span><br><span class="line"></span><br><span class="line">  // lifecycle hook</span><br><span class="line">  mounted () &#123;</span><br><span class="line">    this.greet()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // computed</span><br><span class="line">  get computedMsg () &#123;</span><br><span class="line">    return &apos;computed &apos; + this.msg</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // method</span><br><span class="line">  greet () &#123;</span><br><span class="line">    alert(&apos;greeting: &apos; + this.msg)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h3 id="直接-google-typescript-vue"><a href="#直接-google-typescript-vue" class="headerlink" title="直接 google typescript vue"></a>直接 google <a href="https://cn.vuejs.org/v2/guide/typescript.html" target="_blank" rel="noopener">typescript vue</a></h3><ul>
<li>先把官网读完，否则就别继续</li>
</ul>
<h3 id="创建工程"><a href="#创建工程" class="headerlink" title="创建工程"></a>创建工程</h3><blockquote>
<p>如果你的是mac 安装的不是 我这版本的 vue 推荐卸载掉vue</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1.看vue版本 vue --version</span><br><span class="line">如果不是你想要的版本（3.0以下）执行</span><br><span class="line">要先开放用户权限</span><br><span class="line">sudo chmod -R 777 /usr/local/lib/node_modules/</span><br><span class="line">然后卸载2.0</span><br><span class="line">npm uninstall vue-cli -g</span><br><span class="line">然后 vue --version 确认卸载了</span><br><span class="line"></span><br><span class="line">然后装3.0 npm install -g @vue/cli</span><br></pre></td></tr></table></figure>
<blockquote>
<p>安装vue-cli3</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"># 1. 如果没有安装 Vue CLI 就先安装 ，我的是3.1.3 版本</span><br><span class="line">npm install --global @vue/cli@3.1.3 </span><br><span class="line"></span><br><span class="line"># 2. 创建一个新工程，并选择 &quot;Manually select features (手动选择特性)&quot; 选项</span><br><span class="line">vue create my-project-name</span><br><span class="line"></span><br><span class="line"># 3. 切换目录</span><br><span class="line">cd my-project-name</span><br><span class="line"></span><br><span class="line"># 4. 选择我们的配置</span><br><span class="line">Vue CLI v3.1.3</span><br><span class="line">? Please pick a preset: Manually select features</span><br><span class="line">? Check the features needed for your project: Babel, TS, CSS Pre-processors</span><br><span class="line">? Use class-style component syntax? Yes</span><br><span class="line">? Use Babel alongside TypeScript for auto-detected polyfills? Yes</span><br><span class="line">? Pick a CSS pre-processor (PostCSS, Autoprefixer and CSS Modules are supported </span><br><span class="line">by default): Sass/SCSS</span><br><span class="line">? Where do you prefer placing config for Babel, PostCSS, ESLint, etc.? In dedica</span><br><span class="line">ted config files</span><br><span class="line">? Save this as a preset for future projects? (y/N) n</span><br><span class="line"></span><br><span class="line"># 5. 安装成功后,启动这个项目</span><br><span class="line">yarn serve</span><br><span class="line"># 6. 在浏览器打开 http://localhost:8080/</span><br></pre></td></tr></table></figure>
<h3 id="CRM学习"><a href="#CRM学习" class="headerlink" title="CRM学习"></a>CRM学习</h3><ul>
<li>参考<a href="https://github.com/vuejs/vue-class-component" target="_blank" rel="noopener">vue-class-component</a></li>
</ul>
<blockquote>
<p>src/App.vue</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    props 值为name:&#123;&#123;name&#125;&#125;</span><br><span class="line">    Hi TS vue &lt;br&gt;</span><br><span class="line">    mixins 值为 ： &#123;&#123;mixinValue&#125;&#125; &lt;br&gt;</span><br><span class="line">    data里的msg: &#123;&#123;msg&#125;&#125;  &lt;br&gt;</span><br><span class="line">    &lt;button @click=&quot;fn&quot;&gt;点我&lt;/button&gt; &lt;br&gt;</span><br><span class="line">    为 HelloWorld 组件传递值 hjx &lt;br&gt;</span><br><span class="line">    &lt;hello-world name=&quot;hjx&quot;&gt;&lt;/hello-world&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot;&gt;</span><br><span class="line">/*</span><br><span class="line">// 原来的写法</span><br><span class="line">import &#123; Component, Vue &#125; from &apos;vue-property-decorator&apos;;</span><br><span class="line">import HelloWorld from &apos;./components/HelloWorld.vue&apos;;</span><br><span class="line">@Component(&#123;</span><br><span class="line">  components:&#123;</span><br><span class="line">    HelloWorld</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">export default class App extends Vue &#123;</span><br><span class="line">  // 原来的 data里的数据</span><br><span class="line">  msg = 123</span><br><span class="line"></span><br><span class="line">  //原来  method 里的函数</span><br><span class="line">  fn () &#123;</span><br><span class="line">    alert(&apos;hello: &apos; + this.msg)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">// 使用 mixins</span><br><span class="line">import &#123; Component, Vue , Mixins &#125; from &apos;vue-property-decorator&apos;;</span><br><span class="line">import &#123; MyMixin &#125; from &apos;./mixins/mixin-one&apos;;</span><br><span class="line">import HelloWorld from &apos;./components/HelloWorld.vue&apos;;</span><br><span class="line">@Component(&#123;</span><br><span class="line">  components:&#123;</span><br><span class="line">    HelloWorld</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">export default class App extends Mixins(MyMixin) &#123;</span><br><span class="line">  // 原来的 data里的数据</span><br><span class="line">  msg = 123</span><br><span class="line"></span><br><span class="line">  //原来  method 里的函数</span><br><span class="line">  fn () &#123;</span><br><span class="line">    alert(&apos;hello: &apos; + this.msg)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">#app &#123;</span><br><span class="line">  font-family: &apos;Avenir&apos;, Helvetica, Arial, sans-serif;</span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>components/HelloWorld.vue</code></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;hello&quot;&gt;</span><br><span class="line">    我接受到的 props name 为 ：&#123;&#123;name&#125;&#125;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; Component, Prop, Vue &#125; from &apos;vue-property-decorator&apos;;</span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">  props:&#123;</span><br><span class="line">    name:String</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">export default class HelloWorld extends Vue &#123;</span><br><span class="line">  @Prop() private msg!: string;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<h4 id="使用-mixins"><a href="#使用-mixins" class="headerlink" title="使用 mixins"></a>使用 mixins</h4></blockquote>
<blockquote>
<p>src/mixins/mixin-one.ts</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// mixin.js</span><br><span class="line">import Vue from &apos;vue&apos;</span><br><span class="line">import Component from &apos;vue-class-component&apos;</span><br><span class="line"></span><br><span class="line">// You can declare a mixin as the same style as components.</span><br><span class="line">@Component</span><br><span class="line">export class MyMixin extends Vue &#123;</span><br><span class="line">  mixinValue = &apos;111111111111&apos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="TodoList-组件"><a href="#TodoList-组件" class="headerlink" title="TodoList 组件"></a>TodoList 组件</h3><p>参考代码 ts010</p>
<ul>
<li>代码库<a href="https://github.com/slTrust/ts-study" target="_blank" rel="noopener">https://github.com/slTrust/ts-study</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/08/11/TS入门010ts和vue应用/" data-id="ckovg9eu100yv8yjk3tpn2vhw" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/TS入门/">TS入门</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-TS入门009-02Vue-ts配置和webpack" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/08/11/TS入门009-02Vue-ts配置和webpack/" class="article-date">
  <time datetime="2019-08-11T10:33:06.000Z" itemprop="datePublished">2019-08-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/08/11/TS入门009-02Vue-ts配置和webpack/">TS入门009_02Vue_ts配置和webpack</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="去-webpack官网"><a href="#去-webpack官网" class="headerlink" title="去 webpack官网"></a><a href="https://webpack.js.org/" target="_blank" rel="noopener">去 webpack官网</a></h3><ul>
<li><a href="https://webpack.js.org/guides/getting-started/" target="_blank" rel="noopener">get started</a></li>
<li><p>开始抄</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mkdir webpack-demo</span><br><span class="line">cd webpack-demo</span><br><span class="line">npm init -y</span><br><span class="line">npm install webpack@4.22.0 --save-dev</span><br><span class="line">npm install webpack-cli@3.1.2 --save-dev</span><br></pre></td></tr></table></figure>
</li>
<li><p>新建 <code>src/index.js</code></p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">console.log(&apos;hi&apos;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>新建 <code>webpack.config.js</code> 从 官网抄</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">const path = require(&apos;path&apos;);</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">entry: &apos;./src/index.js&apos;,</span><br><span class="line">output: &#123;</span><br><span class="line">    filename: &apos;main.js&apos;,</span><br><span class="line">    path: path.resolve(__dirname, &apos;dist&apos;)</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>npx webpack</code> 意思你要声明 <strong>mode</strong></p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Hash: 8b2187a6e37dccc947c6</span><br><span class="line">Version: webpack 4.39.1</span><br><span class="line">Time: 322ms</span><br><span class="line">Built at: 2019-08-11 18:53:08</span><br><span class="line">Asset       Size  Chunks             Chunk Names</span><br><span class="line">main.js  978 bytes       0  [emitted]  main</span><br><span class="line">Entrypoint main = main.js</span><br><span class="line">[0] ./src/index.js 50 bytes &#123;0&#125; [built]</span><br><span class="line"></span><br><span class="line">WARNING in configuration</span><br><span class="line">The &apos;mode&apos; option has not been set, webpack will fallback to &apos;production&apos; for this value. Set &apos;mode&apos; option to &apos;development&apos; or &apos;production&apos; to enable defaults for each environment.</span><br><span class="line">You can also set it to &apos;none&apos; to disable any default behavior. Learn more: https://webpack.js.org/configuration/mode/</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加 mode</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">...</span><br><span class="line">mode:&quot;development&quot;,</span><br><span class="line">...</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>再次运行 npx webpack 此时没警告了</p>
</li>
<li><p>我们需要两个配置，一个是 dev 一个是 prod</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// 新建 webpack.prod.js 内容和 webpack.config.js 区别就是 mode 不一样</span><br><span class="line">const path = require(&apos;path&apos;);</span><br><span class="line">module.exports = &#123;</span><br><span class="line">entry: &apos;./src/index.js&apos;,</span><br><span class="line">mode:&quot;production&quot;,</span><br><span class="line">output: &#123;</span><br><span class="line">    filename: &apos;main.js&apos;,</span><br><span class="line">    path: path.resolve(__dirname, &apos;dist&apos;)</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>需改 package.json</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;build:dev&quot;: &quot;webpack&quot;,</span><br><span class="line">    &quot;build&quot;: &quot;webpack --config webpack.prod.js&quot;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// npm run build:dev 就是编译 不压缩</span><br><span class="line">// npm run build 就是编译 压缩</span><br></pre></td></tr></table></figure>
</li>
<li><p>搞出一个页面来显示,那么就需要 <a href="https://github.com/webpack/webpack-dev-server" target="_blank" rel="noopener">webpack-dev-server</a></p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install webpack-dev-server@3.1.9 --save-dev</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>npx webpack-dev-server</code> 还无法显示 因为你需要 <a href="https://github.com/jantimon/html-webpack-plugin" target="_blank" rel="noopener">webpack html plugin</a></p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i --save-dev html-webpack-plugin@3.2.0</span><br></pre></td></tr></table></figure>
</li>
<li><p>如何使用 <code>html-webpack-plugin</code> 看 usage 然后抄</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">const HtmlWebpackPlugin = require(&apos;html-webpack-plugin&apos;)</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">entry: &apos;index.js&apos;,</span><br><span class="line">output: &#123;</span><br><span class="line">    path: __dirname + &apos;/dist&apos;,</span><br><span class="line">    filename: &apos;index_bundle.js&apos;</span><br><span class="line">&#125;,</span><br><span class="line">plugins: [</span><br><span class="line">    new HtmlWebpackPlugin()</span><br><span class="line">]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>webpack.config.js</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">const path = require(&apos;path&apos;);</span><br><span class="line">const HtmlWebpackPlugin = require(&apos;html-webpack-plugin&apos;)</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">entry: &apos;./src/index.js&apos;,</span><br><span class="line">mode:&quot;development&quot;,</span><br><span class="line">output: &#123;</span><br><span class="line">    filename: &apos;main.js&apos;,</span><br><span class="line">    path: path.resolve(__dirname, &apos;dist&apos;)</span><br><span class="line">&#125;,</span><br><span class="line">plugins: [</span><br><span class="line">    new HtmlWebpackPlugin()</span><br><span class="line">]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改 index.js</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">console.log(&quot;Hello World from index main file!&quot;);</span><br><span class="line">let div = document.createElement(&apos;div&apos;);</span><br><span class="line">div.id = &apos;app&apos;;</span><br><span class="line">div.textContent = &quot;hjx webpack&quot;;</span><br><span class="line"></span><br><span class="line">document.body.appendChild(div);</span><br></pre></td></tr></table></figure>
</li>
<li><p>运行 <code>npx webpack-dev-server</code></p>
</li>
</ul>
<h3 id="使用Vue"><a href="#使用Vue" class="headerlink" title="使用Vue"></a>使用Vue</h3><ul>
<li><p>src/Hjx.vue</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;div&gt;I am Hjx,&#123;&#123;msg&#125;&#125;&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">    name:&apos;hjx&apos;,</span><br><span class="line">    data()&#123;</span><br><span class="line">        return &#123;</span><br><span class="line">            msg:&apos;你好！&apos;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装 <code>vue</code> 运行 <code>npm i vue@2.5.17</code></p>
</li>
<li><p>安装 <a href="https://vue-loader.vuejs.org/zh/" target="_blank" rel="noopener">vue loader</a></p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -D vue-loader@15.4.2 vue-template-compiler@2.5.17</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改 webpack.config.js</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">const path = require(&apos;path&apos;);</span><br><span class="line">const HtmlWebpackPlugin = require(&apos;html-webpack-plugin&apos;)</span><br><span class="line">const VueLoaderPlugin = require(&apos;vue-loader/lib/plugin&apos;)</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">entry: &apos;./src/index.js&apos;,</span><br><span class="line">mode:&quot;development&quot;,</span><br><span class="line">output: &#123;</span><br><span class="line">    filename: &apos;main.js&apos;,</span><br><span class="line">    path: path.resolve(__dirname, &apos;dist&apos;)</span><br><span class="line">&#125;,</span><br><span class="line">module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">    &#123;</span><br><span class="line">        test: /\.vue$/,</span><br><span class="line">        loader: &apos;vue-loader&apos;</span><br><span class="line">    &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;,</span><br><span class="line">plugins: [</span><br><span class="line">    new HtmlWebpackPlugin(),</span><br><span class="line">    new VueLoaderPlugin()</span><br><span class="line">]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>npx webpack-dev-server</code> 终于成功了</p>
</li>
</ul>
<h3 id="配置ts"><a href="#配置ts" class="headerlink" title="配置ts"></a>配置ts</h3><p>但是不知道怎么配置，借助 google</p>
<blockquote>
<p>搜 typescript loader</p>
</blockquote>
<p>得到两个答案，只能挨个试</p>
<ul>
<li><a href="https://github.com/TypeStrong/ts-loader" target="_blank" rel="noopener">ts-loader</a></li>
<li><a href="https://github.com/s-panferov/awesome-typescript-loader" target="_blank" rel="noopener">awesome-typescript-loader</a></li>
</ul>
<blockquote>
<p>ts-loader</p>
</blockquote>
<ul>
<li><code>npm install ts-loader@5.2.2 -D</code></li>
<li><code>npm install typescript --save-dev3.1.3 -D</code></li>
<li><p>修改 webpack.config.js</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">const path = require(&apos;path&apos;);</span><br><span class="line">const HtmlWebpackPlugin = require(&apos;html-webpack-plugin&apos;)</span><br><span class="line">const VueLoaderPlugin = require(&apos;vue-loader/lib/plugin&apos;)</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">entry: &apos;./src/index.js&apos;,</span><br><span class="line">mode:&quot;development&quot;,</span><br><span class="line">output: &#123;</span><br><span class="line">    filename: &apos;main.js&apos;,</span><br><span class="line">    path: path.resolve(__dirname, &apos;dist&apos;)</span><br><span class="line">&#125;,</span><br><span class="line">// 默认允许加载ts / tsx 结尾的东西</span><br><span class="line">resolve: &#123;</span><br><span class="line">    // </span><br><span class="line">    extensions: [&quot;.ts&quot;, &quot;.tsx&quot;, &quot;.js&quot;]</span><br><span class="line">&#125;,</span><br><span class="line">module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">    &#123;</span><br><span class="line">        test: /\.vue$/,</span><br><span class="line">        loader: &apos;vue-loader&apos;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123; test: /\.tsx?$/, loader: &quot;ts-loader&quot; &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;,</span><br><span class="line">plugins: [</span><br><span class="line">    new HtmlWebpackPlugin(),</span><br><span class="line">    new VueLoaderPlugin()</span><br><span class="line">]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>新建 tsconfig.json</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">&quot;compilerOptions&quot;: &#123;</span><br><span class="line">    &quot;sourceMap&quot;: true</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>新建 src/test.ts</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">const a: number = 1;</span><br><span class="line">export const b = a;</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改 src/index.js</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import &#123;b&#125; from &apos;./test.ts&apos;;</span><br><span class="line">console.log(b);</span><br></pre></td></tr></table></figure>
</li>
<li><p>再次运行 <code>npx webpack-dev-server</code> 成功了，此时我们的配置 <strong>既支持vue又支持 ts</strong></p>
</li>
</ul>
<blockquote>
<h4 id="修改我们的入口文件-index-js-为-index-ts"><a href="#修改我们的入口文件-index-js-为-index-ts" class="headerlink" title="修改我们的入口文件 index.js 为 index.ts"></a>修改我们的入口文件 index.js 为 index.ts</h4></blockquote>
<ul>
<li>webpack.config.js 里的入口修改</li>
<li><p>此时运行<code>npx webpack-dev-server</code>报错了</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Cannot find module &apos;./Hjx.vue&apos;.</span><br><span class="line">// 没改之前可以，改了反而不行了。</span><br><span class="line"></span><br><span class="line">// 有没有可能是 ts 找不到，一定是配置有问题</span><br><span class="line"></span><br><span class="line">// 参考上篇的vue-cli 生成的 ts配置</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改 tsconfig.js ,然后运行 <code>npx webpack-dev-server</code> 还是报那个错</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;compilerOptions&quot;: &#123;</span><br><span class="line">    &quot;sourceMap&quot;: true,</span><br><span class="line">    &quot;baseUrl&quot;: &quot;.&quot;,</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;include&quot;: [</span><br><span class="line">        &quot;src/**/*.ts&quot;,</span><br><span class="line">        &quot;src/**/*.tsx&quot;,</span><br><span class="line">        &quot;src/**/*.vue&quot;,</span><br><span class="line">        &quot;tests/**/*.ts&quot;,</span><br><span class="line">        &quot;tests/**/*.tsx&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;exclude&quot;: [</span><br><span class="line">        &quot;node_modules&quot;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>只能借助 google 了 <a href="https://github.com/vuejs/vue/issues/5298" target="_blank" rel="noopener">typescript cannot find module vue</a></p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// 大概意思就是 没有声明文件</span><br><span class="line">// 继续参考vue-cli 生成的声明文件</span><br><span class="line">This is because you don&apos;t have declarations of .vue files, then the typescript compiler cannot load them. You need to declare general declaration of .vue file in your project or generating each .vue file declaration by using vuetype</span><br></pre></td></tr></table></figure>
</li>
<li><p>新建 <code>shims-vue.d.ts</code></p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">declare module &apos;*.vue&apos; &#123;</span><br><span class="line">    import Vue from &apos;vue&apos;</span><br><span class="line">    export default Vue</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>运行 <code>npx webpack-dev-server</code> 此时 我们就可以脱离js了</p>
</li>
</ul>
<h4 id="在vue组件里使用-ts"><a href="#在vue组件里使用-ts" class="headerlink" title="在vue组件里使用 ts"></a>在vue组件里使用 ts</h4><ul>
<li><a href="https://github.com/vuejs/vue-loader/issues/109" target="_blank" rel="noopener">vue loader typescript</a>   </li>
<li><p>找到一个 <strong>riku179</strong> 的答案</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">        &#123;</span><br><span class="line">            test: /\.js/,</span><br><span class="line">            exclude: /node_modules/,</span><br><span class="line">            loader: &apos;babel-loader&apos;,</span><br><span class="line">            options: &#123;</span><br><span class="line">                // presets: [&apos;es2015&apos;, &#123; modules: false &#125;] &lt;- fail</span><br><span class="line">                presets: [&apos;es2015&apos;]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            test: /\.ts$/,</span><br><span class="line">            exclude: /node_modules|vue\/src/,</span><br><span class="line">            use: [</span><br><span class="line">                &#123;</span><br><span class="line">                    loader: &apos;ts-loader&apos;,</span><br><span class="line">                    options: &#123;</span><br><span class="line">                        appendTsSuffixTo: [/\.vue$/]</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            test: /\.vue$/,</span><br><span class="line">            loader: &apos;vue-loader&apos;,</span><br><span class="line">            options: &#123;</span><br><span class="line">                esModule: true,</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改我们的 webpack.config.js</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">        &#123;</span><br><span class="line">            test: /\.vue$/,</span><br><span class="line">            loader: &apos;vue-loader&apos;,</span><br><span class="line">            options: &#123;</span><br><span class="line">                esModule: true,</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            test: /\.tsx?$/, loader: &quot;ts-loader&quot;,</span><br><span class="line">            options: &#123;</span><br><span class="line">                appendTsSuffixTo: [/\.vue$/]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>src/Hjx.vue</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;div&gt;</span><br><span class="line">    &#123;&#123;number&#125;&#125;</span><br><span class="line">    &lt;button @click=&quot;add&quot;&gt;+&lt;/button&gt;  </span><br><span class="line">    &lt;button @click=&quot;minus&quot;&gt;-&lt;/button&gt;  </span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot;&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">    name:&apos;hjx&apos;,</span><br><span class="line">    data()&#123;</span><br><span class="line">        return &#123;</span><br><span class="line">            number:0,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods:&#123;</span><br><span class="line">        add()&#123;</span><br><span class="line">            let number:number = this.number + 1;</span><br><span class="line">            this.number = number;</span><br><span class="line">        &#125;,</span><br><span class="line">        minus()&#123;</span><br><span class="line">            let number:number = this.number - 1;</span><br><span class="line">            this.number = number;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>成功～</p>
</li>
</ul>
<h4 id="所有都是通过-google-没有任何书和文档说明这些，所以只能通过细节一个一个推敲"><a href="#所有都是通过-google-没有任何书和文档说明这些，所以只能通过细节一个一个推敲" class="headerlink" title="所有都是通过 google 没有任何书和文档说明这些，所以只能通过细节一个一个推敲"></a>所有都是通过 google 没有任何书和文档说明这些，所以只能通过细节一个一个推敲</h4><h4 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h4><ul>
<li>代码库<a href="https://github.com/slTrust/ts-study" target="_blank" rel="noopener">https://github.com/slTrust/ts-study</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/08/11/TS入门009-02Vue-ts配置和webpack/" data-id="ckovg9eu000yr8yjkgab8u1f1" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/TS入门/">TS入门</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-TS入门009_01Vue_ts配置cli版本" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/08/11/TS入门009_01Vue_ts配置cli版本/" class="article-date">
  <time datetime="2019-08-11T09:11:52.000Z" itemprop="datePublished">2019-08-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/08/11/TS入门009_01Vue_ts配置cli版本/">TS入门009_01Vue_ts配置cli版本</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="直接上官网"><a href="#直接上官网" class="headerlink" title="直接上官网"></a>直接上官网</h3><ul>
<li><a href="https://vuejs.org/" target="_blank" rel="noopener">https://vuejs.org/</a></li>
<li><p>找到 TS 支持,我的是 3.0版本</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"># 1. Install Vue CLI, if it&apos;s not already installed</span><br><span class="line">npm install --global @vue/cli</span><br><span class="line"></span><br><span class="line"># 2. Create a new project, then choose the &quot;Manually select features&quot; option</span><br><span class="line">vue create my-project-name</span><br><span class="line"></span><br><span class="line"># 提示你是否在当前目录生成 y</span><br><span class="line">Vue CLI v3.0.0</span><br><span class="line">? Generate project in current directory? (Y/n) </span><br><span class="line">#  是否选择预置的？ 选 Manually</span><br><span class="line">Vue CLI v3.0.0</span><br><span class="line">? Please pick a preset: (Use arrow keys)</span><br><span class="line">❯ default (babel, eslint) </span><br><span class="line">Manually select features </span><br><span class="line"></span><br><span class="line"># 选择你要的内容 router / vuex  做项目可以选上，这里必须的是 ts / babel </span><br><span class="line">? Check the features needed for your project: </span><br><span class="line">◉ Babel</span><br><span class="line">◉ TypeScript</span><br><span class="line">◯ Progressive Web App (PWA) Support</span><br><span class="line">◯ Router</span><br><span class="line">◯ Vuex</span><br><span class="line">❯◉ CSS Pre-processors</span><br><span class="line">◉ Linter / Formatter</span><br><span class="line">◯ Unit Testing</span><br><span class="line">◯ E2E Testing</span><br><span class="line"></span><br><span class="line">? Use class-style component syntax? Yes</span><br><span class="line">? Use Babel alongside TypeScript for auto-detected polyfills? Yes</span><br><span class="line">? Pick a CSS pre-processor (PostCSS, Autoprefixer and CSS Modules are supported </span><br><span class="line">by default): SCSS/SASS</span><br><span class="line">? Where do you prefer placing config for Babel, PostCSS, ESLint, etc.? In dedica</span><br><span class="line">ted config files</span><br><span class="line"># 是否以后都用这个当作默认配置</span><br><span class="line">? Save this as a preset for future projects? (y/N) n</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建好项目 yarn serve</p>
</li>
</ul>
<blockquote>
<p>来看 app.vue</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;img alt=&quot;Vue logo&quot; src=&quot;./assets/logo.png&quot;&gt;</span><br><span class="line">    &lt;HelloWorld msg=&quot;Welcome to Your Vue.js + TypeScript App&quot;/&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot;&gt;</span><br><span class="line">// 这是 js 语法</span><br><span class="line">import &#123; Component, Vue &#125; from &apos;vue-property-decorator&apos;;</span><br><span class="line">// 这是 js 语法</span><br><span class="line">import HelloWorld from &apos;./components/HelloWorld.vue&apos;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// 这里是新的组件写法 装饰器语法</span><br><span class="line">@Component(&#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    HelloWorld,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line">export default class App extends Vue &#123;&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">...</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>新建我们的组件 Hjx</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        I am hjx!</span><br><span class="line">        &lt;HelloWorld msg=&quot;Welcome to Your Vue.js + TypeScript App&quot;/&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script lang=&quot;ts&quot;&gt;</span><br><span class="line">import Vue from &apos;vue&apos;</span><br><span class="line">import Component from &apos;vue-class-component&apos;;</span><br><span class="line">import HelloWorld from &apos;./HelloWorld.vue&apos;;</span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">components: &#123;</span><br><span class="line">    HelloWorld</span><br><span class="line">&#125;,</span><br><span class="line">&#125;)</span><br><span class="line">export default class Hjx extends Vue&#123;&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>App.vue 里 使用 它</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;img alt=&quot;Vue logo&quot; src=&quot;./assets/logo.png&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;Hjx/&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; Component, Vue &#125; from &apos;vue-property-decorator&apos;;</span><br><span class="line">import Hjx from &apos;./components/Hjx.vue&apos;;</span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">components: &#123;</span><br><span class="line">    Hjx</span><br><span class="line">&#125;,</span><br><span class="line">&#125;)</span><br><span class="line">export default class App extends Vue &#123;&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">#app &#123;</span><br><span class="line">font-family: &apos;Avenir&apos;, Helvetica, Arial, sans-serif;</span><br><span class="line">-webkit-font-smoothing: antialiased;</span><br><span class="line">-moz-osx-font-smoothing: grayscale;</span><br><span class="line">text-align: center;</span><br><span class="line">color: #2c3e50;</span><br><span class="line">margin-top: 60px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h4><ul>
<li>代码库<a href="https://github.com/slTrust/ts-study" target="_blank" rel="noopener">https://github.com/slTrust/ts-study</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/08/11/TS入门009_01Vue_ts配置cli版本/" data-id="ckovg9ety00yn8yjk07ht4ou4" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/TS入门/">TS入门</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-ZB-022-01超详细网址输入url过程" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/07/29/ZB-022-01超详细网址输入url过程/" class="article-date">
  <time datetime="2019-07-29T12:27:13.000Z" itemprop="datePublished">2019-07-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/29/ZB-022-01超详细网址输入url过程/">ZB-022-01超详细网址输入url过程</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="浏览器输入url过程"><a href="#浏览器输入url过程" class="headerlink" title="浏览器输入url过程"></a>浏览器输入url过程</h3><ol>
<li>当你打开一个网页的时候，这个世界上一定有一个<strong>地方</strong>处理这个请求，这个页面不可能凭空掉下来。</li>
<li>这个地方在那里呢？</li>
</ol>
<p>这就不可避免的说：<strong>计算机网络的基础架构</strong>。</p>
<h4 id="计算机网络的基础架构"><a href="#计算机网络的基础架构" class="headerlink" title="计算机网络的基础架构"></a>计算机网络的基础架构</h4><p>在互联网上有很多很多的计算机，假设它们之间用网线连接起来。</p>
<p>通过运营商 联通/电信 连接到你家的小区里，然后在小区里跟你家里牵根线。此时你躺在床上拿着手机。</p>
<p>你的手机通过无线路由器，和这个网络相连的。</p>
<blockquote>
<h4 id="一个概念"><a href="#一个概念" class="headerlink" title="一个概念"></a>一个概念</h4></blockquote>
<p>在计算机世界里有很多很多的电脑，这个电脑就叫<strong>主机 HOST </strong>，和你的笔记本没什么区别。把你的笔记本放机房里也可以充当一台主机。</p>
<p>因此,<strong>这个世界上有很多很多相连的计算机，我们称之为主机</strong></p>
<blockquote>
<h4 id="每个主机有一个IP地址。"><a href="#每个主机有一个IP地址。" class="headerlink" title="每个主机有一个IP地址。"></a>每个主机有一个IP地址。</h4></blockquote>
<p>在IPV4的世界里，IP地址是 32位地址(4个字节),形如 192.118.112.3，IP地址就是网络上计算机的地址</p>
<p>这个地址可以唯一的定位一台计算机就是<strong>主机</strong>。 </p>
<blockquote>
<p>1个byte -128~127, 而无符号的byte最大值刚好是 255。</p>
</blockquote>
<p>因此<strong>IP地址最大不超过255</strong></p>
<blockquote>
<p>32位可以存多少数字呢？</p>
</blockquote>
<p>42亿个数字，也就是说这个世界上最多有42亿IPV4的IP地址，但是发展到现在 发现42亿的IP地址果然不够用。于是有了<strong>IPV6</strong></p>
<h4 id="但是，无论访问什么网站，我们都不会用IP地址"><a href="#但是，无论访问什么网站，我们都不会用IP地址" class="headerlink" title="但是，无论访问什么网站，我们都不会用IP地址"></a>但是，无论访问什么网站，我们都不会用IP地址</h4><p>因为IP地址难记啊！</p>
<p>如果不难，请问 百度/淘宝 的IP地址是什么？</p>
<h4 id="有一天你躺在床上在QQ上和妹子聊天"><a href="#有一天你躺在床上在QQ上和妹子聊天" class="headerlink" title="有一天你躺在床上在QQ上和妹子聊天"></a>有一天你躺在床上在QQ上和妹子聊天</h4><ul>
<li>你的手机必须知道和这个世界上一台主机(HOST)在通信,所以你必须知道这个主机的IP地址，但是IP地址很难记。</li>
</ul>
<blockquote>
<p>我们需要另一种服务<strong>DNS</strong></p>
</blockquote>
<h4 id="DNS-Domain-Name-Service-域名服务"><a href="#DNS-Domain-Name-Service-域名服务" class="headerlink" title="DNS Domain Name Service 域名服务"></a>DNS Domain Name Service 域名服务</h4><p>当你网址输入 <a href="http://www.taobao.com的时候，" target="_blank" rel="noopener">www.taobao.com的时候，</a></p>
<ol>
<li>如果计算机不知道淘宝的主页在哪里，它就会向 DNS 请求查询 taobao.com</li>
<li>dns会返回一个IP地址给你</li>
<li>此时通过这个地址你就可以访问淘宝了</li>
</ol>
<h4 id="本地HOST"><a href="#本地HOST" class="headerlink" title="本地HOST"></a>本地HOST</h4><p>如果你本地保存有 一个淘宝的映射，那么请求taobao.com的时候，就不会去查找DNS了</p>
<p>mac的host文件在 /etc/hosts,当你做如下修改的时候。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1   www.taobao.com</span><br></pre></td></tr></table></figure>
<p>你再次访问 taobao.com 时，会直接到 127.0.0.1 </p>
<h4 id="端口"><a href="#端口" class="headerlink" title="端口"></a>端口</h4><p>一台机子有很多的端口最多有65536个端口，如 mysql 3306。</p>
<p>在网线上传输的数据，每一个数据的数据包里面都指定了一个端口，指名和对应的端口通信。</p>
<blockquote>
<h4 id="HTTPS协议的默认端口是-443"><a href="#HTTPS协议的默认端口是-443" class="headerlink" title="HTTPS协议的默认端口是 443"></a>HTTPS协议的默认端口是 443</h4></blockquote>
<blockquote>
<h4 id="HTTP协议的默认端口是-80"><a href="#HTTP协议的默认端口是-80" class="headerlink" title="HTTP协议的默认端口是 80"></a>HTTP协议的默认端口是 80</h4></blockquote>
<p>意思就是 你输入 <a href="http://www.taobao.com" target="_blank" rel="noopener">http://www.taobao.com</a> 和 <a href="http://www.taobao.com:80" target="_blank" rel="noopener">http://www.taobao.com:80</a> 没区别</p>
<p>相似的 你输入 <a href="https://www.taobao.com" target="_blank" rel="noopener">https://www.taobao.com</a> 和 <a href="https://www.taobao.com:443" target="_blank" rel="noopener">https://www.taobao.com:443</a> 没区别</p>
<blockquote>
<h4 id="端口指定了你通信的主机的归属地"><a href="#端口指定了你通信的主机的归属地" class="headerlink" title="端口指定了你通信的主机的归属地"></a>端口指定了你通信的主机的归属地</h4></blockquote>
<h4 id="更进一步，为什么输入网址后能看到绚丽多彩的页面呢？"><a href="#更进一步，为什么输入网址后能看到绚丽多彩的页面呢？" class="headerlink" title="更进一步，为什么输入网址后能看到绚丽多彩的页面呢？"></a>更进一步，为什么输入网址后能看到绚丽多彩的页面呢？</h4><p>最基本的通信协议有两种</p>
<ul>
<li>TCP 传输控制协议</li>
<li>UDP 用户数据包协议(http协议里一般不用，不再详述)</li>
</ul>
<p>TCP 可以想像成一条双向的高速公路,公路上跑的是数据</p>
<p>TCP 是基于 <strong>Stream 流</strong>的协议</p>
<p>TCP 是一个 全双工协议 ，比如 打电话，双方都可以同时说话。</p>
<p>半双工协议——对讲机。每个时刻只有一个对讲机说话。</p>
<blockquote>
<h4 id="TCP的本质就是"><a href="#TCP的本质就是" class="headerlink" title="TCP的本质就是"></a>TCP的本质就是</h4></blockquote>
<p><strong>定义了字节流在网络上如何发送和接收</strong></p>
<h4 id="在TCP之上的协议——HTTP-HyperText-Transfer-Protocol"><a href="#在TCP之上的协议——HTTP-HyperText-Transfer-Protocol" class="headerlink" title="在TCP之上的协议——HTTP HyperText Transfer Protocol"></a>在TCP之上的协议——<a href="https://zh.wikipedia.org/wiki/%E8%B6%85%E6%96%87%E6%9C%AC%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE" target="_blank" rel="noopener">HTTP HyperText Transfer Protocol</a></h4><p><strong>HTTP就是丰富网络世界的基石，它定义了文本之外的东西如何被传输。</strong></p>
<ul>
<li>request</li>
<li>response</li>
</ul>
<h4 id="一个网址如何变成美轮美奂的页面呢？"><a href="#一个网址如何变成美轮美奂的页面呢？" class="headerlink" title="一个网址如何变成美轮美奂的页面呢？"></a>一个网址如何变成美轮美奂的页面呢？</h4><blockquote>
<p>浏览器是如何工作的</p>
</blockquote>
<p>当你访问 <a href="http://www.taobao.com" target="_blank" rel="noopener">www.taobao.com</a> 时候，响应给你如下内容，但是页面却显示的是美轮美奂的页面</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;zh-CN&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=&quot;utf-8&quot; /&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge,chrome=1&quot; /&gt;</span><br><span class="line">&lt;meta name=&quot;renderer&quot; content=&quot;webkit&quot; /&gt;</span><br><span class="line">&lt;title&gt;淘宝网 - 淘！我喜欢&lt;/title&gt;</span><br><span class="line">&lt;meta name=&quot;spm-id&quot; content=&quot;a21bo&quot; /&gt;</span><br><span class="line">&lt;meta name=&quot;description&quot; content=&quot;淘宝网 - 亚洲较大的网上交易平台，提供各类服饰、美容、家居、数码、话费/点卡充值… 数亿优质商品，同时提供担保交易(先收货后付款)等安全交易保障服务，并由商家提供退货承诺、破损补寄等消费者保障服务，让你安心享受网上购物乐趣！&quot; /&gt;</span><br><span class="line">&lt;meta name=&quot;aplus-xplug&quot; content=&quot;NONE&quot;&gt;</span><br><span class="line">&lt;meta name=&quot;keyword&quot; content=&quot;淘宝,掏宝,网上购物,C2C,在线交易,交易市场,网上交易,交易市场,网上买,网上卖,购物网站,团购,网上贸易,安全购物,电子商务,放心买,供应,买卖信息,网店,一口价,拍卖,网上开店,网络购物,打折,免费开店,网购,频道,店铺&quot; /&gt;</span><br><span class="line">&lt;link rel=&quot;dns-prefetch&quot; href=&quot;//ald.taobao.com&quot; /&gt;</span><br><span class="line">&lt;link rel=&quot;dns-prefetch&quot; href=&quot;//gw.alicdn.com&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;div&gt;</span><br><span class="line">。。。</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>当浏览器看到一个标签<code>&lt;html lang=&quot;zh-CN&quot;&gt;</code>的时候，就知道这是一个文档树，它会把它解析成一颗HTML树，然后决定它如何被显示。</p>
<blockquote>
<h4 id="HTML-规定了很多东西"><a href="#HTML-规定了很多东西" class="headerlink" title="HTML 规定了很多东西"></a>HTML 规定了很多东西</h4></blockquote>
<ul>
<li>如 link 是一个 css</li>
<li>如 script 是一段 js</li>
</ul>
<p>当浏览器遇到如上内容的时候，浏览器就开始解析它，每当看到一个 link 就知道要去下载这个 css ,CSS规定了页面如何渲染，比如两个按钮之间的间距，背景色。</p>
<p>当这个 link 解析完成之后，就去解析下一个标签。</p>
<p>当浏览器看到 <code>script</code>的时候，它就知道自己要执行一段js代码。</p>
<p>当浏览器看到 <code>img</code>的时候，它就知道去把这个图片下载下来然后把它放在页面的某个位置上去。这就是为什么你访问 <a href="http://www.taobao.com" target="_blank" rel="noopener">www.taobao.com</a> 的时候，会发送许多许多你不知道的请求。</p>
<p>因为解析 如上 文档树的时候，发现里面还有许多许多东西需要加载，于是它就循环往复这个过程<strong>发起一个请求，拿到响应，直到把所有的事情都做完</strong></p>
<blockquote>
<h4 id="一个问题，是整个HTML下载完毕就去解析，还是来一点响应就解析一点"><a href="#一个问题，是整个HTML下载完毕就去解析，还是来一点响应就解析一点" class="headerlink" title="一个问题，是整个HTML下载完毕就去解析，还是来一点响应就解析一点"></a>一个问题，是整个HTML下载完毕就去解析，还是来一点响应就解析一点</h4></blockquote>
<ul>
<li>答案是 <strong>来一点解析一点</strong></li>
</ul>
<h4 id="同步加载和异步加载"><a href="#同步加载和异步加载" class="headerlink" title="同步加载和异步加载"></a>同步加载和异步加载</h4><ul>
<li>浏览器一次返回所有的数据</li>
<li>浏览器返回部分数据，使用 ajax 异步加载</li>
</ul>
<h4 id="只要浏览器能做到的，其他代码一定能做到"><a href="#只要浏览器能做到的，其他代码一定能做到" class="headerlink" title="只要浏览器能做到的，其他代码一定能做到"></a>只要浏览器能做到的，其他代码一定能做到</h4>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/07/29/ZB-022-01超详细网址输入url过程/" data-id="ckovg9ev501188yjkj4ypp7l7" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/oak/">oak</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-ReactWheels07-03Hooks全解4" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/07/25/ReactWheels07-03Hooks全解4/" class="article-date">
  <time datetime="2019-07-25T01:34:01.000Z" itemprop="datePublished">2019-07-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/25/ReactWheels07-03Hooks全解4/">ReactWheels07-03Hooks全解4</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="代码仓库"><a href="#代码仓库" class="headerlink" title="代码仓库"></a><a href="https://github.com/slTrust/react-hooks-demo" target="_blank" rel="noopener">代码仓库</a></h1><h3 id="自定义Hooks"><a href="#自定义Hooks" class="headerlink" title="自定义Hooks"></a>自定义Hooks</h3><p>useList.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">import &#123; useState, useEffect &#125; from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">const useList = () =&gt; &#123;</span><br><span class="line">  const [list, setList] = useState(null);</span><br><span class="line">  useEffect(() =&gt; &#123;</span><br><span class="line">    ajax(&quot;/list&quot;).then(list =&gt; &#123;</span><br><span class="line">      setList(list);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;, []); // [] 确保只在第一次运行</span><br><span class="line">  return &#123;</span><br><span class="line">    list: list,</span><br><span class="line">    addItem: name =&gt; &#123;</span><br><span class="line">      setList([...list, &#123; id: Math.random(), name: name &#125;]);</span><br><span class="line">    &#125;,</span><br><span class="line">    deleteIndex: index =&gt; &#123;</span><br><span class="line">      setList(list.slice(0, index).concat(list.slice(index + 1)));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line">export default useList;</span><br><span class="line"></span><br><span class="line">function ajax() &#123;</span><br><span class="line">  return new Promise((resolve, reject) =&gt; &#123;</span><br><span class="line">    setTimeout(() =&gt; &#123;</span><br><span class="line">      resolve([</span><br><span class="line">        &#123; id: &quot;1&quot;, name: &quot;Frank&quot; &#125;,</span><br><span class="line">        &#123; id: &quot;2&quot;, name: &quot;Jack&quot; &#125;,</span><br><span class="line">        &#123; id: &quot;3&quot;, name: &quot;Alice&quot; &#125;,</span><br><span class="line">        &#123; id: &quot;4&quot;, name: &quot;Bob&quot; &#125;</span><br><span class="line">      ]);</span><br><span class="line">    &#125;, 2000);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>HooksDemo.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">import React from &apos;react&apos;;</span><br><span class="line">import useList from &quot;../hooks/useList&quot;;</span><br><span class="line"></span><br><span class="line">function HooksDemo() &#123;</span><br><span class="line">  const &#123; list, deleteIndex &#125; = useList();</span><br><span class="line">  return (</span><br><span class="line">    &lt;div className=&quot;App&quot;&gt;</span><br><span class="line">      &lt;h1&gt;List&lt;/h1&gt;</span><br><span class="line">      &#123;list ? (</span><br><span class="line">        &lt;ol&gt;</span><br><span class="line">          &#123;list.map((item, index) =&gt; (</span><br><span class="line">            &lt;li key=&#123;item.id&#125;&gt;</span><br><span class="line">              &#123;item.name&#125;</span><br><span class="line">              &lt;button</span><br><span class="line">                onClick=&#123;() =&gt; &#123;</span><br><span class="line">                  deleteIndex(index);</span><br><span class="line">                &#125;&#125;</span><br><span class="line">              &gt;</span><br><span class="line">                x</span><br><span class="line">              &lt;/button&gt;</span><br><span class="line">            &lt;/li&gt;</span><br><span class="line">          ))&#125;</span><br><span class="line">        &lt;/ol&gt;</span><br><span class="line">      ) : (</span><br><span class="line">          &quot;加载中...&quot;</span><br><span class="line">        )&#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default HooksDemo;</span><br></pre></td></tr></table></figure>
<h3 id="Stale-Closure"><a href="#Stale-Closure" class="headerlink" title="Stale Closure"></a>Stale Closure</h3><ul>
<li><a href="https://dmitripavlutin.com/react-hooks-stale-closures/" target="_blank" rel="noopener">过时闭包</a></li>
<li>只要你不觉得头疼！</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/07/25/ReactWheels07-03Hooks全解4/" data-id="ckovg9eq700od8yjkczq6fzpf" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ReactWheels/">ReactWheels</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-ReactWheels07-03Hooks全解3" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/07/25/ReactWheels07-03Hooks全解3/" class="article-date">
  <time datetime="2019-07-25T00:34:01.000Z" itemprop="datePublished">2019-07-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/25/ReactWheels07-03Hooks全解3/">ReactWheels07-03Hooks全解3</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="代码仓库"><a href="#代码仓库" class="headerlink" title="代码仓库"></a><a href="https://github.com/slTrust/react-hooks-demo" target="_blank" rel="noopener">代码仓库</a></h1><h3 id="Memo"><a href="#Memo" class="headerlink" title="Memo"></a>Memo</h3><ul>
<li>React.Memo</li>
<li>Child3 可以用 React.Memo(Child)代替</li>
<li>如果props不变，就不会再次执行一个函数组件</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; useState &#125; from &apos;react&apos;;</span><br><span class="line">function UseMemoDemo1() &#123;</span><br><span class="line">  const [n, setN] = useState(0)</span><br><span class="line">  const [m, setM] = useState(0)</span><br><span class="line">  const onChangeN = () =&gt; &#123;</span><br><span class="line">    setN(i =&gt; i + 1)</span><br><span class="line">  &#125;</span><br><span class="line">  const onChangeM = () =&gt; &#123;</span><br><span class="line">    setM(i =&gt; i + 1)</span><br><span class="line">  &#125;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      没有缓存，Child组件 依赖的是m，点击按钮更新的是n,也会触发 Child从新执行</span><br><span class="line">      &lt;br /&gt;</span><br><span class="line">      n:&#123;n&#125;,</span><br><span class="line">      &lt;br /&gt;</span><br><span class="line">      m:&#123;m&#125;</span><br><span class="line">      &lt;br /&gt;</span><br><span class="line">      &lt;button onClick=&#123;onChangeN&#125;&gt;onChangeN&lt;/button&gt;</span><br><span class="line">      &lt;br /&gt;</span><br><span class="line">      &lt;button onClick=&#123;onChangeM&#125;&gt;onChangeM&lt;/button&gt;</span><br><span class="line">      &lt;Child data=&#123;m&#125; /&gt;</span><br><span class="line">      &lt;Child3 data=&#123;m&#125; /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function Child(props) &#123;</span><br><span class="line">  console.log(&apos;Child执行了&apos;)</span><br><span class="line">  console.log(&apos;Child内大量逻辑1&apos;)</span><br><span class="line">  console.log(&apos;Child内大量逻辑2&apos;)</span><br><span class="line">  console.log(&apos;Child内大量逻辑3&apos;)</span><br><span class="line">  return (&lt;div&gt;child:&#123;props.data&#125;&lt;/div&gt;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function Child2(props) &#123;</span><br><span class="line">  console.log(&apos;Child2执行了&apos;)</span><br><span class="line">  console.log(&apos;Child2内大量逻辑1&apos;)</span><br><span class="line">  console.log(&apos;Child2内大量逻辑2&apos;)</span><br><span class="line">  console.log(&apos;Child2内大量逻辑3&apos;)</span><br><span class="line">  return (&lt;div&gt;child2:&#123;props.data&#125;&lt;/div&gt;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 被缓存，第一次执行后，当依赖的值变了才会更新</span><br><span class="line">const Child3 = React.memo(Child2)</span><br><span class="line"></span><br><span class="line">export default UseMemoDemo1;</span><br></pre></td></tr></table></figure>
<h3 id="Memo的Bug-如果-传递一个props-fn"><a href="#Memo的Bug-如果-传递一个props-fn" class="headerlink" title="Memo的Bug: 如果 传递一个props.fn"></a>Memo的Bug: 如果 传递一个props.fn</h3><ul>
<li>每次渲染的时候 父组件的 fn会重新生成一个，这样就导致，props变了， memo的组件失效了</li>
<li>解决办法就是：<strong>useMemo</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; useCallback, useMemo, useState &#125; from &apos;react&apos;;</span><br><span class="line">// useMemo</span><br><span class="line">function UseMemoDemo2() &#123;</span><br><span class="line">  const [n, setN] = useState(0)</span><br><span class="line">  const [m, setM] = useState(0)</span><br><span class="line">  const onChangeN = () =&gt; &#123;</span><br><span class="line">    setN(i =&gt; i + 1)</span><br><span class="line">  &#125;</span><br><span class="line">  const onChangeM = () =&gt; &#123;</span><br><span class="line">    setM(i =&gt; i + 1)</span><br><span class="line">  &#125;</span><br><span class="line">  const onClickChild = () =&gt; &#123; &#125; // 这个每次执行的时候 都会重新生成一个 而且是引用的地址 ，child依赖它，它变了，child无法被缓存</span><br><span class="line"></span><br><span class="line">  /*</span><br><span class="line">  useMemo(()=&gt;&#123;</span><br><span class="line">    return 复用的函数</span><br><span class="line">  &#125;,[依赖的变量]) </span><br><span class="line">  这个函数复用 </span><br><span class="line">    return 就是复用的函数</span><br><span class="line">    第二个参数里的 [] 内是依赖变化的值</span><br><span class="line">  */</span><br><span class="line">  const onClickChildMemo = useMemo(() =&gt; &#123;</span><br><span class="line">    // return的东西 就是你要缓存的函数</span><br><span class="line">    return () =&gt; &#123; &#125;</span><br><span class="line">  &#125;, [m]) // []里是依赖的东西变了才更新</span><br><span class="line"></span><br><span class="line">  /*</span><br><span class="line">  useCallback(fn,[m]) </span><br><span class="line">  等价于</span><br><span class="line">  useMemo(()=&gt;fn,[m])</span><br><span class="line">  */</span><br><span class="line">  const fn = () =&gt; console.log(m)</span><br><span class="line">  const onClickChildMemo2 = useMemo(() =&gt; fn, [m])</span><br><span class="line">  const onClickChildMemo3 = useCallback(fn, [m])</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      没有缓存，Child组件 依赖的是m，点击按钮更新的是n,也会触发 Child从新执行</span><br><span class="line">      &lt;br /&gt;</span><br><span class="line">      n:&#123;n&#125;,</span><br><span class="line">      &lt;br /&gt;</span><br><span class="line">      m:&#123;m&#125;</span><br><span class="line">      &lt;br /&gt;</span><br><span class="line">      &lt;button onClick=&#123;onChangeN&#125;&gt;onChangeN&lt;/button&gt;</span><br><span class="line">      &lt;br /&gt;</span><br><span class="line">      &lt;button onClick=&#123;onChangeM&#125;&gt;onChangeM&lt;/button&gt;</span><br><span class="line">      &lt;Child2 data=&#123;m&#125; onClick=&#123;onClickChild&#125; /&gt;</span><br><span class="line">      &lt;Child4 data=&#123;m&#125; onChilk=&#123;onClickChildMemo&#125; /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function Child(props) &#123;</span><br><span class="line">  console.log(&apos;Child执行了&apos;)</span><br><span class="line">  console.log(&apos;Child内大量逻辑1&apos;)</span><br><span class="line">  console.log(&apos;Child内大量逻辑2&apos;)</span><br><span class="line">  console.log(&apos;Child内大量逻辑3&apos;)</span><br><span class="line">  return (&lt;div onClick=&#123;props.onClick&#125;&gt;child:&#123;props.data&#125;&lt;/div&gt;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const Child2 = React.memo(Child)</span><br><span class="line"></span><br><span class="line">function Child3(props) &#123;</span><br><span class="line">  console.log(&apos;Child3执行了&apos;)</span><br><span class="line">  console.log(&apos;Child3内大量逻辑1&apos;)</span><br><span class="line">  console.log(&apos;Child3内大量逻辑2&apos;)</span><br><span class="line">  console.log(&apos;Child3内大量逻辑3&apos;)</span><br><span class="line">  return (&lt;div onClick=&#123;props.onClick&#125;&gt;child:&#123;props.data&#125;&lt;/div&gt;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const Child4 = React.memo(Child3)</span><br><span class="line"></span><br><span class="line">export default UseMemoDemo2;</span><br></pre></td></tr></table></figure>
<h3 id="useMemo"><a href="#useMemo" class="headerlink" title="useMemo"></a>useMemo</h3><blockquote>
<p>特点</p>
</blockquote>
<ul>
<li>第一个参数是 ()=&gt;value</li>
<li>第二个参数是 依赖 <code>[m,n]</code></li>
<li>只有依赖变了的时候，才会计算出新的 value,反之复用</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">useMemo(()=&gt;&#123;</span><br><span class="line">  return 复用的函数</span><br><span class="line">&#125;,[依赖的变量]) </span><br><span class="line">这个函数复用 </span><br><span class="line">  return 就是复用的函数</span><br><span class="line">  第二个参数里的 [] 内是依赖变化的值</span><br><span class="line">*/</span><br><span class="line">const onClickChildMemo = useMemo(() =&gt; &#123;</span><br><span class="line">  // return的东西 就是你要缓存的函数</span><br><span class="line">  return () =&gt; &#123; &#125;</span><br><span class="line">&#125;, [m]) // []里是依赖的东西变了才更新</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意</p>
</blockquote>
<ul>
<li>如果你的 value是个函数你就要这样</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">useMemo(()=&gt;(x)=&gt;&#123;console.log(1)&#125;&#125;,[依赖1，依赖2])</span><br></pre></td></tr></table></figure>
<ul>
<li>useCallback的优化</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// 两个箭头看着很懵逼</span><br><span class="line">useMemo(()=&gt;(x)=&gt;&#123;console.log(x)&#125;&#125;,[依赖1，依赖2])</span><br><span class="line"></span><br><span class="line">// useCallback 你可以这样</span><br><span class="line">useCallback((x)=&gt;&#123;console.log(x)&#125;&#125;,[依赖1，依赖2])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">useCallback(fn,[m]) </span><br><span class="line">等价于</span><br><span class="line">useMemo(()=&gt;fn,[m])</span><br></pre></td></tr></table></figure>
<h3 id="useRef"><a href="#useRef" class="headerlink" title="useRef"></a>useRef</h3><ul>
<li>当你需要一个值，在组件不断render的时候保持不变(addr)</li>
<li>初始化 <code>const count = useRef(0)</code></li>
<li>读取 count.current</li>
<li>为什么需要 current?<ul>
<li>为了保证多次 useRef 都是同一个值(只有引用能做到) </li>
<li><code>count = {current:0}</code> 地址101</li>
<li>下次 +1 后  <code>count = {current:1}</code> 地址101</li>
</ul>
</li>
</ul>
<h4 id="扩展vue3内容"><a href="#扩展vue3内容" class="headerlink" title="扩展vue3内容"></a>扩展vue3内容</h4><ul>
<li><p>vue3的ref 改变ref的值，会触发UI更新</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 初始化</span><br><span class="line">cosnt count = ref(0)</span><br><span class="line">// 读取</span><br><span class="line">count.value</span><br><span class="line">// 更新,它会触发UI更新，vue3会自动 render</span><br><span class="line">count.value +=1</span><br></pre></td></tr></table></figure>
</li>
<li><p>而 react的 ref不会触发 UI更新</p>
</li>
</ul>
<h4 id="想要给React的ref改变的时候触发UI更新咋办？"><a href="#想要给React的ref改变的时候触发UI更新咋办？" class="headerlink" title="想要给React的ref改变的时候触发UI更新咋办？"></a>想要给React的ref改变的时候触发UI更新咋办？</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; useEffect, useRef, useState &#125; from &apos;react&apos;;</span><br><span class="line">function UseRefDemo1() &#123;</span><br><span class="line">  const count = useRef(0)</span><br><span class="line">  const [_, set_] = useState(null)</span><br><span class="line">  const onChangeN = () =&gt; &#123;</span><br><span class="line"></span><br><span class="line">    count.current += 1</span><br><span class="line">  &#125;</span><br><span class="line">  const onChangeNUpdatedUI = () =&gt; &#123;</span><br><span class="line">    count.current += 1</span><br><span class="line">    set_(Math.random())</span><br><span class="line">  &#125;</span><br><span class="line">  useEffect(() =&gt; &#123;</span><br><span class="line">    console.log(count)</span><br><span class="line">  &#125;)</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      count:&#123;count.current&#125;,</span><br><span class="line">      &lt;br /&gt;</span><br><span class="line">      &lt;button onClick=&#123;onChangeN&#125;&gt;onChangeRef不更新UI&lt;/button&gt;</span><br><span class="line">      &lt;button onClick=&#123;onChangeNUpdatedUI&#125;&gt;onChangeRef更新UI&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default UseRefDemo1;</span><br></pre></td></tr></table></figure>
<h3 id="forwardRef-仅限函数组件"><a href="#forwardRef-仅限函数组件" class="headerlink" title="forwardRef : 仅限函数组件"></a>forwardRef : 仅限函数组件</h3><ul>
<li>props无法传递 ref</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; useRef &#125; from &quot;react&quot;;</span><br><span class="line">import ReactDOM from &quot;react-dom&quot;;</span><br><span class="line"></span><br><span class="line">function App() &#123;</span><br><span class="line">  const buttonRef = useRef(null);</span><br><span class="line">  return (</span><br><span class="line">    &lt;div className=&quot;App&quot;&gt;</span><br><span class="line">      &lt;Button2 ref=&#123;buttonRef&#125;&gt;按钮&lt;/Button2&gt;</span><br><span class="line">      &#123;/* 看浏览器控制台的报错 */&#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const Button2 = props =&gt; &#123;</span><br><span class="line">  return &lt;button className=&quot;red&quot; &#123;...props&#125; /&gt;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const rootElement = document.getElementById(&quot;root&quot;);</span><br><span class="line">ReactDOM.render(&lt;App /&gt;, rootElement);</span><br></pre></td></tr></table></figure>
<ul>
<li>实现ref传递</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; useRef &#125; from &quot;react&quot;;</span><br><span class="line">import ReactDOM from &quot;react-dom&quot;;</span><br><span class="line"></span><br><span class="line">import &quot;./styles.css&quot;;</span><br><span class="line"></span><br><span class="line">function App() &#123;</span><br><span class="line">  const buttonRef = useRef(null);</span><br><span class="line">  return (</span><br><span class="line">    &lt;div className=&quot;App&quot;&gt;</span><br><span class="line">      &lt;Button3 ref=&#123;buttonRef&#125;&gt;按钮&lt;/Button3&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const Button2 = (props,ref)=&gt;&#123;</span><br><span class="line">  return &lt;button className=&quot;red&quot; ref=&#123;ref&#125; &#123;...props&#125; /&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// React.forwardRef 可以额外多传递一个参数</span><br><span class="line">// 把ref参数 转发给 Button2</span><br><span class="line">const Button3 = React.forwardRef(Button2);</span><br><span class="line"></span><br><span class="line">const rootElement = document.getElementById(&quot;root&quot;);</span><br><span class="line">ReactDOM.render(&lt;App /&gt;, rootElement);</span><br></pre></td></tr></table></figure>
<h4 id="useRef-1"><a href="#useRef-1" class="headerlink" title="useRef"></a>useRef</h4><ul>
<li>可用来引用DOM,避免来 docuemt.querySelector</li>
<li>也可以引用普通对象</li>
</ul>
<h4 id="forwardRef"><a href="#forwardRef" class="headerlink" title="forwardRef"></a>forwardRef</h4><ul>
<li>由于 props不能传递 ref,所以需要 forwardRef</li>
<li>为什么props不包含 ref呢？，因为大部分时候不需要</li>
</ul>
<h3 id="useImperativeHandle"><a href="#useImperativeHandle" class="headerlink" title="useImperativeHandle"></a>useImperativeHandle</h3><ul>
<li>名字起的稀巴烂</li>
<li>应该叫做 setRef</li>
<li>用于自定义 ref的属性</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123;</span><br><span class="line">  useRef,</span><br><span class="line">  useEffect,</span><br><span class="line">  useImperativeHandle,</span><br><span class="line">  createRef</span><br><span class="line">&#125; from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">function SetRefDemo() &#123;</span><br><span class="line">  const buttonRef = useRef(null);</span><br><span class="line">  useEffect(() =&gt; &#123;</span><br><span class="line">    console.log(buttonRef.current);</span><br><span class="line">  &#125;);</span><br><span class="line">  return (</span><br><span class="line">    &lt;div className=&quot;App&quot;&gt;</span><br><span class="line">      &lt;Button2 ref=&#123;buttonRef&#125;&gt;按钮&lt;/Button2&gt;</span><br><span class="line">      &lt;button</span><br><span class="line">        className=&quot;close&quot;</span><br><span class="line">        onClick=&#123;() =&gt; &#123;</span><br><span class="line">          console.log(buttonRef);</span><br><span class="line">          buttonRef.current.x();</span><br><span class="line">        &#125;&#125;</span><br><span class="line">      &gt;</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const Button2 = React.forwardRef((props, ref) =&gt; &#123;</span><br><span class="line">  const realButton = createRef(null);</span><br><span class="line">  const setRef = useImperativeHandle;</span><br><span class="line">  // 对 ref进行自定义的包装返回</span><br><span class="line">  setRef(ref, () =&gt; &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      x: () =&gt; &#123;</span><br><span class="line">        realButton.current.remove();</span><br><span class="line">      &#125;,</span><br><span class="line">      realButton: realButton</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;);</span><br><span class="line">  return &lt;button ref=&#123;realButton&#125; &#123;...props&#125; /&gt;;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">export default SetRefDemo;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/07/25/ReactWheels07-03Hooks全解3/" data-id="ckovg9eq900oh8yjk1l7sfxby" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ReactWheels/">ReactWheels</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/14/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><a class="page-number" href="/page/14/">14</a><span class="page-number current">15</span><a class="page-number" href="/page/16/">16</a><a class="page-number" href="/page/17/">17</a><span class="space">&hellip;</span><a class="page-number" href="/page/55/">55</a><a class="extend next" rel="next" href="/page/16/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS/">CSS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ES6速学/">ES6速学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JS不知深浅/">JS不知深浅</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M01/">M01</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M02/">M02</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M03/">M03</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M04/">M04</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M06/">M06</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M07/">M07</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M08/">M08</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/M09/">M09</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NodeWeb/">NodeWeb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Node后端/">Node后端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ReactWheels/">ReactWheels</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React入门/">React入门</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TS入门/">TS入门</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Webpack/">Webpack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/express/">express</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fullstack/">fullstack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/http/">http</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jQuery/">jQuery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mobile/">mobile</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/">mongodb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node/">node</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node每日精进/">node每日精进</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/oak/">oak</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tools/">tools</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vim/">vim</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vue/">vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vultr/">vultr</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web性能优化/">web性能优化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web面经/">web面经</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows/">windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端知识点/">前端知识点</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/CSS/" style="font-size: 13.91px;">CSS</a> <a href="/tags/ES6速学/" style="font-size: 14.35px;">ES6速学</a> <a href="/tags/JS不知深浅/" style="font-size: 11.3px;">JS不知深浅</a> <a href="/tags/M01/" style="font-size: 13.48px;">M01</a> <a href="/tags/M02/" style="font-size: 15.22px;">M02</a> <a href="/tags/M03/" style="font-size: 15.65px;">M03</a> <a href="/tags/M04/" style="font-size: 16.09px;">M04</a> <a href="/tags/M06/" style="font-size: 18.26px;">M06</a> <a href="/tags/M07/" style="font-size: 17.83px;">M07</a> <a href="/tags/M08/" style="font-size: 16.96px;">M08</a> <a href="/tags/M09/" style="font-size: 11.74px;">M09</a> <a href="/tags/NodeWeb/" style="font-size: 15.65px;">NodeWeb</a> <a href="/tags/Node后端/" style="font-size: 18.7px;">Node后端</a> <a href="/tags/ReactWheels/" style="font-size: 16.52px;">ReactWheels</a> <a href="/tags/React入门/" style="font-size: 15.22px;">React入门</a> <a href="/tags/TS入门/" style="font-size: 14.78px;">TS入门</a> <a href="/tags/Webpack/" style="font-size: 11.3px;">Webpack</a> <a href="/tags/express/" style="font-size: 10.43px;">express</a> <a href="/tags/fullstack/" style="font-size: 17.83px;">fullstack</a> <a href="/tags/http/" style="font-size: 12.17px;">http</a> <a href="/tags/jQuery/" style="font-size: 10px;">jQuery</a> <a href="/tags/java/" style="font-size: 19.13px;">java</a> <a href="/tags/linux/" style="font-size: 10.87px;">linux</a> <a href="/tags/mobile/" style="font-size: 11.3px;">mobile</a> <a href="/tags/mongodb/" style="font-size: 12.61px;">mongodb</a> <a href="/tags/mysql/" style="font-size: 12.61px;">mysql</a> <a href="/tags/node/" style="font-size: 10.43px;">node</a> <a href="/tags/node每日精进/" style="font-size: 10px;">node每日精进</a> <a href="/tags/oak/" style="font-size: 20px;">oak</a> <a href="/tags/python/" style="font-size: 17.39px;">python</a> <a href="/tags/tools/" style="font-size: 10px;">tools</a> <a href="/tags/vim/" style="font-size: 10px;">vim</a> <a href="/tags/vue/" style="font-size: 13.04px;">vue</a> <a href="/tags/vultr/" style="font-size: 10px;">vultr</a> <a href="/tags/web性能优化/" style="font-size: 10px;">web性能优化</a> <a href="/tags/web面经/" style="font-size: 10px;">web面经</a> <a href="/tags/windows/" style="font-size: 10px;">windows</a> <a href="/tags/前端知识点/" style="font-size: 19.57px;">前端知识点</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/05/18/Win平台软件技巧01/">Win平台软件技巧01</a>
          </li>
        
          <li>
            <a href="/2021/02/28/Webpack-03loader/">Webpack-03loader</a>
          </li>
        
          <li>
            <a href="/2021/02/27/Webpack-02打包器/">Webpack-02打包器</a>
          </li>
        
          <li>
            <a href="/2021/02/27/Webpack-01AST-Babel-依赖/">Webpack-01AST_Babel_依赖</a>
          </li>
        
          <li>
            <a href="/2021/02/26/Webpack-00前置内容理解webpack/">Webpack-00前置内容理解webpack</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 Stevin<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>